<?xml version="1.0" encoding="utf-8" ?>
<!--
Automatically generated HTML file from Doconce source
(http://code.google.com/p/doconce/)
-->

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: http://code.google.com/p/doconce/" />

<!--
Color definitions:  http://www.december.com/html/spec/color0.html
CSS examples:       http://www.w3schools.com/css/css_examples.asp
-->

<style type="text/css">
    body {
      margin:5;
      padding:0;
      border:0;	/* Remove the border around the viewport in old versions of IE */
      width:100%;
      background: #fdf6e3;
      min-width:600px;	/* Minimum width of layout - remove if not required */
      font-family: Verdana, Helvetica, Arial, sans-serif;
      font-size: 1.0em;
      line-height: 1.3em;
      color: #657b83;
    }
    a { color: #657b83; text-decoration:none; }
    a:hover { color: #b58900; background: #eee8d5; text-decoration:none; }
    h1, h2, h3 { margin:.8em 0 .2em 0; padding:0; }
    h2 { font-variant: small-caps; }
    pre {
      background: #fdf6e3;
      -webkit-box-shadow: inset 0 0 2px #000000;
      -moz-box-shadow: inset 0 0 2px #000000;
      box-shadow: inset 0 0 2px #000000;
      color: #586e75;
      margin-left: 0px;
      font-family: 'Droid Sans Mono', monospace;
      padding: 2px;
      -webkit-border-radius: 4px;
      -moz-border-radius: 4px;
      border-radius: 4px;
      -moz-background-clip: padding;
      -webkit-background-clip: padding-box;
      background-clip: padding-box;
    }
    tt { font-family: "Courier New", Courier; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p { text-indent: 0px; }
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}

</style>

<!-- Use MathJax to render mathematics -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">

</head>

<body>
    
<!-- newcommands_keep.tex -->
$$
\newcommand{\uex}{u_{\small\mbox{e}}}
\newcommand{\Aex}{A_{\small\mbox{e}}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\halfi}{{1/2}}

\newcommand{\xpoint}{\pmb{x}}
\newcommand{\normalvec}{\pmb{n}}

\newcommand{\x}{\pmb{x}}
\newcommand{\X}{\pmb{X}}
\renewcommand{\u}{\pmb{u}}
\renewcommand{\v}{\pmb{v}}
\newcommand{\w}{\pmb{w}}
\renewcommand{\u}{\pmb{u}}
\newcommand{\e}{\pmb{e}}
\newcommand{\f}{\pmb{f}}
\newcommand{\F}{\pmb{F}}
\newcommand{\stress}{\pmb{\sigma}}
\newcommand{\strain}{\pmb{\varepsilon}}
\newcommand{\stressc}{{\sigma}}
\newcommand{\strainc}{{\varepsilon}}
\newcommand{\I}{\pmb{I}}
\newcommand{\T}{\pmb{T}}

% Unit vectors
\newcommand{\ii}{\pmb{i}}
\newcommand{\jj}{\pmb{j}}
\newcommand{\kk}{\pmb{k}}
\newcommand{\ir}{\pmb{i}_r}
\newcommand{\ith}{\pmb{i}_{\theta}}
\newcommand{\iz}{\pmb{i}_z}

% Finite elements
\newcommand{\basphi}{\varphi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\phib}{\pmb{\varphi}}
\newcommand{\sinL}[1]{\sin\left((#1+1)\pi\frac{x}{L}\right)}
\newcommand{\xno}[1]{x_{#1}}
%\newcommand{\xno}[1]{x^{(#1)}}
\newcommand{\Xno}[1]{X_{(#1)}}
\newcommand{\yno}[1]{y_{#1}}
\newcommand{\Yno}[1]{Y_{(#1)}}
\newcommand{\xdno}[1]{\pmb{x}_{#1}}

% FEniCS commands
\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Integerp}{\mathbb{N}}
\newcommand{\Integer}{\mathbb{Z}}
$$



<!-- ------------------- main content ------------------------>

<title>INF5620 Lecture: Analysis of finite difference schemes for diffusion processes</title>

<center><h1>INF5620 Lecture: Analysis of finite difference schemes for diffusion processes</h1></center>  <! -- document title -->

<center><h4>Nov 15, 2012</h4></center> <!-- date -->
<p>
<!-- # #include "lec-diffu/diffu_fd1.do.txt" -->

<p>

<h2>Analysis of schemes for the diffusion equation  <a name="___sec0"></a></h2>
<p>

<h3>Properties of the solution <a name="diffu:pde1:analysis:uex"></a></h3>
<p>
The PDE

<p>
$$
\begin{equation}
u_t = \alpha u_{xx},
\label{diffu:pde1:eq}
\end{equation}
$$
admits solutions

<p>
$$
\begin{equation}
u(x,t) = Qe^{-\alpha k^2 t}\sin\left( kx\right)
\label{diffu:pde1:sol1}
\thinspace  .
\end{equation}
$$

<p>
Observations from this solution:

<p>

<ul>
 <p><li> The initial shape \( I(x)=Q\sin kx \)
   undergoes a damping \( \exp{(-\alpha k^2t)} \)</li>
 <p><li> The damping is very strong for short waves (large \( k \))</li>
 <p><li> The damping is weak for long waves (small \( k \))</li>
 <p><li> Consequence: \( u \) is smoothened with time</li>
</ul>

<h4>Example  <a name="___sec2"></a></h4>
<p>
Test problem:

<p>
$$
\begin{align*}
u_t &= u_{xx},\quad x\in (0,1),\ t\in (0,T],\\
u(0,t) &= u(1,t) = 0,\quad t\in (0,T],\\
u(x,0) & = \sin (\pi x) + 0.1\sin(100\pi x)
\thinspace .
\end{align*}
$$

<p>
Exact solution:

<p>
$$
\begin{equation}
u(x,t) = e^{-\pi^2 t}\sin (\pi x) + 0.1e^{-\pi^2 10^4 t}\sin (100\pi x)
\label{diffu:pde1:sol2}
\thinspace .
\end{equation}
$$

<p>

<p>
<center> <! -- figure -->
<hr class="figure">
<center><p class="caption">Figure 1:  Evolution of the solution of a diffusion problem: initial condition (upper left), 1/100 reduction of the small waves (upper right), 1/10 reduction of the long wave (lower left), and 1/100 reduction of the long wave (lower right). <a name="diffu:pde1:fig:damping"></a> </p></center>
<p><img src="fig-diffu/diffusion_damping.png" align="bottom" width=800></p>
</center>

<p>

<p>

<h4>Fourier representation  <a name="___sec3"></a></h4>
<p>
Represent \( I(x) \) as a Fourier series

<p>
$$
\begin{equation}
I(x) \approx \sum_{k\in K} b_k e^{ikx},
\end{equation}
$$

<p>
The corresponding sum for \( u \) is

<p>
$$
\begin{equation}
u(x,t) \approx \sum_{k\in K} b_k e^{-\alpha k^2t}e^{ikx},
\label{diffu:pde1:u:Fourier}
\thinspace .
\end{equation}
$$

<p>
Such solutions are also accepted by the numerical schemes, but
with an  amplification factor different from \( exp{({-\alpha k^2t})} \).

<p>

<h3>Analysis of the finite difference schemes <a name="diffu:pde1:analysis"></a></h3>
<p>
We seek

<p>
$$
\begin{equation}
u^n_q = A^n e^{ikq\Delta x} = A^ne^{ikx},
\label{diffu:pde1:analysis:uni}
\end{equation}
$$

<p>

<h4>Stability  <a name="___sec5"></a></h4>
<p>

<ul>
  <p><li> \( |A|< 1 \): decaying numerical solutions (as we want)</li>
  <p><li> \( A<0 \): <em>oscillating</em> numerical solutions (as we do not want)</li>
</ul>

<h4>Accurary  <a name="___sec6"></a></h4>
<p>
Compare numerical and exact amplification factor:

<p>
$$ A\quad\hbox{vs}\quad \Aex = \exp{(-\alpha k^2 \Delta t)} $$

<p>

<h3>Analysis of the Forward Euler scheme <a name="diffu:pde1:analysis:FE"></a></h3>
<p>
$$
\begin{equation*} [D_t^+ u = \alpha D_xD_x u]^n_q\thinspace . \end{equation*}
$$

<p>
Inserting

<p>
$$ u^n_q = A^n e^{ikq\Delta x},$$
leads to

<p>
$$
\begin{equation}
A = 1 -4C\sin^2\left(
\frac{k\Delta x}{2}\right),\quad
C = \frac{\alpha\Delta t}{\Delta x^2}
\thinspace .
\end{equation}
$$

<p>
Note: halving \( \Delta x \) makes \( \Delta t \) four times smaller.
The method is very expensive for small \( \Delta x \).

<p>
The complete numerical solution is

<p>
$$
\begin{equation}
u^n_q = \left(1 -4C\sin^2\left(
\frac{k\Delta x}{2}\right)\right)^ne^{ikq\Delta x}
\thinspace .
\end{equation}
$$

<p>

<h4>Stability  <a name="___sec8"></a></h4>
<p>
\( A\leq 1 \), but \( A<-1 \) is a possibility:

<p>
$$ 4C\sin^2 (p/2)\leq 2
\thinspace . $$
The worst case is when \( \sin^2 (p/2)=1 \), so a sufficient criterion for
stability is

<p>
$$
\begin{equation}
C\leq \frac{1}{2},
\end{equation}
$$
or:

<p>
$$
\begin{equation}
\Delta t\leq \frac{\Delta x^2}{2\alpha}\thinspace .
\end{equation}
$$

<p>

<p>

<h3>Analysis of the Backward Euler scheme <a name="diffu:pde1:analysis:BE"></a></h3>
<p>
$$
\begin{equation*} [D_t^- u = \alpha D_xD_x u]^n_q,\end{equation*}
$$

<p>
$$
\begin{equation}
A = \left(1  + 4C\sin^2(p/2)\right)^{-1}
\label{diffu:pde1:analysis:BE:A}
\thinspace .
\end{equation}
$$

<p>
$$
\begin{equation}
u^n_q = \left(1  + 4C\sin^2 (p/2)\right)^{-n}
e^{ikq\Delta x} \thinspace .
\end{equation}
$$

<p>

<h4>Stability  <a name="___sec10"></a></h4>
<p>
We see from \eqref{diffu:pde1:analysis:BE:A} that \( |A|<1 \) for all \( \Delta t>0 \)
and that \( A>0 \) (no oscillations).

<p>

<h3>Analysis of the Crank-Nicolson scheme <a name="diffu:pde1:analysis:CN"></a></h3>
<p>
The scheme

<p>
$$ [D_t u = \alpha D_xD_x \overline{u}^x]^{n+\half}_q, $$
leads to

<p>
$$
\begin{equation}
A = \frac{ 1 - 2C\sin^2(p/2)}{1 + 2C\sin^2(p/2)}
\thinspace .
\end{equation}
$$

<p>
$$
\begin{equation}
u^n_q = \left(\frac{ 1 - 2C\sin^2(p/2)}{1 + 2C\sin^2(p/2)}\right)^ne^{ikp\Delta x}
\thinspace .
\end{equation}
$$

<p>

<h4>Stability  <a name="___sec12"></a></h4>
<p>
The criteria \( A>-1 \) and \( A<1 \) are fulfilled for any \( \Delta t >0 \).

<p>

<h3>Summary of accuracy of amplification factors  <a name="___sec13"></a></h3>
<p>

<p>
<center> <! -- figure -->
<hr class="figure">
<center><p class="caption">Figure 2:  Error in amplification factor for large time steps. <a name="diffu:pde1:fig:A:err:C20"></a> </p></center>
<p><img src="fig-diffu/diffusion_A_C20_C2_FDM.png" align="bottom" width=800,></p>
</center>

<p>

<p>

<p>
<center> <! -- figure -->
<hr class="figure">
<center><p class="caption">Figure 3:  Error in amplification factor for time steps around the Forward Euler stability limit. <a name="diffu:pde1:fig:A:err:C0.5"></a> </p></center>
<p><img src="fig-diffu/diffusion_A_C05_C025_FDM.png" align="bottom" width=800,></p>
</center>

<p>

<p>

<p>
<center> <! -- figure -->
<hr class="figure">
<center><p class="caption">Figure 4:  Error in amplification factor for small time steps. <a name="diffu:pde1:fig:A:err:C0.1"></a> </p></center>
<p><img src="fig-diffu/diffusion_A_C01_C001_FDM.png" align="bottom" width=800,></p>
</center>

<p>

<p>
Observations:

<p>

<ul>
 <p><li> Crank-Nicolson gives oscillations and not much damping of short waves
   for increasing \( C \).</li>
 <p><li> These waves will manifest themselves as high frequency
   oscillatory noise in the solution.</li>
 <p><li> All schemes fail to dampen short waves enough</li>
</ul>

The problems of correct damping for \( u_t = u_{xx} \) is partially
manifested in the similar time discretization schemes for \( u'(t)=-\alpha u(t) \).

<p>

<!-- ------------------- end of main content ----------------->
</body>
</html>
    

