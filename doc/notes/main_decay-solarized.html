<!DOCTYPE html>
<!--
Automatically generated HTML file from Doconce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Introduction to computing with finite difference methods">
<meta name="keywords" content="decay ODE,exponential decay,mesh,grid,mesh function,finite differences,difference equation,discrete equation,algebraic equation,finite difference scheme,Forward Euler scheme,backward scheme, 1-step,Backward Euler scheme,Crank-Nicolson scheme,averaging arithmetic,weighted average,theta-rule,$\theta$-rule,$\theta$-rule,finite difference operator notation,operator notation, finite differences,directory,folder,doc strings,printf format,format string syntax (Python),representative (mesh function),array arithmetics,array computing,continuous function norms,norm continuous,discrete function norms,mesh function norms,norm discrete (mesh function),scalar computing,PNG plot,PDF plot,EPS plot,viewing graphics files,cropping images,user interfaces to programs,command-line arguments,reading the command line,list comprehension,option-value pairs (command line),command-line options and values,reading the command line,convergence rate,dictionary,verification,modules,test block (in modules),importing modules,doctests,software testing doctests,unit testing,software testing nose,software testing nose w/doctests,unit testing,software testing unit testing (class-based),problem class,solver class,wrapper (code),visualizer class,problem class,solver class,visualizer class,numerical experiments,scientific experiments,script,Unix wildcard notation,wildcard notation (Unix),stability,amplification factor,A-stable methods,L-stable methods,consistency,stability,convergence,lambda functions,method of manufactured solutions,MMS (method of manufactured solutions),implicit schemes,explicit schemes,theta-rule,$\theta$-rule,backward scheme, 2-step,BDF2 scheme,Leapfrog scheme,Leapfrog scheme, filtered,Heun's method,Runge-Kutta, 2nd-order scheme,Taylor-series methods (for ODEs),Adams-Bashforth scheme, 2nd-order,Adams-Bashforth scheme, 3rd order,Runge-Kutta, 4th-order scheme,RK4,adaptive time stepping,Dormand-Prince Runge-Kutta 4-5 method,population dynamics,logistic model,radioactive decay,terminal velocity,geometric average,averaging geometric,scaling">



<style type="text/css">
    /* solarized style */
    body {
      margin:5;
      padding:0;
      border:0;	/* Remove the border around the viewport in old versions of IE */
      width:100%;
      background: #fdf6e3;
      min-width:600px;	/* Minimum width of layout - remove if not required */
      font-family: Verdana, Helvetica, Arial, sans-serif;
      font-size: 1.0em;
      line-height: 1.3em;
      color: #657b83;
    }
    a { color: #657b83; text-decoration:none; }
    a:hover { color: #b58900; background: #eee8d5; text-decoration:none; }
    h1, h2, h3 { margin:.8em 0 .2em 0; padding:0; line-height: 125%; }
    h2 { font-variant: small-caps; }
    pre {
      background: #fdf6e3;
      -webkit-box-shadow: inset 0 0 2px #000000;
      -moz-box-shadow: inset 0 0 2px #000000;
      box-shadow: inset 0 0 2px #000000;
      color: #586e75;
      margin-left: 0px;
      font-family: 'Droid Sans Mono', monospace;
      padding: 2px;
      -webkit-border-radius: 4px;
      -moz-border-radius: 4px;
      border-radius: 4px;
      -moz-background-clip: padding;
      -webkit-background-clip: padding-box;
      background-clip: padding-box;
    }
    tt { font-family: "Courier New", Courier; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p { text-indent: 0px; }
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .alert-text-small   { font-size: 80%;  }
    .alert-text-large   { font-size: 130%; }
    .alert-text-normal  { font-size: 90%;  }
    .alert {
             padding:8px 35px 8px 14px; margin-bottom:18px;
             text-shadow:0 1px 0 rgba(255,255,255,0.5);
             border:1px solid #FFBF00;
             -webkit-border-radius: 4px; -moz-border-radius: 4px;
             border-radius: 4px
             color: #555;
             background-color: #fbeed5;
             background-position: 10px 5px;
             background-repeat: no-repeat;
             background-size: 38px;
             padding-left: 55px;
             width: 75%;
     }
     .alert-block {padding-top:14px; padding-bottom:14px}
     .alert-block > p, .alert-block > ul {margin-bottom:1em}
     .alert li {margin-top: 1em}
     .alert-block p+p {margin-top:5px}
     .alert-notice { background-image: url(https://doconce.googlecode.com/hg/bundled/html_images/small_yellow_notice.png); }
     .alert-summary  { background-image:url(https://doconce.googlecode.com/hg/bundled/html_images/small_yellow_summary.png); }
     .alert-warning { background-image: url(https://doconce.googlecode.com/hg/bundled/html_images/small_yellow_warning.png); }
     .alert-question {background-image:url(https://doconce.googlecode.com/hg/bundled/html_images/small_yellow_question.png); }

</style>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Finite difference methods  ',
               1,
               'decay:basics',
               'decay:basics'),
              (' A basic model for exponential decay ',
               2,
               'decay:model',
               'decay:model'),
              (' The Forward Euler scheme ',
               2,
               'decay:schemes:FE',
               'decay:schemes:FE'),
              (' Step 1: Discretizing the domain ', 3, None, '___sec3'),
              (' Step 2: Fulfilling the equation at discrete time points ',
               3,
               None,
               '___sec4'),
              (' Step 3: Replacing derivatives by finite differences ',
               3,
               None,
               '___sec5'),
              (' Step 4: Formulating a recursive algorithm ',
               3,
               None,
               '___sec6'),
              (' The Backward Euler scheme ',
               2,
               'decay:schemes:BE',
               'decay:schemes:BE'),
              (' The Crank-Nicolson scheme ',
               2,
               'decay:schemes:CN',
               'decay:schemes:CN'),
              (' The unifying $\\theta$-rule ',
               2,
               'decay:schemes:theta',
               'decay:schemes:theta'),
              (' Constant time step ', 2, None, '___sec10'),
              (' Compact operator notation for finite differences ',
               2,
               'decay:fd:op',
               'decay:fd:op'),
              (' Implementation ', 1, 'decay:impl1', 'decay:impl1'),
              (' Making a solver function ', 2, 'decay:py1', 'decay:py1'),
              (' Function for computing the numerical solution ',
               3,
               None,
               '___sec14'),
              (' Integer division ', 3, None, '___sec15'),
              (' Doc strings ', 3, None, '___sec16'),
              (' Formatting of numbers ', 3, None, '___sec17'),
              (' Running the program ', 3, None, '___sec18'),
              (' Verifying the implementation ', 2, None, '___sec19'),
              (' Running a few algorithmic steps by hand ',
               3,
               None,
               '___sec20'),
              (' Comparison with an exact discrete solution ',
               3,
               None,
               '___sec21'),
              (' Computing the numerical error as a mesh function ',
               2,
               'decay:computing:error',
               'decay:computing:error'),
              (' Computing the norm of the numerical error ',
               2,
               'decay:computing:error:norm',
               'decay:computing:error:norm'),
              (' Scalar computing ', 3, None, '___sec24'),
              (' Plotting solutions ', 2, 'decay:plotting', 'decay:plotting'),
              (' Plotting multiple curves ', 3, None, '___sec26'),
              (' Experiments with computing and plotting ',
               3,
               None,
               '___sec27'),
              (' Combining plot files ', 3, None, '___sec28'),
              (' Plotting with SciTools ', 3, None, '___sec29'),
              (' Creating command-line interfaces ',
               2,
               'decay:commandline',
               'decay:commandline'),
              (' Reading a sequence of command-line arguments ',
               3,
               None,
               '___sec31'),
              (' Working with an argument parser ', 3, None, '___sec32'),
              (' Creating a graphical web user interface ',
               2,
               None,
               '___sec33'),
              (' Making a compute function ', 3, None, '___sec34'),
              (' Generating the user interface ', 3, None, '___sec35'),
              (' Running the web application ', 3, None, '___sec36'),
              (' Computing convergence rates ',
               2,
               'decay:convergence:rate',
               'decay:convergence:rate'),
              (' Estimating $r$ ', 3, None, '___sec38'),
              (' Implementation ', 3, None, '___sec39'),
              (' Debugging via convergence rates ', 3, None, '___sec40'),
              (' Memory-saving implementation ', 2, None, '___sec41'),
              (' Software engineering ', 1, None, '___sec42'),
              (' Making a module ',
               2,
               'decay:prog:se:module',
               'decay:prog:se:module'),
              (' Prefixing imported functions by the module name ',
               2,
               'decay:prog:se:import',
               'decay:prog:se:import'),
              (' Doctests ',
               2,
               'decay:prog:se:doctest',
               'decay:prog:se:doctest'),
              (' Unit testing with nose ',
               2,
               'decay:prog:se:nose',
               'decay:prog:se:nose'),
              (' Basic use of nose ', 3, None, '___sec47'),
              (' Alternative assert statements ', 3, None, '___sec48'),
              (' Applying nose ', 3, None, '___sec49'),
              (' Installation of nose ', 3, None, '___sec50'),
              (' Using nose to test modules with doctests ',
               3,
               None,
               '___sec51'),
              (' Classical class-based unit testing ',
               2,
               'decay:prog:se:unittest',
               'decay:prog:se:unittest'),
              (' Basic use of unittest ', 3, None, '___sec53'),
              (' Demonstration of unittest ', 3, None, '___sec54'),
              (' Implementing simple problem and solver classes ',
               2,
               'decay:prog:se:class',
               'decay:prog:se:class'),
              (' The problem class ', 3, None, '___sec56'),
              (' The solver class ', 3, None, '___sec57'),
              (' The visualizer class ', 3, None, '___sec58'),
              (' Combing the objects ', 3, None, '___sec59'),
              (' Improving the problem and solver classes ',
               2,
               'decay:prog:se:class2',
               'decay:prog:se:class2'),
              (' A generic class for parameters ', 3, None, '___sec61'),
              (' The problem class ', 3, None, '___sec62'),
              (' The solver class ', 3, None, '___sec63'),
              (' The visualizer class ', 3, None, '___sec64'),
              (' Performing scientific experiments ',
               1,
               'decay:experiments',
               'decay:experiments'),
              (' Software ', 2, None, '___sec66'),
              (' Combining plot files ', 2, None, '___sec67'),
              (' Interpreting output from other programs ',
               2,
               None,
               '___sec68'),
              (' Making a report ',
               2,
               'decay:exper:report',
               'decay:exper:report'),
              (' Plain HTML ', 3, None, '___sec70'),
              (' HTML with MathJax ', 3, None, '___sec71'),
              (' LaTeX ', 3, None, '___sec72'),
              (' Sphinx ', 3, None, '___sec73'),
              (' Markdown ', 3, None, '___sec74'),
              (' Wiki formats ', 3, None, '___sec75'),
              (' Doconce ', 3, None, '___sec76'),
              (' Worked example ', 3, None, '___sec77'),
              (' Publishing a complete project ',
               2,
               'decay:exper:github',
               'decay:exper:github'),
              (' Exercises ', 1, None, '___sec79'),
              (" Exercise 1: Derive schemes for Newton's law of cooling ",
               2,
               'decay:app:exer:cooling:schemes',
               'decay:app:exer:cooling:schemes'),
              (" Exercise 2: Implement schemes for Newton's law of cooling ",
               2,
               'decay:app:exer:cooling:py',
               'decay:app:exer:cooling:py'),
              (' Exercise 3: Find time of murder from body temperature ',
               2,
               'decay:app:exer:cooling:murder',
               'decay:app:exer:cooling:murder'),
              (' Exercise 4: Experiment with integer division ',
               2,
               'decay:exer:intdiv',
               'decay:exer:intdiv'),
              (' Exercise 5: Experiment with wrong computations ',
               2,
               'decay:exer:decay1err',
               'decay:exer:decay1err'),
              (' Exercise 6: Plot the error function ',
               2,
               'decay:exer:plot:error',
               'decay:exer:plot:error'),
              (' Exercise 7: Compare methods for a given time mesh ',
               2,
               'decay:exer:plot:dtconst',
               'decay:exer:plot:dtconst'),
              (' Exercise 8: Change formatting of numbers and debug ',
               2,
               'decay:exer:inexact:output',
               'decay:exer:inexact:output'),
              (' Problem 1: Write a doctest ',
               2,
               'decay:exer:doctest1',
               'decay:exer:doctest1'),
              (' Problem 2: Write a nose test ',
               2,
               'decay:exer:nosetest1',
               'decay:exer:nosetest1'),
              (' Problem 3: Make a module ',
               2,
               'decay:exer:module1',
               'decay:exer:module1'),
              (' Exercise 9: Make use of a class implementation ',
               2,
               'decay:exer:decay_class:exper',
               'decay:exer:decay_class:exper'),
              (' Exercise 10: Generalize a class implementation ',
               2,
               'decay:exer:decay_class2',
               'decay:exer:decay_class2'),
              (' Exercise 11: Generalize an advanced class implementation ',
               2,
               'decay:exer:decay_class3',
               'decay:exer:decay_class3'),
              (' Analysis of finite difference equations ',
               1,
               'decay:analysis',
               'decay:analysis'),
              (' Discouraging numerical solutions ', 3, None, '___sec95'),
              (' Experimental investigation of oscillatory solutions ',
               2,
               None,
               '___sec96'),
              (' Exact numerical solution ', 2, None, '___sec97'),
              (' Stability ', 2, None, '___sec98'),
              (' Comparing amplification factors ', 2, None, '___sec99'),
              (' Series expansion of amplification factors ',
               2,
               None,
               '___sec100'),
              (' The fraction of numerical and exact amplification factors ',
               2,
               None,
               '___sec101'),
              (' The true error at a point ',
               2,
               'decay:analysis:gobal:error',
               'decay:analysis:gobal:error'),
              (' Integrated errors ', 2, None, '___sec103'),
              (' Truncation error ', 2, None, '___sec104'),
              (' Consistency, stability, and convergence ',
               2,
               None,
               '___sec105'),
              (' Exercises ', 1, None, '___sec106'),
              (' Exercise 12: Visualize the accuracy of finite differences $u=e^{-at}$ ',
               2,
               'decay:analysis:exer:fd:exp:plot',
               'decay:analysis:exer:fd:exp:plot'),
              (' Exercise 13: Explore the $\\theta$-rule for exponential growth ',
               2,
               'decay:analysis:exer:growth',
               'decay:analysis:exer:growth'),
              (' Model extensions ', 1, None, '___sec109'),
              (' Generalization: including a variable coefficient ',
               2,
               None,
               '___sec110'),
              (' Generalization: including a source term ',
               2,
               'decay:source',
               'decay:source'),
              (' Schemes ', 3, None, '___sec112'),
              (' Implementation of the generalized model problem ',
               2,
               'decay:general',
               'decay:general'),
              (' Deriving the $\\theta$-rule formula ', 3, None, '___sec114'),
              (' The Python code ', 3, None, '___sec115'),
              (' Coding of variable coefficients ', 3, None, '___sec116'),
              (' Verifying a constant solution ',
               2,
               'decay:verify:trivial',
               'decay:verify:trivial'),
              (' Verification via manufactured solutions ',
               2,
               'decay:MMS',
               'decay:MMS'),
              (' Extension to systems of ODEs ', 2, None, '___sec119'),
              (' General first-order ODEs ', 1, None, '___sec120'),
              (' Generic form ', 2, None, '___sec121'),
              (' The $\\theta$-rule ', 2, None, '___sec122'),
              (' An implicit 2-step backward scheme ', 2, None, '___sec123'),
              (' Leapfrog schemes ', 2, None, '___sec124'),
              (' The ordinary Leapfrog scheme ', 3, None, '___sec125'),
              (' The filtered Leapfrog scheme ', 3, None, '___sec126'),
              (' The 2nd-order Runge-Kutta scheme ', 2, None, '___sec127'),
              (' A 2nd-order Taylor-series method ', 2, None, '___sec128'),
              (' The 2nd- and 3rd-order Adams-Bashforth schemes ',
               2,
               None,
               '___sec129'),
              (' 4th-order Runge-Kutta scheme ',
               2,
               'decay:fd2:RK4',
               'decay:fd2:RK4'),
              (' The Odespy software ', 2, None, '___sec131'),
              (' Example: Runge-Kutta methods  ', 2, None, '___sec132'),
              (' Remark about using the $\\theta$-rule in Odespy ',
               3,
               None,
               '___sec133'),
              (' Example: Adaptive Runge-Kutta methods  ',
               2,
               'decay:fd2:adaptiveRK',
               'decay:fd2:adaptiveRK'),
              (' Exercises ', 1, None, '___sec135'),
              (' Exercise 14: Experiment with precision in tests and the size of $u$ ',
               2,
               'decay:fd2:exer:precision',
               'decay:fd2:exer:precision'),
              (' Exercise 15: Implement the 2-step backward scheme ',
               2,
               'decay:fd2:exer:bw2',
               'decay:fd2:exer:bw2'),
              (' Exercise 16: Implement the 2nd-order Adams-Bashforth scheme ',
               2,
               'decay:fd2:exer:AB2',
               'decay:fd2:exer:AB2'),
              (' Exercise 17: Implement the 3rd-order Adams-Bashforth scheme ',
               2,
               'decay:fd2:exer:AB3',
               'decay:fd2:exer:AB3'),
              (' Exercise 18: Analyze explicit 2nd-order methods ',
               2,
               'decay:exer:RK2:Taylor:analysis',
               'decay:exer:RK2:Taylor:analysis'),
              (' Problem 4: Implement and investigate the Leapfrog scheme ',
               2,
               'decay:fd2:exer:leapfrog1',
               'decay:fd2:exer:leapfrog1'),
              (' Problem 5: Make a unified implementation of many schemes ',
               2,
               'decay:fd2:exer:uni',
               'decay:fd2:exer:uni'),
              (' Applications of exponential decay models ',
               1,
               'decay:app',
               'decay:app'),
              (' Scaling ', 2, 'decay:app:scaling', 'decay:app:scaling'),
              (' Evolution of a population ',
               2,
               'decay:app:pop',
               'decay:app:pop'),
              (' Compound interest and inflation ',
               2,
               'decay:app:interest',
               'decay:app:interest'),
              (' Radioactive Decay ',
               2,
               'decay:app:nuclear',
               'decay:app:nuclear'),
              (' Deterministic model ', 3, None, '___sec148'),
              (' Stochastic model ', 3, None, '___sec149'),
              (' Relation between stochastic and deterministic models ',
               3,
               None,
               '___sec150'),
              (" Newton's law of cooling ",
               2,
               'decay:app:Newton:cooling',
               'decay:app:Newton:cooling'),
              (' Decay of atmospheric pressure with altitude ',
               2,
               'decay:app:atm',
               'decay:app:atm'),
              (' Multiple atmospheric layers ', 3, None, '___sec153'),
              (' Simplification: $L=0$ ', 3, None, '___sec154'),
              (' Simplification: one-layer model ', 3, None, '___sec155'),
              (' Compaction of sediments ',
               2,
               'decay:app:sediment',
               'decay:app:sediment'),
              (' Vertical motion of a body in a viscous fluid ',
               2,
               'decay:app:drag',
               'decay:app:drag'),
              (' Overview of forces ', 3, None, '___sec158'),
              (' Equation of motion ', 3, None, '___sec159'),
              (' Terminal velocity ', 3, None, '___sec160'),
              (' A Crank-Nicolson scheme ', 3, None, '___sec161'),
              (' Physical data ', 3, None, '___sec162'),
              (' Verification ', 3, None, '___sec163'),
              (' Scaling ', 3, None, '___sec164'),
              (' Decay ODEs from solving a PDE by Fourier expansions ',
               2,
               'decay:app:diffusion:Fourier',
               'decay:app:diffusion:Fourier'),
              (' Exercises ', 1, None, '___sec166'),
              (' Exercise 19: Simulate an oscillating cooling process ',
               2,
               'decay:app:exer:cooling:osc',
               'decay:app:exer:cooling:osc'),
              (' Exercise 20: Radioactive decay of Carbon-14 ',
               2,
               'decay:app:exer:radio:C14',
               'decay:app:exer:radio:C14'),
              (' Exercise 21: Simulate stochastic radioactive decay ',
               2,
               'decay:app:exer:stoch:nuclear',
               'decay:app:exer:stoch:nuclear'),
              (' Exercise 22: Radioactive decay of two substances ',
               2,
               'decay:app:exer:radio:twosubst',
               'decay:app:exer:radio:twosubst'),
              (' Exercise 23: Simulate the pressure drop in the atmosphere ',
               2,
               'decay:app:exer:atm1',
               'decay:app:exer:atm1'),
              (' Exercise 24: Make a program for vertical motion in a fluid ',
               2,
               'decay:app:exer:drag:prog',
               'decay:app:exer:drag:prog'),
              (' Project 1: Simulate parachuting ',
               2,
               'decay:app:exer:parachute',
               'decay:app:exer:parachute'),
              (' Exercise 25: Formulate vertical motion in the atmosphere ',
               2,
               'decay:app:exer:drag:atm1',
               'decay:app:exer:drag:atm1'),
              (' Exercise 26: Simulate vertical motion in the atmosphere ',
               2,
               'decay:app:exer:drag:atm2',
               'decay:app:exer:drag:atm2'),
              (' Exercise 27: Compute $y=|x|$ by solving an ODE ',
               2,
               'decay:app:exer:signum',
               'decay:app:exer:signum'),
              (' Exercise 28: Simulate growth of a fortune with random interest rate ',
               2,
               'decay:app:exer:interest',
               'decay:app:exer:interest'),
              (' Exercise 29: Simulate a population in a changing environment ',
               2,
               'decay:app:exer:pop:at',
               'decay:app:exer:pop:at'),
              (' Exercise 30: Simulate logistic growth ',
               2,
               'decay:app:exer:pop:logistic1',
               'decay:app:exer:pop:logistic1'),
              (' Exercise 31: Rederive the equation for continuous compound interest ',
               2,
               'decay:app:exer:interest:derive',
               'decay:app:exer:interest:derive')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">


<!-- newcommands_keep.tex -->
$$
\newcommand{\uex}{u_{\small\mbox{e}}}
\newcommand{\Aex}{A_{\small\mbox{e}}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\halfi}{{1/2}}
\newcommand{\ts}{\thinspace .}

\newcommand{\Ddt}[1]{\frac{D #1}{dt}}
\newcommand{\E}[1]{\hbox{E}\lbrack #1 \rbrack}
\newcommand{\Var}[1]{\hbox{Var}\lbrack #1 \rbrack}
\newcommand{\Std}[1]{\hbox{Std}\lbrack #1 \rbrack}

\newcommand{\xpoint}{\boldsymbol{x}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\Oof}[1]{{\cal O}(#1)}

\newcommand{\x}{\boldsymbol{x}}
\newcommand{\X}{\boldsymbol{X}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\w}{\boldsymbol{w}}
\newcommand{\V}{\boldsymbol{V}}
\newcommand{\e}{\boldsymbol{e}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\strain}{\boldsymbol{\varepsilon}}
\newcommand{\stressc}{{\sigma}}
\newcommand{\strainc}{{\varepsilon}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\T}{\boldsymbol{T}}

% Unit vectors
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
\newcommand{\ir}{\boldsymbol{i}_r}
\newcommand{\ith}{\boldsymbol{i}_{\theta}}
\newcommand{\iz}{\boldsymbol{i}_z}

% Index sets
\newcommand{\Ix}{{\cal I}_x}
\newcommand{\Iy}{{\cal I}_y}
\newcommand{\Iz}{{\cal I}_z}
\newcommand{\It}{{\cal I}_t}
\newcommand{\setb}[1]{{#1}^0}    % set begin
\newcommand{\sete}[1]{{#1}^{-1}} % set end
%\newcommand{\setl}[1]{#1\setminus\{\set1{#1}\}}
%\newcommand{\setr}[1]{#1\setminus\{\set0{#1}\}}
%\newcommand{\seti}[1]{#1\setminus\{\set0{#1},\set1{#1}\}}
\newcommand{\setl}[1]{{#1}^-}
\newcommand{\setr}[1]{{#1}^+}
\newcommand{\seti}[1]{{#1}^i}

% Finite elements
\newcommand{\basphi}{\varphi}
\newcommand{\baspsi}{\psi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\psib}{\boldsymbol{\psi}}
\newcommand{\sinL}[1]{\sin\left((#1+1)\pi\frac{x}{L}\right)}
\newcommand{\xno}[1]{x_{#1}}
%\newcommand{\xno}[1]{x^{(#1)}}
\newcommand{\Xno}[1]{X_{(#1)}}
\newcommand{\yno}[1]{y_{#1}}
\newcommand{\Yno}[1]{Y_{(#1)}}
\newcommand{\xdno}[1]{\boldsymbol{x}_{#1}}

% FEniCS commands
\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Integerp}{\mathbb{N}}
\newcommand{\Integer}{\mathbb{Z}}
$$




    
<a name="part0000"></a>
<!-- begin top navigation -->
<a href="._part0001_main_decay-solarized.html"><img src="https://doconce.googlecode.com/hg/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end top navigation -->

<p>
<!-- ------------------- main content ---------------------- -->


<title>Introduction to computing with finite difference methods</title>

<center><h1>Introduction to computing with finite difference methods</h1></center>  <!-- document title -->

<p>
<!-- author(s): Hans Petter Langtangen -->

<center>
<b>Hans Petter Langtangen</b> [1, 2]
</center>


<p>
<!-- institution(s) -->

<center>[1] <b>Center for Biomedical Computing, Simula Research Laboratory</b></center>
<center>[2] <b>Department of Informatics, University of Oslo</b></center>
<p>
<center><h4>Aug 21, 2013</h4></center> <!-- date -->
<p>
Note: <b>PRELIMINARY VERSION</b>

<h2>Table of contents</h2>

<p>
<a href="._part0001_main_decay-solarized.html#decay:basics"> Finite difference methods  </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0001_main_decay-solarized.html#decay:model"> A basic model for exponential decay </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0001_main_decay-solarized.html#decay:schemes:FE"> The Forward Euler scheme </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0001_main_decay-solarized.html#___sec3"> Step 1: Discretizing the domain </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0001_main_decay-solarized.html#___sec4"> Step 2: Fulfilling the equation at discrete time points </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0001_main_decay-solarized.html#___sec5"> Step 3: Replacing derivatives by finite differences </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0001_main_decay-solarized.html#___sec6"> Step 4: Formulating a recursive algorithm </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0001_main_decay-solarized.html#decay:schemes:BE"> The Backward Euler scheme </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0001_main_decay-solarized.html#decay:schemes:CN"> The Crank-Nicolson scheme </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0001_main_decay-solarized.html#decay:schemes:theta"> The unifying \( \theta \)-rule </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0001_main_decay-solarized.html#___sec10"> Constant time step </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0001_main_decay-solarized.html#decay:fd:op"> Compact operator notation for finite differences </a><br>
<a href="._part0002_main_decay-solarized.html#decay:impl1"> Implementation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#decay:py1"> Making a solver function </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec14"> Function for computing the numerical solution </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec15"> Integer division </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec16"> Doc strings </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec17"> Formatting of numbers </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec18"> Running the program </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec19"> Verifying the implementation </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec20"> Running a few algorithmic steps by hand </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec21"> Comparison with an exact discrete solution </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#decay:computing:error"> Computing the numerical error as a mesh function </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#decay:computing:error:norm"> Computing the norm of the numerical error </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec24"> Scalar computing </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#decay:plotting"> Plotting solutions </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec26"> Plotting multiple curves </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec27"> Experiments with computing and plotting </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec28"> Combining plot files </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec29"> Plotting with SciTools </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#decay:commandline"> Creating command-line interfaces </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec31"> Reading a sequence of command-line arguments </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec32"> Working with an argument parser </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec33"> Creating a graphical web user interface </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec34"> Making a compute function </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec35"> Generating the user interface </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec36"> Running the web application </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#decay:convergence:rate"> Computing convergence rates </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec38"> Estimating \( r \) </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec39"> Implementation </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec40"> Debugging via convergence rates </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0002_main_decay-solarized.html#___sec41"> Memory-saving implementation </a><br>
<a href="._part0003_main_decay-solarized.html#___sec42"> Software engineering </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#decay:prog:se:module"> Making a module </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#decay:prog:se:import"> Prefixing imported functions by the module name </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#decay:prog:se:doctest"> Doctests </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#decay:prog:se:nose"> Unit testing with nose </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec47"> Basic use of nose </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec48"> Alternative assert statements </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec49"> Applying nose </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec50"> Installation of nose </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec51"> Using nose to test modules with doctests </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#decay:prog:se:unittest"> Classical class-based unit testing </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec53"> Basic use of unittest </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec54"> Demonstration of unittest </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#decay:prog:se:class"> Implementing simple problem and solver classes </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec56"> The problem class </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec57"> The solver class </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec58"> The visualizer class </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec59"> Combing the objects </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#decay:prog:se:class2"> Improving the problem and solver classes </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec61"> A generic class for parameters </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec62"> The problem class </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec63"> The solver class </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0003_main_decay-solarized.html#___sec64"> The visualizer class </a><br>
<a href="._part0004_main_decay-solarized.html#decay:experiments"> Performing scientific experiments </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#___sec66"> Software </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#___sec67"> Combining plot files </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#___sec68"> Interpreting output from other programs </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#decay:exper:report"> Making a report </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#___sec70"> Plain HTML </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#___sec71"> HTML with MathJax </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#___sec72"> LaTeX </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#___sec73"> Sphinx </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#___sec74"> Markdown </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#___sec75"> Wiki formats </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#___sec76"> Doconce </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#___sec77"> Worked example </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0004_main_decay-solarized.html#decay:exper:github"> Publishing a complete project </a><br>
<a href="._part0005_main_decay-solarized.html#___sec79"> Exercises </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:app:exer:cooling:schemes"> Exercise 1: Derive schemes for Newton's law of cooling </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:app:exer:cooling:py"> Exercise 2: Implement schemes for Newton's law of cooling </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:app:exer:cooling:murder"> Exercise 3: Find time of murder from body temperature </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:exer:intdiv"> Exercise 4: Experiment with integer division </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:exer:decay1err"> Exercise 5: Experiment with wrong computations </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:exer:plot:error"> Exercise 6: Plot the error function </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:exer:plot:dtconst"> Exercise 7: Compare methods for a given time mesh </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:exer:inexact:output"> Exercise 8: Change formatting of numbers and debug </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:exer:doctest1"> Problem 1: Write a doctest </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:exer:nosetest1"> Problem 2: Write a nose test </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:exer:module1"> Problem 3: Make a module </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:exer:decay_class:exper"> Exercise 9: Make use of a class implementation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:exer:decay_class2"> Exercise 10: Generalize a class implementation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0005_main_decay-solarized.html#decay:exer:decay_class3"> Exercise 11: Generalize an advanced class implementation </a><br>
<a href="._part0006_main_decay-solarized.html#decay:analysis"> Analysis of finite difference equations </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#___sec95"> Discouraging numerical solutions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#___sec96"> Experimental investigation of oscillatory solutions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#___sec97"> Exact numerical solution </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#___sec98"> Stability </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#___sec99"> Comparing amplification factors </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#___sec100"> Series expansion of amplification factors </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#___sec101"> The fraction of numerical and exact amplification factors </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#decay:analysis:gobal:error"> The true error at a point </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#___sec103"> Integrated errors </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#___sec104"> Truncation error </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#___sec105"> Consistency, stability, and convergence </a><br>
<a href="._part0006_main_decay-solarized.html#___sec106"> Exercises </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#decay:analysis:exer:fd:exp:plot"> Exercise 12: Visualize the accuracy of finite differences \( u=e^{-at} \) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0006_main_decay-solarized.html#decay:analysis:exer:growth"> Exercise 13: Explore the \( \theta \)-rule for exponential growth </a><br>
<a href="._part0007_main_decay-solarized.html#___sec109"> Model extensions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec110"> Generalization: including a variable coefficient </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:source"> Generalization: including a source term </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec112"> Schemes </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:general"> Implementation of the generalized model problem </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec114"> Deriving the \( \theta \)-rule formula </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec115"> The Python code </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec116"> Coding of variable coefficients </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:verify:trivial"> Verifying a constant solution </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:MMS"> Verification via manufactured solutions </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec119"> Extension to systems of ODEs </a><br>
<a href="._part0007_main_decay-solarized.html#___sec120"> General first-order ODEs </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec121"> Generic form </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec122"> The \( \theta \)-rule </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec123"> An implicit 2-step backward scheme </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec124"> Leapfrog schemes </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec125"> The ordinary Leapfrog scheme </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec126"> The filtered Leapfrog scheme </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec127"> The 2nd-order Runge-Kutta scheme </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec128"> A 2nd-order Taylor-series method </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec129"> The 2nd- and 3rd-order Adams-Bashforth schemes </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:fd2:RK4"> 4th-order Runge-Kutta scheme </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec131"> The Odespy software </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec132"> Example: Runge-Kutta methods  </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#___sec133"> Remark about using the \( \theta \)-rule in Odespy </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:fd2:adaptiveRK"> Example: Adaptive Runge-Kutta methods  </a><br>
<a href="._part0007_main_decay-solarized.html#___sec135"> Exercises </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:fd2:exer:precision"> Exercise 14: Experiment with precision in tests and the size of \( u \) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:fd2:exer:bw2"> Exercise 15: Implement the 2-step backward scheme </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:fd2:exer:AB2"> Exercise 16: Implement the 2nd-order Adams-Bashforth scheme </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:fd2:exer:AB3"> Exercise 17: Implement the 3rd-order Adams-Bashforth scheme </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:exer:RK2:Taylor:analysis"> Exercise 18: Analyze explicit 2nd-order methods </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:fd2:exer:leapfrog1"> Problem 4: Implement and investigate the Leapfrog scheme </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0007_main_decay-solarized.html#decay:fd2:exer:uni"> Problem 5: Make a unified implementation of many schemes </a><br>
<a href="._part0008_main_decay-solarized.html#decay:app"> Applications of exponential decay models </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:scaling"> Scaling </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:pop"> Evolution of a population </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:interest"> Compound interest and inflation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:nuclear"> Radioactive Decay </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec148"> Deterministic model </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec149"> Stochastic model </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec150"> Relation between stochastic and deterministic models </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:Newton:cooling"> Newton's law of cooling </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:atm"> Decay of atmospheric pressure with altitude </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec153"> Multiple atmospheric layers </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec154"> Simplification: \( L=0 \) </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec155"> Simplification: one-layer model </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:sediment"> Compaction of sediments </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:drag"> Vertical motion of a body in a viscous fluid </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec158"> Overview of forces </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec159"> Equation of motion </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec160"> Terminal velocity </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec161"> A Crank-Nicolson scheme </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec162"> Physical data </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec163"> Verification </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#___sec164"> Scaling </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:diffusion:Fourier"> Decay ODEs from solving a PDE by Fourier expansions </a><br>
<a href="._part0008_main_decay-solarized.html#___sec166"> Exercises </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:cooling:osc"> Exercise 19: Simulate an oscillating cooling process </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:radio:C14"> Exercise 20: Radioactive decay of Carbon-14 </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:stoch:nuclear"> Exercise 21: Simulate stochastic radioactive decay </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:radio:twosubst"> Exercise 22: Radioactive decay of two substances </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:atm1"> Exercise 23: Simulate the pressure drop in the atmosphere </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:drag:prog"> Exercise 24: Make a program for vertical motion in a fluid </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:parachute"> Project 1: Simulate parachuting </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:drag:atm1"> Exercise 25: Formulate vertical motion in the atmosphere </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:drag:atm2"> Exercise 26: Simulate vertical motion in the atmosphere </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:signum"> Exercise 27: Compute \( y=|x| \) by solving an ODE </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:interest"> Exercise 28: Simulate growth of a fortune with random interest rate </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:pop:at"> Exercise 29: Simulate a population in a changing environment </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:pop:logistic1"> Exercise 30: Simulate logistic growth </a><br>
&nbsp; &nbsp; &nbsp; <a href="._part0008_main_decay-solarized.html#decay:app:exer:interest:derive"> Exercise 31: Rederive the equation for continuous compound interest </a><br>

<p>
Finite difference methods for partial differential equations (PDEs)
employ a range of concepts and tools that can be introduced and
illustrated in the context of simple ordinary differential equation
(ODE) examples.  This is what we do in the present document.  By
first working with ODEs, we keep the mathematical problems to be
solved as simple as possible (but no simpler), thereby allowing full
focus on understanding the key concepts and tools.  The choice of
topics in the forthcoming treatment of ODEs is therefore solely
dominated by what carries over to numerical methods for PDEs.

<p>
Theory and practice are primarily illustrated by solving the
very simple ODE \( u'=-au \), \( u(0)=I \), where \( a>0 \) is a constant,
but we also address the generalized problem \( u'=-a(t)u + b(t) \)
and the nonlinear problem \( u'=f(u,t) \).
The following topics are introduced:

<p>

<ul>
 <li> How to think when constructing finite difference methods, with special focus
   on the Forward Euler, Backward Euler, and Crank-Nicolson (midpoint)
   schemes</li>
 <li> How to formulate a computational algorithm and translate it into
   Python code</li>
 <li> How to make curve plots of the solutions</li>
 <li> How to compute numerical errors</li>
 <li> How to compute convergence rates</li>
 <li> How to verify an implementation and automate verification
   through nose tests in Python</li>
 <li> How to structure code in terms of functions, classes, and modules</li>
 <li> How to work with Python concepts such as arrays, lists, dictionaries,
   lambda functions, functions in functions (closures), doctests,
   unit tests, command-line interfaces, graphical user interfaces</li>
 <li> How to perform array computing and understand the difference from
   scalar computing</li>
 <li> How to conduct and automate large-scale numerical experiments</li>
 <li> How to generate scientific reports</li>
 <li> How to uncover numerical artifacts in the computed solution</li>
 <li> How to analyze the numerical schemes mathematically to understand
   why artifacts occur</li>
 <li> How to derive mathematical expressions for various measures of
   the error in numerical methods, frequently by using the <code>sympy</code> software
   for symbolic computation</li>
 <li> Introduce concepts such as finite difference operators,
   mesh (grid), mesh functions,
   stability, truncation error, consistency, and convergence</li>
 <li> Present additional methods for the general nonlinear ODE \( u'=f(u,t) \),
   which is either a scalar ODE or a system of ODEs</li>
 <li> How to access professional packages for solving ODEs</li>
 <li> How the model equation \( u'=-au \) arises in a wide range
   of phenomena in physics, biology, and finance</li>
</ul>

<div class="alert alert-block alert-summary alert-text-normal"><b>The exposition in a nutshell.</b>
Everything we cover is put into a practical, hands-on context. All
mathematics is translated into working computing codes, and all the
mathematical theory of finite difference methods presented here is
motivated from a strong need to understand strange behavior of programs.
Two fundamental questions saturate the text:

<p>

<ul>
 <li> How to we solve a differential equation problem and produce numbers?</li>
 <li> How to we trust the answer?</li>
</ul>
</div>
<p>
<p>
<!-- begin bottom navigation -->
<a href="._part0001_main_decay-solarized.html"><img src="https://doconce.googlecode.com/hg/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end bottom navigation -->

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

