<?xml version="1.0" encoding="utf-8" ?>
<!--
Automatically generated HTML file from Doconce source
(http://code.google.com/p/doconce/)
-->

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: http://code.google.com/p/doconce/" />

<!--
Color definitions:  http://www.december.com/html/spec/color0.html
CSS examples:       http://www.w3schools.com/css/css_examples.asp
-->

<style type="text/css">
    body {
      margin-top: 1.0em;
      background-color: #ffffff;
      font-family: Helvetica, Arial, FreeSans, san-serif;
      color: #000000;
    }
    h1 { font-size: 1.8em; color: #1e36ce; }
    h2 { font-size: 1.5em; color: #1e36ce; }
    h3 { color: #1e36ce; }
    a { color: #1e36ce; text-decoration:none; }
    tt { font-family: "Courier New", Courier; }
    pre { background: #ededed; color: #000; padding: 15px;}
    p { text-indent: 0px; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}

</style>

<!-- Use MathJax to render mathematics -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">

</head>

<body>
    

<!-- ------------------- main content ------------------------>

<title>Default choice of the final project in INF5620</title>

<center><h1>Default choice of the final project in INF5620</h1></center>  <! -- document title -->

<p>

<!-- --- begin exercise -->

<p>

<h3>Project 1: Nonlinear diffusion equation  <a name="___sec0"></a></h3>
<p>
Project size: approximately 60 h. This particular project will have
significant overlap with topics for the final exam.

<p>
The goal of this project is to discuss various numerical aspects of
a nonlinear diffusion model:

<p>
$$ \varrho u_t = \nabla\cdot (\alpha (u)\nabla u) + f(\pmb{x}, t),$$
with initial condition \( u(\pmb{x},0)=I(x) \) and boundary condition
\( \partial u/\partial n=0 \). The coefficiet \( \varrho \) is constant
and \( \alpha(u) \) is a known function of \( u \).

<p>

<b>a)</b> Introduce some finite difference approximation in time that leads
to an implicit scheme (say a Backward Euler, Crank-Nicolson, or 2-step
backward scheme).
Derive a variational formulation of the initial condition
and the spatial problem to be solved at each time step (and at
the first time step in case of a 2-step backward scheme).

<p>
<b>b)</b> Formulate a Picard iteration method at the PDE level, using
the most recently computed \( u \) function in the \( \alpha(u) \)
coefficient. Derive general formulas for the entries in the linear system to be
solved in each Picard iteration.
Use the solution at the previous time step as initial guess for the
Picard iteration.

<p>
<b>c)</b> Restrict the Picard iteration to a single iteration. That is,
simply use a \( u \) value from the previous time step in the \( \alpha(u) \)
coefficient. Implement this method with the aid of
the FEniCS software (in a dimension-independent
way).

<p>
<b>d)</b> The first verification of the FEniCS implementation may assmue
\( \alpha (u)=1 \), \( f=0 \), \( \Omega = [0,1]\times [0,1] \), P1 elements, and
\( I(x,y)= \cos (\pi x) \). The exact solution is then
\( u(x,y,t)=e^{-\pi^2 t}\cos (\pi x) \). The error
in space is then \( {\cal O}(\Delta x^2) + {\cal O}(\Delta y^2) \),
while the error in time is \( {\cal O}(\Delta t^p) \), with \( p=1 \) for
the Backward Euler scheme and \( p=2 \) for the Crank-Nicolson or the 2-step
backward schemes. Set \( h=\Delta t^p = \Delta x^2 \) and perform a
convergence rate study as \( h \) is decreased. A measure of the error \( E \) can be
computed by

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">e <span style="color: #666666">=</span> u_e<span style="color: #666666">.</span>vector()<span style="color: #666666">.</span>array() <span style="color: #666666">-</span> u<span style="color: #666666">.</span>vector()<span style="color: #666666">.</span>array()
E <span style="color: #666666">=</span> numpy<span style="color: #666666">.</span>sqrt(numpy<span style="color: #666666">.</span>sum(e<span style="color: #666666">**2</span>)<span style="color: #666666">/</span>u<span style="color: #666666">.</span>vector()<span style="color: #666666">.</span>array()<span style="color: #666666">.</span>size)
</pre></div>
<p>
for some fixed point of time, say \( t=0.05 \).
Here, <tt>u_e</tt> is a projection of the exact solution onto the function
space used for <tt>u</tt>.

<p>
Show that \( E/h \)
remains approximately constant as the mesh in space and time is
simultaneously refined.

<p>
<b>e)</b> To get an indication whether the implementation of the nonlinear
diffusion PDE is correct or not,
we can use the <em>method of manufactured solutions</em>. Say we restrict
the problem to one space dimension, \( \Omega=[0,1] \), and choose
$$ u(x,t) = t\int_0^x q(1-q)dq = tx^2\left(\frac{1}{2} - \frac{x}{3}\right)$$
and \( \alpha(u) = 1+u^2 \).
The following <tt>sympy</tt> session computes an \( f(x,t) \) such that the above \( u \)
is a solution of the PDE problem:

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #666666">&gt;&gt;&gt;</span> x, t, rho, dt <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;x t rho dt&#39;</span>)
<span style="color: #666666">&gt;&gt;&gt;</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">a</span>(u):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">1</span> <span style="color: #666666">+</span> u<span style="color: #666666">**2</span>
<span style="color: #666666">...</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">u_simple</span>(x, t):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">**2*</span>(Rational(<span style="color: #666666">1</span>,<span style="color: #666666">2</span>) <span style="color: #666666">-</span> x<span style="color: #666666">/3</span>)<span style="color: #666666">*</span>t
<span style="color: #666666">...</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #408080; font-style: italic"># Show that u_simple satisfies the BCs</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">for</span> x_point <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #666666">0</span>, <span style="color: #666666">1</span>:
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;u_x(</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">,t):&#39;</span> <span style="color: #666666">%</span> x_point,
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">print</span> diff(u_simple(x, t), x)<span style="color: #666666">.</span>subs(x, x_point)<span style="color: #666666">.</span>simplify()
<span style="color: #666666">...</span>
u_x(<span style="color: #666666">0</span>,t): <span style="color: #666666">0</span>
u_x(<span style="color: #666666">1</span>,t): <span style="color: #666666">0</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Initial condition:&#39;</span>, u_simple(x, <span style="color: #666666">0</span>)
Initial condition: <span style="color: #666666">0</span>
<span style="color: #666666">&gt;&gt;&gt;</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #408080; font-style: italic"># MMS: full nonlinear problem</span>
<span style="color: #666666">&gt;&gt;&gt;</span> u <span style="color: #666666">=</span> u_simple(x, t)
<span style="color: #666666">&gt;&gt;&gt;</span> f <span style="color: #666666">=</span> rho<span style="color: #666666">*</span>diff(u, t) <span style="color: #666666">-</span> diff(a(u)<span style="color: #666666">*</span>diff(u, x), x)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> f<span style="color: #666666">.</span>simplify()
<span style="color: #666666">-</span>rho<span style="color: #666666">*</span>x<span style="color: #666666">**3/3</span> <span style="color: #666666">+</span> rho<span style="color: #666666">*</span>x<span style="color: #666666">**2/2</span> <span style="color: #666666">+</span> <span style="color: #666666">8*</span>t<span style="color: #666666">**3*</span>x<span style="color: #666666">**7/9</span> <span style="color: #666666">-</span> <span style="color: #666666">28*</span>t<span style="color: #666666">**3*</span>x<span style="color: #666666">**6/9</span> <span style="color: #666666">+</span>
<span style="color: #666666">7*</span>t<span style="color: #666666">**3*</span>x<span style="color: #666666">**5/2</span> <span style="color: #666666">-</span> <span style="color: #666666">5*</span>t<span style="color: #666666">**3*</span>x<span style="color: #666666">**4/4</span> <span style="color: #666666">+</span> <span style="color: #666666">2*</span>t<span style="color: #666666">*</span>x <span style="color: #666666">-</span> t
</pre></div>
<p>
Compare the FEniCS solution and the \( u \) given above as a function of \( x \)
for several values of \( t \).

<p>
<b>f)</b> List the difference sources of numerical errors in the FEniCS program.

<p>
<b>g)</b> (Can be postponed.)
To verify the nonlinear PDE implementation in FEniCS, we can eliminate
the error due to a single Picard iteration by computing
a manufactured solution corresponding to \( \alpha (u_1) \), where
\( u_1 \) is the finite element function representation of the solution
at the previous time step.

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> u_1 <span style="color: #666666">=</span> u_simple(x, t<span style="color: #666666">-</span>dt)
<span style="color: #666666">&gt;&gt;&gt;</span> f <span style="color: #666666">=</span> rho<span style="color: #666666">*</span>diff(u, t) <span style="color: #666666">-</span> diff(a(u_1)<span style="color: #666666">*</span>diff(u, x), x)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> f<span style="color: #666666">.</span>simplify()
rho<span style="color: #666666">*</span>x<span style="color: #666666">**2*</span>(<span style="color: #666666">-2*</span>x <span style="color: #666666">+</span> <span style="color: #666666">3</span>)<span style="color: #666666">/6</span> <span style="color: #666666">-</span>
(<span style="color: #666666">-12*</span>t<span style="color: #666666">*</span>x <span style="color: #666666">+</span> <span style="color: #666666">3*</span>t<span style="color: #666666">*</span>(<span style="color: #666666">-2*</span>x <span style="color: #666666">+</span> <span style="color: #666666">3</span>))<span style="color: #666666">*</span>(x<span style="color: #666666">**4*</span>(<span style="color: #666666">-</span>dt <span style="color: #666666">+</span> t)<span style="color: #666666">**2*</span>(<span style="color: #666666">-2*</span>x <span style="color: #666666">+</span> <span style="color: #666666">3</span>)<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">36</span>)<span style="color: #666666">/324</span>
<span style="color: #666666">-</span> (<span style="color: #666666">-6*</span>t<span style="color: #666666">*</span>x<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">6*</span>t<span style="color: #666666">*</span>x<span style="color: #666666">*</span>(<span style="color: #666666">-2*</span>x <span style="color: #666666">+</span> <span style="color: #666666">3</span>))<span style="color: #666666">*</span>(<span style="color: #666666">36*</span>x<span style="color: #666666">**4*</span>(<span style="color: #666666">-</span>dt <span style="color: #666666">+</span> t)<span style="color: #666666">**2*</span>(<span style="color: #666666">2*</span>x <span style="color: #666666">-</span> <span style="color: #666666">3</span>)
<span style="color: #666666">+</span> <span style="color: #666666">36*</span>x<span style="color: #666666">**3*</span>(<span style="color: #666666">-</span>dt <span style="color: #666666">+</span> t)<span style="color: #666666">**2*</span>(<span style="color: #666666">-2*</span>x <span style="color: #666666">+</span> <span style="color: #666666">3</span>)<span style="color: #666666">**2</span>)<span style="color: #666666">/5832</span>
</pre></div>
<p>
Perform a convergence rate test by decreasing \( h=\Delta t^p = \Delta x^2 \).

<p>
<b>h)</b> Simulate the nonlinear diffusion of Gaussian function. Due to symmetry,
it suffices to simulate one quarter of the domain:

<p>
$$
I(x,y) = \exp{\left(-\frac{1}{2\sigma^2}\left( x^2 + y^2 \right)\right)},
\quad (x,y)\in\Omega = [0,1]\times [0,1],
$$
where \( \sigma \) measures the width of the Gaussian function.
Choose \( \alpha(u) = 1+\beta u^2 \), where \( \beta \) is a constant one can
play around with.

<p>
The rest of the exercise is theoretical and not directly related to
the FEniCS implementation.

<p>
<b>i)</b> Formulate a <em>group finite element method</em> for the \( \alpha (u) \)
coefficient and derive formulas for eqution number \( i \) in
the nonlinear algebraic system to be solved.

<p>
<b>j)</b> Derive expressions for the entries in the Jacobian matrix and the
right-hand side to be used
in a Newton method.

<p>
<b>k)</b> Reduce the problem to one space dimension.
Derive formulas for the entries in the Jacobian matrix and the
right-hand side in Newton's method using
P1 elements and the Trapezoidal rule for integration.

<p>
<b>l)</b> Compare the expressions in the previous subexercise with the
expressions arising from a finite difference method applied to
PDE problem (using the same time discretization).

<p>
<!-- --- end of exercise -->

<!-- ------------------- end of main content ----------------->
</body>
</html>
    

