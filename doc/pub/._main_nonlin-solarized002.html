<!DOCTYPE html>
<!--
Automatically generated HTML file from Doconce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Nonlinear differential equation problems">
<meta name="keywords" content="linearization explicit time integration,Picard iteration,successive substitutions,fixed-point iteration,linearization Picard iteration,linearization successive substitutions,linearization fixed-point iteration,stopping criteria (nonlinear problems),single Picard iteration technique,relaxation (nonlinear equations),stopping criteria (nonlinear problems),group finite element method,product approximation technique,continuation method,online rendering of LaTeX formulas,continuation method">



<style type="text/css">
    /* solarized style */
    body {
      margin:5;
      padding:0;
      border:0;	/* Remove the border around the viewport in old versions of IE */
      width:100%;
      background: #fdf6e3;
      min-width:600px;	/* Minimum width of layout - remove if not required */
      font-family: Verdana, Helvetica, Arial, sans-serif;
      font-size: 1.0em;
      line-height: 1.3em;
      color: #657b83;
    }
    a { color: #657b83; text-decoration:none; }
    a:hover { color: #b58900; background: #eee8d5; text-decoration:none; }
    h1, h2, h3 { margin:.8em 0 .2em 0; padding:0; line-height: 125%; }
    h2 { font-variant: small-caps; }
    pre {
      background: #fdf6e3;
      -webkit-box-shadow: inset 0 0 2px #000000;
      -moz-box-shadow: inset 0 0 2px #000000;
      box-shadow: inset 0 0 2px #000000;
      color: #586e75;
      margin-left: 0px;
      font-family: 'Droid Sans Mono', monospace;
      padding: 2px;
      -webkit-border-radius: 4px;
      -moz-border-radius: 4px;
      border-radius: 4px;
      -moz-background-clip: padding;
      -webkit-background-clip: padding-box;
      background-clip: padding-box;
    }
    tt { font-family: "Courier New", Courier; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p { text-indent: 0px; }
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .alert-text-small   { font-size: 80%;  }
    .alert-text-large   { font-size: 130%; }
    .alert-text-normal  { font-size: 90%;  }
    .alert {
             padding:8px 35px 8px 14px; margin-bottom:18px;
             text-shadow:0 1px 0 rgba(255,255,255,0.5);
             border:1px solid #FFBF00;
             -webkit-border-radius: 4px; -moz-border-radius: 4px;
             border-radius: 4px
             color: #555;
             background-color: #fbeed5;
             background-position: 10px 5px;
             background-repeat: no-repeat;
             background-size: 38px;
             padding-left: 55px;
             width: 75%;
     }
     .alert-block {padding-top:14px; padding-bottom:14px}
     .alert-block > p, .alert-block > ul {margin-bottom:1em}
     .alert li {margin-top: 1em}
     .alert-block p+p {margin-top:5px}
     .alert-notice { background-image: url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
     .alert-summary  { background-image:url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
     .alert-warning { background-image: url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
     .alert-question {background-image:url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

</style>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Basic examples using the logistic equation ',
               1,
               'nonlin:timediscrete:logistic',
               'nonlin:timediscrete:logistic'),
              (' Linearization by explicit time discretization ',
               2,
               'nonlin:timediscrete:logistic:FE',
               'nonlin:timediscrete:logistic:FE'),
              (' Exact solution of nonlinear equations ',
               2,
               'nonlin:timediscrete:logistic:roots',
               'nonlin:timediscrete:logistic:roots'),
              (' Linearization ', 2, None, '___sec3'),
              (' Picard iteration ',
               2,
               'nonlin:timediscrete:logistic:Picard',
               'nonlin:timediscrete:logistic:Picard'),
              (' Stopping criteria ', 3, None, '___sec5'),
              (' A single Picard iteration ', 3, None, '___sec6'),
              (' Linearization by a geometric mean ',
               2,
               'nonlin:timediscrete:logistic:geometric:mean',
               'nonlin:timediscrete:logistic:geometric:mean'),
              (" Newton's method ",
               2,
               'nonlin:timediscrete:logistic:Newton',
               'nonlin:timediscrete:logistic:Newton'),
              (' Relaxation ',
               2,
               'nonlin:timediscrete:logistic:relaxation',
               'nonlin:timediscrete:logistic:relaxation'),
              (' Implementation and experiments ', 2, None, '___sec10'),
              (' Generalization to a general nonlinear ODE ',
               2,
               'nonlin:ode:generic',
               'nonlin:ode:generic'),
              (' Explicit time discretization ', 3, None, '___sec12'),
              (' Backward Euler discretization ', 3, None, '___sec13'),
              (' Crank-Nicolson discretization ', 3, None, '___sec14'),
              (' Systems of nonlinear algebraic equations ',
               1,
               'nonlin:systems:alg',
               'nonlin:systems:alg'),
              (' Picard iteration ',
               2,
               'nonlin:systems:alg:Picard',
               'nonlin:systems:alg:Picard'),
              (" Newton's method ",
               2,
               'nonlin:systems:alg:Newton',
               'nonlin:systems:alg:Newton'),
              (' Stopping criteria ',
               2,
               'nonlin:systems:alg:terminate',
               'nonlin:systems:alg:terminate'),
              (' Example: A nonlinear ODE model from epidemiology ',
               2,
               'nonlin:systems:alg:SI',
               'nonlin:systems:alg:SI'),
              (' Implicit time discretization ', 3, None, '___sec20'),
              (' A Picard iteration ', 3, None, '___sec21'),
              (" Newton's method ", 3, None, '___sec22'),
              (' Linearization at the differential equation level ',
               1,
               'nonlin:pdelevel',
               'nonlin:pdelevel'),
              (' Explicit time integration ',
               2,
               'nonlin:pdelevel:explicit',
               'nonlin:pdelevel:explicit'),
              (' Picard iteration ',
               2,
               'nonlin:pdelevel:Picard',
               'nonlin:pdelevel:Picard'),
              (" Newton's method ",
               2,
               'nonlin:pdelevel:Newton',
               'nonlin:pdelevel:Newton'),
              (' Discretization of nonlinear differential equations ',
               1,
               'nonlin:alglevel:1D',
               'nonlin:alglevel:1D'),
              (' Finite difference discretizations ',
               2,
               'nonlin:alglevel:1D:fd',
               'nonlin:alglevel:1D:fd'),
              (' Discretization ', 3, None, '___sec29'),
              (' Solution of algebraic equations ', 3, None, '___sec30'),
              (' Finite element discretizations ',
               2,
               'nonlin:alglevel:1D:fe',
               'nonlin:alglevel:1D:fe'),
              (' Remark ', 3, None, '___sec32'),
              (' The group finite element method ',
               2,
               'nonlin:alglevel:1D:fe:group',
               'nonlin:alglevel:1D:fe:group'),
              (' Finite element notation ', 3, None, '___sec34'),
              (' Integrating nonlinear functions ', 3, None, '___sec35'),
              (' Finite element approximation of functions of $u$ ',
               3,
               None,
               '___sec36'),
              (' Application ', 3, None, '___sec37'),
              (' Numerical integration of nonlinear terms ',
               2,
               'nonlin:alglevel:1D:fe:f',
               'nonlin:alglevel:1D:fe:f'),
              (' Finite element discretization of a variable coefficient Laplace term ',
               2,
               'nonlin:alglevel:1D:fe:Laplace',
               'nonlin:alglevel:1D:fe:Laplace'),
              (' Picard iteration defined from the variational form ',
               2,
               'nonlin:alglevel:1D:fe:Picard',
               'nonlin:alglevel:1D:fe:Picard'),
              (" Newton's method defined from the variational form ",
               2,
               'nonlin:alglevel:1D:fe:Newton',
               'nonlin:alglevel:1D:fe:Newton'),
              (' Dirichlet conditions ', 3, None, '___sec42'),
              (' Multi-dimensional PDE problems ', 1, None, '___sec43'),
              (' Finite element discretization ',
               2,
               'nonlin:alglevel:dD:fe',
               'nonlin:alglevel:dD:fe'),
              (' Non-homogeneous Neumann conditions ', 3, None, '___sec45'),
              (' Robin conditions ', 3, None, '___sec46'),
              (' Finite difference discretization ', 2, None, '___sec47'),
              (' Continuation methods ', 2, None, '___sec48'),
              (' Exercises ', 1, 'nonlin:exer', 'nonlin:exer'),
              (' Problem 1: Determine if equations are nonlinear or not ',
               2,
               'nonlin:exer:lin:vs:nonlin',
               'nonlin:exer:lin:vs:nonlin'),
              (' Problem 2: Linearize a nonlinear vibration ODE ',
               2,
               'nonlin:exer:vib:geometric:mean',
               'nonlin:exer:vib:geometric:mean'),
              (' Exercise 3: Find the sparsity of the Jacobian ',
               2,
               'nonlin:exer:sparsity:Jacobian',
               'nonlin:exer:sparsity:Jacobian'),
              (" Exercise 4: Newton's method for linear problems ",
               2,
               'nonlin:exer:Newton:linear',
               'nonlin:exer:Newton:linear'),
              (' Exercise 5: Differentiate a highly nonlinear term ',
               2,
               'nonlin:exer:grad:pow:term',
               'nonlin:exer:grad:pow:term'),
              (' Problem 6: Discretize a 1D problem with a nonlinear coefficient ',
               2,
               'nonlin:exer:1D:1pu2:fem',
               'nonlin:exer:1D:1pu2:fem'),
              (' Problem 7: Linearize a 1D problem with a nonlinear coefficient ',
               2,
               'nonlin:exer:1D:1pu2:PicardNewton',
               'nonlin:exer:1D:1pu2:PicardNewton'),
              (' Problem 8: Finite differences for the 1D Bratu problem ',
               2,
               'nonlin:exer:1D:fu:discretize:fd',
               'nonlin:exer:1D:fu:discretize:fd'),
              (' Problem 9: Integrate functions of finite element expansions ',
               2,
               'nonlin:exer:fu:fem:int',
               'nonlin:exer:fu:fem:int'),
              (' Problem 10: Finite elements for the 1D Bratu problem ',
               2,
               'nonlin:exer:1D:fu:discretize:fe',
               'nonlin:exer:1D:fu:discretize:fe'),
              (' Problem 11: Derive the Newton system from a variational form ',
               2,
               'nonlin:exer:dD:heat:nonlinear:c:a',
               'nonlin:exer:dD:heat:nonlinear:c:a'),
              (' Problem 12: Derive algebraic equations for nonlinear 1D heat conduction ',
               2,
               'nonlin:exer:1D:heat:nonlinear:c:a',
               'nonlin:exer:1D:heat:nonlinear:c:a'),
              (' Problem 13: Investigate a 1D problem with a continuation method ',
               2,
               'nonlin:exer:continuation:1DnNflow',
               'nonlin:exer:continuation:1DnNflow'),
              (' Bibliography ', 1, None, '___sec63')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">


<!-- newcommands_keep.tex -->
$$
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\uexd}[1]{{u_{\small\mbox{e}, #1}}}
\newcommand{\vex}{{v_{\small\mbox{e}}}}
\newcommand{\vexd}[1]{{v_{\small\mbox{e}, #1}}}
\newcommand{\Aex}{{A_{\small\mbox{e}}}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\halfi}{{1/2}}
\newcommand{\tp}{\thinspace .}

\newcommand{\Ddt}[1]{\frac{D #1}{dt}}
\newcommand{\E}[1]{\hbox{E}\lbrack #1 \rbrack}
\newcommand{\Var}[1]{\hbox{Var}\lbrack #1 \rbrack}
\newcommand{\Std}[1]{\hbox{Std}\lbrack #1 \rbrack}

\newcommand{\xpoint}{\boldsymbol{x}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\Oof}[1]{\mathcal{O}(#1)}

\newcommand{\x}{\boldsymbol{x}}
\newcommand{\X}{\boldsymbol{X}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\w}{\boldsymbol{w}}
\newcommand{\V}{\boldsymbol{V}}
\newcommand{\e}{\boldsymbol{e}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\strain}{\boldsymbol{\varepsilon}}
\newcommand{\stressc}{{\sigma}}
\newcommand{\strainc}{{\varepsilon}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\T}{\boldsymbol{T}}

\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
\newcommand{\ir}{\boldsymbol{i}_r}
\newcommand{\ith}{\boldsymbol{i}_{\theta}}
\newcommand{\iz}{\boldsymbol{i}_z}

\newcommand{\Ix}{\mathcal{I}_x}
\newcommand{\Iy}{\mathcal{I}_y}
\newcommand{\Iz}{\mathcal{I}_z}
\newcommand{\It}{\mathcal{I}_t}
\newcommand{\If}{\mathcal{I}_s}     % for FEM
\newcommand{\Ifd}{{I_d}}  % for FEM
\newcommand{\Ifb}{{I_b}}  % for FEM
\newcommand{\setb}[1]{#1^0}    % set begin
\newcommand{\sete}[1]{#1^{-1}} % set end
\newcommand{\setl}[1]{#1^-}
\newcommand{\setr}[1]{#1^+}
\newcommand{\seti}[1]{#1^i}
\newcommand{\sequencei}[1]{\left\{ {#1}_i \right\}_{i\in\If}}

\newcommand{\basphi}{\varphi}
\newcommand{\baspsi}{\psi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\psib}{\boldsymbol{\psi}}
\newcommand{\sinL}[1]{\sin\left((#1+1)\pi\frac{x}{L}\right)}
\newcommand{\xno}[1]{x_{#1}}
\newcommand{\Xno}[1]{X_{(#1)}}
\newcommand{\yno}[1]{y_{#1}}
\newcommand{\Yno}[1]{Y_{(#1)}}
\newcommand{\xdno}[1]{\boldsymbol{x}_{#1}}

\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Integerp}{\mathbb{N}}
\newcommand{\Integer}{\mathbb{Z}}
$$




    
<a name="part0002"></a>
<!-- begin top navigation -->
<a href="._main_nonlin-solarized001.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="previous"></a>

<a href="._main_nonlin-solarized003.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end top navigation -->

<p>
<!-- !split -->

<h2>Linearization at the differential equation level <a name="nonlin:pdelevel"></a></h2>

<p>
The attention is now turned
to nonlinear partial differential equations (PDEs)
and application of the techniques explained for ODEs.
The model problem is a nonlinear diffusion equation

<p>
$$
\begin{align}
\frac{\partial u}{\partial t} &= \nabla\cdot (\dfc(u)\nabla u) + f(u),\quad
&\x\in\Omega,\ t\in (0,T],
\tag{12}
\\ 
-\dfc(u)\frac{\partial u}{\partial n} &= g,\quad &\x\in\partial\Omega_N,\ 
t\in (0,T],
\tag{13}
\\ 
u &= u_0,\quad &\x\in\partial\Omega_D,\ t\in (0,T]\tp
\tag{14}
\end{align}
$$


<p>
Our aim is to discretize the problem in time and then present
techniques for linearizing the time-discrete PDE problem "at the PDE
level" such that we transform the nonlinear stationary PDE problems at
each time level into a sequence of linear PDE problems, which can be
solved using any method for linear PDEs. This strategy avoids the
solution systems of nonlinear algebraic equations.  In the section <a href="._main_nonlin-solarized003.html#nonlin:alglevel:1D">Discretization of nonlinear differential equations</a> we shall take the opposite (and more common)
approach: discretize the nonlinear problem in time and space first,
and then solve the resulting nonlinear algebraic equations at each
time level by the methods of the section <a href="._main_nonlin-solarized001.html#nonlin:systems:alg">Systems of nonlinear algebraic equations</a>.

<h3>Explicit time integration <a name="nonlin:pdelevel:explicit"></a></h3>

<p>
The nonlinearities in the PDE are trivial to deal with if we choose
an explicit time integration method
for <a href="#mjx-eqn-12">(12)</a>, such as the Forward Euler method:

<p>
$$ D_t^+ u = \nabla\cdot (\dfc(u)\nabla u) + f(u)]^n,$$

which leads to a linear equation in the unknown \( u^{n+1} \):

<p>
$$ \frac{u^{n+1} - u^n}{\Delta t} = \nabla\cdot (\dfc(u^n)\nabla u^n)
+ f(u^n)\tp$$


<p>
<!-- BC -->

<h3>Picard iteration <a name="nonlin:pdelevel:Picard"></a></h3>

<p>
A Backward Euler scheme for <a href="#mjx-eqn-12">(12)</a>
reads

<p>
$$ D_t^- u = \nabla\cdot (\dfc(u)\nabla u) + f(u)]^n\tp$$

Written out,

<p>
$$
\begin{equation}
\frac{u^{n} - u^{n-1}}{\Delta t} = \nabla\cdot (\dfc(u^n)\nabla u^n)
+ f(u^n)
\tag{15}
\end{equation}
$$

This is a nonlinear, stationary PDE for the unknown function \( u^n(\x) \).
We introduce a Picard iteration with \( k \) as iteration counter.
A typical linearization of the \( \nabla\cdot\dfc(u^n)\nabla u^n \) term
in iteration \( k+1 \) is to use the previously computed \( u^{n,k} \)
approximation in the diffusion coefficient: \( \dfc(u^{n,k}) \).
The nonlinear source term is treated similarly: \( f(u^{n,k}) \).
The unknown function \( u^{n,k+1} \) then fulfills the linear PDE

<p>
$$
\begin{equation}
\frac{u^{n,k+1} - u^{n-1}}{\Delta t} = \nabla\cdot (\dfc(u^{n,k})
\nabla u^{n,k+1})
+ f(u^{n,k})\tp
\tag{16}
\end{equation}
$$

The initial guess for the Picard iteration at this time level can be
taken as the solution at the previous time level: \( u^{n,0}=u^{n-1} \).

<p>
We can alternatively apply the notation where \( u \) corresponds to
the unknown we want to solve for, i.e., \( u^{n,k+1} \) above, let \( u_{-} \)
be the most recently computed value, \( u^{n,k} \) above, and let
\( u_1 \) denote the unknown function at the previous time level, \( u^{n-1} \)
above. The PDE to be solved in a Picard iteration then looks like

<p>
$$
\begin{equation}
\frac{u - u_1}{\Delta t} = \nabla\cdot (\dfc(u_{-})
\nabla u)
+ f(u_{-})\tp
\tag{17}
\end{equation}
$$

At the beginning of the iteration we start with the value from the
previous time level: \( u_{-}=u_1 \).

<h3>Newton's method <a name="nonlin:pdelevel:Newton"></a></h3>

<p>
At time level \( n \) we have to solve the stationary PDE
<a href="#mjx-eqn-15">(15)</a>, this time with Newton's method.
Normally, Newton's method is defined for systems of <em>algebraic equations</em>,
but the idea of the method can be applied at the PDE level too.

<p>
Let \( u^{n,k} \) be an approximation to \( u^n \). We seek a
better approximation on
the form

<p>
$$
\begin{equation}
u^{n} = u^{n,k} + \delta u\tp
\tag{18}
\end{equation}
$$

The idea is to insert <a href="#mjx-eqn-18">(18)</a> in
<a href="#mjx-eqn-15">(15)</a>, Taylor expand the nonlinearities
and only keep the terms that are
linear in \( \delta u \). Then we can solve a linear PDE for
the correction \( \delta u \) and use <a href="#mjx-eqn-18">(18)</a>
to find a new approximation \( u^{n,k+1}=u^{n,k}+\delta u \) to \( u^{n} \).

<p>
Inserting <a href="#mjx-eqn-18">(18)</a> in
<a href="#mjx-eqn-15">(15)</a> gives

<p>
$$
\begin{equation}
\frac{u^{n,k} +\delta u - u^{n-1}}{\Delta t} =
\nabla\cdot (\dfc(u^{n,k} + \delta u)\nabla (u^{n,k}+\delta u))
+ f(u^{n,k}+\delta u)
\tag{19}
\end{equation}
$$

We can Taylor expand \( \dfc(u^{n,k} + \delta u) \) and
\( f(u^{n,k}+\delta u) \):

<p>
$$
\begin{align*}
\dfc(u^{n,k} + \delta u) & = \dfc(u^{n,k}) + \frac{d\dfc}{du}(u^{n,k})
\delta u + \Oof{\delta u^2}\approx \dfc(u^{n,k}) + \dfc'(u^{n,k})\delta u,\\ 
f(u^{n,k}+\delta u) &=  f(u^{n,k}) + \frac{df}{du}(u^{n,k})\delta u
+ \Oof{\delta u^2}\approx f(u^{n,k}) + f'(u^{n,k})\delta u\tp
\end{align*}
$$

Inserting the linear approximations of \( \dfc \) and \( f \) in
<a href="#mjx-eqn-19">(19)</a> results in

<p>
$$
\begin{align}
\frac{u^{n,k} +\delta u - u^{n-1}}{\Delta t} &=
\nabla\cdot (\dfc(u^{n,k})\nabla u^{n,k}) + f(u^{m,k}) + \nonumber\\ 
&\quad \nabla\cdot (\dfc(u^{n,k})\nabla \delta u)
+ \nabla\cdot (\dfc'(u^{n,k})\delta u\nabla u^{n,k}) + \nonumber\\ 
&\quad \nabla\cdot (\dfc'(u^{n,k})\delta u\nabla \delta u)
+ f'(u^{n,k})\delta u
\tag{20}
\end{align}
$$

The term \( \dfc'(u^{n,k})\delta u\nabla \delta u \) is \( \Oof{\delta u^2} \)
and therefore omitted. Reorganizing the equation gives a PDE
for \( \delta u \) that we can write in short form as

<p>
$$ \delta F(\delta u; u^{n,k}) = -F(u^{n,k}),$$

where

<p>
$$
\begin{align}
F(u^{n,k}) &= \frac{u^{n,k} - u^{n-1}}{\Delta t} -
\nabla\cdot (\dfc(u^{n,k})\nabla u^{n,k}) + f(u^{n,k}),
\tag{21}\\ 
\delta F(\delta u; u^{n,k}) &=
- \frac{1}{\Delta t}\delta u +
\nabla\cdot (\dfc(u^{n,k})\nabla \delta u) + \nonumber\\ 
&\quad \nabla\cdot (\dfc'(u^{n,k})\delta u\nabla u^{n,k})
+ f'(u^{n,k})\delta u\tp
\end{align}
$$

Note that \( \delta F \) is a linear function of \( \delta u \), and
\( F \) contains only terms that are known, such that
the PDE for \( \delta u \) is indeed linear.

<p>
The form \( \delta F = -F \) resembles the Newton system \( J\delta u =-F \)
for systems of algebraic equations, with \( \delta F \) as \( J\delta u \).
The unknown vector in a linear system of algebraic equations enters
the system as a matrix-vector product (\( J\delta u \)), while at
the PDE level we have a linear differential operator instead
(\( \delta F \)).

<p>
We can rewrite the PDE for \( \delta u \) in a slightly different way too
if we define \( u^{n,k} + \delta u \) as \( u^{n,k+1} \).

<p>
$$
\begin{align}
& \frac{u^{n,k+1} - u^{n-1}}{\Delta t} =
\nabla\cdot (\dfc(u^{n,k})\nabla u^{n,k+1}) + f(u^{n,k}) + \nonumber\\ 
&\qquad  \nabla\cdot (\dfc'(u^{n,k})\delta u\nabla u^{n,k})
+ f'(u^{n,k})\delta u\tp
\end{align}
$$

Note that the first line is the same PDE as arise in the Picard
iteration, while the remaining terms arise from the differentiations
that are an inherent ingredient in Newton's method.

<p>
For coding we want to introduce \( u_{-} \) for \( u^{n,k} \) and
\( u_1 \) for \( u^{n-1} \). The formulas for \( F \) and \( \delta F \)
are then

<p>
$$
\begin{align}
F(u_{-}) &= \frac{u_{-} - u_1}{\Delta t} -
\nabla\cdot (\dfc(u_{-})\nabla u_{-}) + f(u_{-}),
\tag{22}\\ 
\delta F(\delta u; u_{-}) &=
- \frac{1}{\Delta t}\delta u +
\nabla\cdot (\dfc(u_{-})\nabla \delta u) + \nonumber\\ 
&\quad \nabla\cdot (\dfc'(u_{-})\delta u\nabla u_{-})
+ f'(u_{-})\delta u\tp
\end{align}
$$

The form that orders the PDE as the Picard iteration terms plus
the Newton method's derivative terms becomes

<p>
$$
\begin{align}
& \frac{u - u_1}{\Delta t} =
\nabla\cdot (\dfc(u_{-})\nabla u) + f(u_{-}) + \nonumber\\ 
&\qquad  \nabla\cdot (\dfc'(u_{-})\delta u\nabla u_{-})
+ f'(u_{-})\delta u\tp
\end{align}
$$


<p>
<p>
<!-- begin bottom navigation -->
<a href="._main_nonlin-solarized001.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="previous"></a>

<a href="._main_nonlin-solarized003.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end bottom navigation -->

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

