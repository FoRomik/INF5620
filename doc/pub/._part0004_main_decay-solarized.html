<!DOCTYPE html>
<!--
Automatically generated HTML file from Doconce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Introduction to computing with finite difference methods">
<meta name="keywords" content="decay ODE,exponential decay,mesh,grid,mesh function,finite differences,forward difference,finite differences forward,difference equation,discrete equation,algebraic equation,finite difference scheme,Forward Euler scheme,backward difference,finite differences backward,backward scheme, 1-step,Backward Euler scheme,Crank-Nicolson scheme,centered difference,finite differences centered,averaging arithmetic,weighted average,theta-rule,$\theta$-rule,$\theta$-rule,finite difference operator notation,operator notation, finite differences,directory,folder,doc strings,printf format,format string syntax (Python),representative (mesh function),array arithmetics,array computing,continuous function norms,norm continuous,discrete function norms,mesh function norms,norm discrete (mesh function),error norms,scalar computing,PNG plot,PDF plot,EPS plot,viewing graphics files,cropping images,user interfaces to programs,command-line arguments,reading the command line,list comprehension,option-value pairs (command line),command-line options and values,reading the command line,convergence rate,dictionary,verification,modules,test block (in modules),importing modules,doctests,software testing doctests,unit testing,software testing nose,software testing nose w/doctests,unit testing,software testing unit testing (class-based),problem class,solver class,wrapper (code),visualizer class,problem class,solver class,visualizer class,numerical experiments,scientific experiments,script,Unix wildcard notation,wildcard notation (Unix),stability,amplification factor,A-stable methods,L-stable methods,error amplification factor,error global,consistency,stability,convergence,lambda functions,method of manufactured solutions,MMS (method of manufactured solutions),implicit schemes,explicit schemes,theta-rule,$\theta$-rule,backward scheme, 2-step,BDF2 scheme,Leapfrog scheme,Leapfrog scheme, filtered,Heun's method,Runge-Kutta, 2nd-order scheme,Taylor-series methods (for ODEs),Adams-Bashforth scheme, 2nd-order,Adams-Bashforth scheme, 3rd order,Runge-Kutta, 4th-order scheme,RK4,adaptive time stepping,Dormand-Prince Runge-Kutta 4-5 method,population dynamics,logistic model,radioactive decay,terminal velocity,geometric mean,averaging geometric,scaling">



<style type="text/css">
    /* solarized style */
    body {
      margin:5;
      padding:0;
      border:0;	/* Remove the border around the viewport in old versions of IE */
      width:100%;
      background: #fdf6e3;
      min-width:600px;	/* Minimum width of layout - remove if not required */
      font-family: Verdana, Helvetica, Arial, sans-serif;
      font-size: 1.0em;
      line-height: 1.3em;
      color: #657b83;
    }
    a { color: #657b83; text-decoration:none; }
    a:hover { color: #b58900; background: #eee8d5; text-decoration:none; }
    h1, h2, h3 { margin:.8em 0 .2em 0; padding:0; line-height: 125%; }
    h2 { font-variant: small-caps; }
    pre {
      background: #fdf6e3;
      -webkit-box-shadow: inset 0 0 2px #000000;
      -moz-box-shadow: inset 0 0 2px #000000;
      box-shadow: inset 0 0 2px #000000;
      color: #586e75;
      margin-left: 0px;
      font-family: 'Droid Sans Mono', monospace;
      padding: 2px;
      -webkit-border-radius: 4px;
      -moz-border-radius: 4px;
      border-radius: 4px;
      -moz-background-clip: padding;
      -webkit-background-clip: padding-box;
      background-clip: padding-box;
    }
    tt { font-family: "Courier New", Courier; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p { text-indent: 0px; }
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .alert-text-small   { font-size: 80%;  }
    .alert-text-large   { font-size: 130%; }
    .alert-text-normal  { font-size: 90%;  }
    .alert {
             padding:8px 35px 8px 14px; margin-bottom:18px;
             text-shadow:0 1px 0 rgba(255,255,255,0.5);
             border:1px solid #FFBF00;
             -webkit-border-radius: 4px; -moz-border-radius: 4px;
             border-radius: 4px
             color: #555;
             background-color: #fbeed5;
             background-position: 10px 5px;
             background-repeat: no-repeat;
             background-size: 38px;
             padding-left: 55px;
             width: 75%;
     }
     .alert-block {padding-top:14px; padding-bottom:14px}
     .alert-block > p, .alert-block > ul {margin-bottom:1em}
     .alert li {margin-top: 1em}
     .alert-block p+p {margin-top:5px}
     .alert-notice { background-image: url(https://doconce.googlecode.com/hg/bundled/html_images/small_yellow_notice.png); }
     .alert-summary  { background-image:url(https://doconce.googlecode.com/hg/bundled/html_images/small_yellow_summary.png); }
     .alert-warning { background-image: url(https://doconce.googlecode.com/hg/bundled/html_images/small_yellow_warning.png); }
     .alert-question {background-image:url(https://doconce.googlecode.com/hg/bundled/html_images/small_yellow_question.png); }

</style>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Finite difference methods  ',
               1,
               'decay:basics',
               'decay:basics'),
              (' A basic model for exponential decay ',
               2,
               'decay:model',
               'decay:model'),
              (' The Forward Euler scheme ',
               2,
               'decay:schemes:FE',
               'decay:schemes:FE'),
              (' Step 1: Discretizing the domain ', 3, None, '___sec3'),
              (' Step 2: Fulfilling the equation at discrete time points ',
               3,
               None,
               '___sec4'),
              (' Step 3: Replacing derivatives by finite differences ',
               3,
               None,
               '___sec5'),
              (' Step 4: Formulating a recursive algorithm ',
               3,
               None,
               '___sec6'),
              (' The Backward Euler scheme ',
               2,
               'decay:schemes:BE',
               'decay:schemes:BE'),
              (' The Crank-Nicolson scheme ',
               2,
               'decay:schemes:CN',
               'decay:schemes:CN'),
              (' The unifying $\\theta$-rule ',
               2,
               'decay:schemes:theta',
               'decay:schemes:theta'),
              (' Constant time step ', 2, None, '___sec10'),
              (' Compact operator notation for finite differences ',
               2,
               'decay:fd:op',
               'decay:fd:op'),
              (' Implementation ', 1, 'decay:impl1', 'decay:impl1'),
              (' Making a solver function ', 2, 'decay:py1', 'decay:py1'),
              (' Function for computing the numerical solution ',
               3,
               None,
               '___sec14'),
              (' Integer division ', 3, None, '___sec15'),
              (' Doc strings ', 3, None, '___sec16'),
              (' Formatting of numbers ', 3, None, '___sec17'),
              (' Running the program ', 3, None, '___sec18'),
              (' Verifying the implementation ', 2, None, '___sec19'),
              (' Running a few algorithmic steps by hand ',
               3,
               None,
               '___sec20'),
              (' Comparison with an exact discrete solution ',
               3,
               None,
               '___sec21'),
              (' Computing the numerical error as a mesh function ',
               2,
               'decay:computing:error',
               'decay:computing:error'),
              (' Computing the norm of the numerical error ',
               2,
               'decay:computing:error:norm',
               'decay:computing:error:norm'),
              (' Scalar computing ', 3, None, '___sec24'),
              (' Plotting solutions ', 2, 'decay:plotting', 'decay:plotting'),
              (' Plotting multiple curves ', 3, None, '___sec26'),
              (' Experiments with computing and plotting ',
               3,
               None,
               '___sec27'),
              (' Combining plot files ', 3, None, '___sec28'),
              (' Plotting with SciTools ', 3, None, '___sec29'),
              (' Creating command-line interfaces ',
               2,
               'decay:commandline',
               'decay:commandline'),
              (' Reading a sequence of command-line arguments ',
               3,
               None,
               '___sec31'),
              (' Working with an argument parser ', 3, None, '___sec32'),
              (' Creating a graphical web user interface ',
               2,
               None,
               '___sec33'),
              (' Making a compute function ', 3, None, '___sec34'),
              (' Generating the user interface ', 3, None, '___sec35'),
              (' Running the web application ', 3, None, '___sec36'),
              (' Computing convergence rates ',
               2,
               'decay:convergence:rate',
               'decay:convergence:rate'),
              (' Estimating $r$ ', 3, None, '___sec38'),
              (' Implementation ', 3, None, '___sec39'),
              (' Debugging via convergence rates ', 3, None, '___sec40'),
              (' Memory-saving implementation ', 2, None, '___sec41'),
              (' Software engineering ', 1, None, '___sec42'),
              (' Making a module ',
               2,
               'decay:prog:se:module',
               'decay:prog:se:module'),
              (' Prefixing imported functions by the module name ',
               2,
               'decay:prog:se:import',
               'decay:prog:se:import'),
              (' Doctests ',
               2,
               'decay:prog:se:doctest',
               'decay:prog:se:doctest'),
              (' Unit testing with nose ',
               2,
               'decay:prog:se:nose',
               'decay:prog:se:nose'),
              (' Basic use of nose ', 3, None, '___sec47'),
              (' Alternative assert statements ', 3, None, '___sec48'),
              (' Applying nose ', 3, None, '___sec49'),
              (' Installation of nose ', 3, None, '___sec50'),
              (' Using nose to test modules with doctests ',
               3,
               None,
               '___sec51'),
              (' Classical class-based unit testing ',
               2,
               'decay:prog:se:unittest',
               'decay:prog:se:unittest'),
              (' Basic use of unittest ', 3, None, '___sec53'),
              (' Demonstration of unittest ', 3, None, '___sec54'),
              (' Implementing simple problem and solver classes ',
               2,
               'decay:prog:se:class',
               'decay:prog:se:class'),
              (' The problem class ', 3, None, '___sec56'),
              (' The solver class ', 3, None, '___sec57'),
              (' The visualizer class ', 3, None, '___sec58'),
              (' Combing the objects ', 3, None, '___sec59'),
              (' Improving the problem and solver classes ',
               2,
               'decay:prog:se:class2',
               'decay:prog:se:class2'),
              (' A generic class for parameters ', 3, None, '___sec61'),
              (' The problem class ', 3, None, '___sec62'),
              (' The solver class ', 3, None, '___sec63'),
              (' The visualizer class ', 3, None, '___sec64'),
              (' Performing scientific experiments ',
               1,
               'decay:experiments',
               'decay:experiments'),
              (' Software ', 2, None, '___sec66'),
              (' Combining plot files ', 2, None, '___sec67'),
              (' Interpreting output from other programs ',
               2,
               None,
               '___sec68'),
              (' Making a report ',
               2,
               'decay:exper:report',
               'decay:exper:report'),
              (' Plain HTML ', 3, None, '___sec70'),
              (' HTML with MathJax ', 3, None, '___sec71'),
              (' LaTeX ', 3, None, '___sec72'),
              (' Sphinx ', 3, None, '___sec73'),
              (' Markdown ', 3, None, '___sec74'),
              (' Wiki formats ', 3, None, '___sec75'),
              (' Doconce ', 3, None, '___sec76'),
              (' Worked example ', 3, None, '___sec77'),
              (' Publishing a complete project ',
               2,
               'decay:exper:github',
               'decay:exper:github'),
              (' Exercises and Problems ', 1, None, '___sec79'),
              (" Exercise 1: Derive schemes for Newton's law of cooling ",
               2,
               'decay:app:exer:cooling:schemes',
               'decay:app:exer:cooling:schemes'),
              (" Exercise 2: Implement schemes for Newton's law of cooling ",
               2,
               'decay:app:exer:cooling:py',
               'decay:app:exer:cooling:py'),
              (' Exercise 3: Find time of murder from body temperature ',
               2,
               'decay:app:exer:cooling:murder',
               'decay:app:exer:cooling:murder'),
              (' Exercise 4: Experiment with integer division ',
               2,
               'decay:exer:intdiv',
               'decay:exer:intdiv'),
              (' Exercise 5: Experiment with wrong computations ',
               2,
               'decay:exer:decay1err',
               'decay:exer:decay1err'),
              (' Exercise 6: Plot the error function ',
               2,
               'decay:exer:plot:error',
               'decay:exer:plot:error'),
              (' Exercise 7: Compare methods for a given time mesh ',
               2,
               'decay:exer:plot:dtconst',
               'decay:exer:plot:dtconst'),
              (' Exercise 8: Change formatting of numbers and debug ',
               2,
               'decay:exer:inexact:output',
               'decay:exer:inexact:output'),
              (' Problem 9: Write a doctest ',
               2,
               'decay:exer:doctest1',
               'decay:exer:doctest1'),
              (' Problem 10: Write a nose test ',
               2,
               'decay:exer:nosetest1',
               'decay:exer:nosetest1'),
              (' Problem 11: Make a module ',
               2,
               'decay:exer:module1',
               'decay:exer:module1'),
              (' Exercise 12: Make use of a class implementation ',
               2,
               'decay:exer:decay_class:exper',
               'decay:exer:decay_class:exper'),
              (' Exercise 13: Generalize a class implementation ',
               2,
               'decay:exer:decay_class2',
               'decay:exer:decay_class2'),
              (' Exercise 14: Generalize an advanced class implementation ',
               2,
               'decay:exer:decay_class3',
               'decay:exer:decay_class3'),
              (' Analysis of finite difference equations ',
               1,
               'decay:analysis',
               'decay:analysis'),
              (' Discouraging numerical solutions ', 3, None, '___sec95'),
              (' Experimental investigation of oscillatory solutions ',
               2,
               None,
               '___sec96'),
              (' Exact numerical solution ', 2, None, '___sec97'),
              (' Stability ', 2, None, '___sec98'),
              (' Comparing amplification factors ', 2, None, '___sec99'),
              (' Series expansion of amplification factors ',
               2,
               None,
               '___sec100'),
              (' The fraction of numerical and exact amplification factors ',
               2,
               None,
               '___sec101'),
              (' The global error at a point ',
               2,
               'decay:analysis:gobal:error',
               'decay:analysis:gobal:error'),
              (' Integrated errors ', 2, None, '___sec103'),
              (' Truncation error ', 2, None, '___sec104'),
              (' Consistency, stability, and convergence ',
               2,
               None,
               '___sec105'),
              (' Exercises ', 1, None, '___sec106'),
              (' Exercise 15: Visualize the accuracy of finite differences $u=e^{-at}$ ',
               2,
               'decay:analysis:exer:fd:exp:plot',
               'decay:analysis:exer:fd:exp:plot'),
              (' Exercise 16: Explore the $\\theta$-rule for exponential growth ',
               2,
               'decay:analysis:exer:growth',
               'decay:analysis:exer:growth'),
              (' Model extensions ', 1, None, '___sec109'),
              (' Generalization: including a variable coefficient ',
               2,
               None,
               '___sec110'),
              (' Generalization: including a source term ',
               2,
               'decay:source',
               'decay:source'),
              (' Schemes ', 3, None, '___sec112'),
              (' Implementation of the generalized model problem ',
               2,
               'decay:general',
               'decay:general'),
              (' Deriving the $\\theta$-rule formula ', 3, None, '___sec114'),
              (' The Python code ', 3, None, '___sec115'),
              (' Coding of variable coefficients ', 3, None, '___sec116'),
              (' Verifying a constant solution ',
               2,
               'decay:verify:trivial',
               'decay:verify:trivial'),
              (' Verification via manufactured solutions ',
               2,
               'decay:MMS',
               'decay:MMS'),
              (' Extension to systems of ODEs ', 2, None, '___sec119'),
              (' General first-order ODEs ', 1, None, '___sec120'),
              (' Generic form ', 2, None, '___sec121'),
              (' The $\\theta$-rule ', 2, None, '___sec122'),
              (' An implicit 2-step backward scheme ', 2, None, '___sec123'),
              (' Leapfrog schemes ', 2, None, '___sec124'),
              (' The ordinary Leapfrog scheme ', 3, None, '___sec125'),
              (' The filtered Leapfrog scheme ', 3, None, '___sec126'),
              (' The 2nd-order Runge-Kutta scheme ', 2, None, '___sec127'),
              (' A 2nd-order Taylor-series method ', 2, None, '___sec128'),
              (' The 2nd- and 3rd-order Adams-Bashforth schemes ',
               2,
               None,
               '___sec129'),
              (' 4th-order Runge-Kutta scheme ',
               2,
               'decay:fd2:RK4',
               'decay:fd2:RK4'),
              (' The Odespy software ', 2, None, '___sec131'),
              (' Example: Runge-Kutta methods  ', 2, None, '___sec132'),
              (' Remark about using the $\\theta$-rule in Odespy ',
               3,
               None,
               '___sec133'),
              (' Example: Adaptive Runge-Kutta methods  ',
               2,
               'decay:fd2:adaptiveRK',
               'decay:fd2:adaptiveRK'),
              (' Exercises ', 1, None, '___sec135'),
              (' Exercise 17: Experiment with precision in tests and the size of $u$ ',
               2,
               'decay:fd2:exer:precision',
               'decay:fd2:exer:precision'),
              (' Exercise 18: Implement the 2-step backward scheme ',
               2,
               'decay:fd2:exer:bw2',
               'decay:fd2:exer:bw2'),
              (' Exercise 19: Implement the 2nd-order Adams-Bashforth scheme ',
               2,
               'decay:fd2:exer:AB2',
               'decay:fd2:exer:AB2'),
              (' Exercise 20: Implement the 3rd-order Adams-Bashforth scheme ',
               2,
               'decay:fd2:exer:AB3',
               'decay:fd2:exer:AB3'),
              (' Exercise 21: Analyze explicit 2nd-order methods ',
               2,
               'decay:exer:RK2:Taylor:analysis',
               'decay:exer:RK2:Taylor:analysis'),
              (' Problem 22: Implement and investigate the Leapfrog scheme ',
               2,
               'decay:fd2:exer:leapfrog1',
               'decay:fd2:exer:leapfrog1'),
              (' Problem 23: Make a unified implementation of many schemes ',
               2,
               'decay:fd2:exer:uni',
               'decay:fd2:exer:uni'),
              (' Applications of exponential decay models ',
               1,
               'decay:app',
               'decay:app'),
              (' Scaling ', 2, 'decay:app:scaling', 'decay:app:scaling'),
              (' Evolution of a population ',
               2,
               'decay:app:pop',
               'decay:app:pop'),
              (' Compound interest and inflation ',
               2,
               'decay:app:interest',
               'decay:app:interest'),
              (' Radioactive Decay ',
               2,
               'decay:app:nuclear',
               'decay:app:nuclear'),
              (' Deterministic model ', 3, None, '___sec148'),
              (' Stochastic model ', 3, None, '___sec149'),
              (' Relation between stochastic and deterministic models ',
               3,
               None,
               '___sec150'),
              (" Newton's law of cooling ",
               2,
               'decay:app:Newton:cooling',
               'decay:app:Newton:cooling'),
              (' Decay of atmospheric pressure with altitude ',
               2,
               'decay:app:atm',
               'decay:app:atm'),
              (' Multiple atmospheric layers ', 3, None, '___sec153'),
              (' Simplification: $L=0$ ', 3, None, '___sec154'),
              (' Simplification: one-layer model ', 3, None, '___sec155'),
              (' Compaction of sediments ',
               2,
               'decay:app:sediment',
               'decay:app:sediment'),
              (' Vertical motion of a body in a viscous fluid ',
               2,
               'decay:app:drag',
               'decay:app:drag'),
              (' Overview of forces ', 3, None, '___sec158'),
              (' Equation of motion ', 3, None, '___sec159'),
              (' Terminal velocity ', 3, None, '___sec160'),
              (' A Crank-Nicolson scheme ', 3, None, '___sec161'),
              (' Physical data ', 3, None, '___sec162'),
              (' Verification ', 3, None, '___sec163'),
              (' Scaling ', 3, None, '___sec164'),
              (' Decay ODEs from solving a PDE by Fourier expansions ',
               2,
               'decay:app:diffusion:Fourier',
               'decay:app:diffusion:Fourier'),
              (' Exercises and Projects ', 1, None, '___sec166'),
              (' Exercise 24: Simulate an oscillating cooling process ',
               2,
               'decay:app:exer:cooling:osc',
               'decay:app:exer:cooling:osc'),
              (' Exercise 25: Radioactive decay of Carbon-14 ',
               2,
               'decay:app:exer:radio:C14',
               'decay:app:exer:radio:C14'),
              (' Exercise 26: Simulate stochastic radioactive decay ',
               2,
               'decay:app:exer:stoch:nuclear',
               'decay:app:exer:stoch:nuclear'),
              (' Exercise 27: Radioactive decay of two substances ',
               2,
               'decay:app:exer:radio:twosubst',
               'decay:app:exer:radio:twosubst'),
              (' Exercise 28: Simulate the pressure drop in the atmosphere ',
               2,
               'decay:app:exer:atm1',
               'decay:app:exer:atm1'),
              (' Exercise 29: Make a program for vertical motion in a fluid ',
               2,
               'decay:app:exer:drag:prog',
               'decay:app:exer:drag:prog'),
              (' Project 30: Simulate parachuting ',
               2,
               'decay:app:exer:parachute',
               'decay:app:exer:parachute'),
              (' Exercise 31: Formulate vertical motion in the atmosphere ',
               2,
               'decay:app:exer:drag:atm1',
               'decay:app:exer:drag:atm1'),
              (' Exercise 32: Simulate vertical motion in the atmosphere ',
               2,
               'decay:app:exer:drag:atm2',
               'decay:app:exer:drag:atm2'),
              (' Exercise 33: Compute $y=|x|$ by solving an ODE ',
               2,
               'decay:app:exer:signum',
               'decay:app:exer:signum'),
              (' Exercise 34: Simulate growth of a fortune with random interest rate ',
               2,
               'decay:app:exer:interest',
               'decay:app:exer:interest'),
              (' Exercise 35: Simulate a population in a changing environment ',
               2,
               'decay:app:exer:pop:at',
               'decay:app:exer:pop:at'),
              (' Exercise 36: Simulate logistic growth ',
               2,
               'decay:app:exer:pop:logistic1',
               'decay:app:exer:pop:logistic1'),
              (' Exercise 37: Rederive the equation for continuous compound interest ',
               2,
               'decay:app:exer:interest:derive',
               'decay:app:exer:interest:derive'),
              (' Bibliography ', 1, None, '___sec181')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">


<!-- newcommands_keep.tex -->
$$
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\uexd}[1]{{u_{\small\mbox{e}, #1}}}
\newcommand{\vex}{{v_{\small\mbox{e}}}}
\newcommand{\vexd}[1]{{v_{\small\mbox{e}, #1}}}
\newcommand{\Aex}{{A_{\small\mbox{e}}}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\halfi}{{1/2}}
\newcommand{\ts}{\thinspace .}

\newcommand{\Ddt}[1]{\frac{D #1}{dt}}
\newcommand{\E}[1]{\hbox{E}\lbrack #1 \rbrack}
\newcommand{\Var}[1]{\hbox{Var}\lbrack #1 \rbrack}
\newcommand{\Std}[1]{\hbox{Std}\lbrack #1 \rbrack}

\newcommand{\xpoint}{\boldsymbol{x}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\Oof}[1]{\mathcal{O}(#1)}

\newcommand{\x}{\boldsymbol{x}}
\newcommand{\X}{\boldsymbol{X}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\w}{\boldsymbol{w}}
\newcommand{\V}{\boldsymbol{V}}
\newcommand{\e}{\boldsymbol{e}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\strain}{\boldsymbol{\varepsilon}}
\newcommand{\stressc}{{\sigma}}
\newcommand{\strainc}{{\varepsilon}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\T}{\boldsymbol{T}}

% Unit vectors
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
\newcommand{\ir}{\boldsymbol{i}_r}
\newcommand{\ith}{\boldsymbol{i}_{\theta}}
\newcommand{\iz}{\boldsymbol{i}_z}

% Index sets
\newcommand{\Ix}{\mathcal{I}_x}
\newcommand{\Iy}{\mathcal{I}_y}
\newcommand{\Iz}{\mathcal{I}_z}
\newcommand{\It}{\mathcal{I}_t}
\newcommand{\setb}[1]{{#1}^0}    % set begin
\newcommand{\sete}[1]{{#1}^{-1}} % set end
%\newcommand{\setl}[1]{#1\setminus\{\set1{#1}\}}
%\newcommand{\setr}[1]{#1\setminus\{\set0{#1}\}}
%\newcommand{\seti}[1]{#1\setminus\{\set0{#1},\set1{#1}\}}
\newcommand{\setl}[1]{{#1}^-}
\newcommand{\setr}[1]{{#1}^+}
\newcommand{\seti}[1]{{#1}^i}

% Finite elements
\newcommand{\basphi}{\varphi}
\newcommand{\baspsi}{\psi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\psib}{\boldsymbol{\psi}}
\newcommand{\sinL}[1]{\sin\left((#1+1)\pi\frac{x}{L}\right)}
\newcommand{\xno}[1]{x_{#1}}
%\newcommand{\xno}[1]{x^{(#1)}}
\newcommand{\Xno}[1]{X_{(#1)}}
\newcommand{\yno}[1]{y_{#1}}
\newcommand{\Yno}[1]{Y_{(#1)}}
\newcommand{\xdno}[1]{\boldsymbol{x}_{#1}}

% FEniCS commands
\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Integerp}{\mathbb{N}}
\newcommand{\Integer}{\mathbb{Z}}
$$




    
<a name="part0004"></a>
<!-- begin top navigation -->
<a href="._part0003_main_decay-solarized.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="previous"></a>

<a href="._part0005_main_decay-solarized.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end top navigation -->

<p>
<!-- !split -->

<h2>Performing scientific experiments <a name="decay:experiments"></a></h2>

<p>
<div class="alert alert-block alert-notice alert-text-normal"><b>Goal.</b>
This section explores the behavior of a numerical
method for a differential equation through computer experiments.
In particular, it is shown how scientific experiments
can be set up and reported. We address the ODE problem

<p>
$$
\begin{equation}
u'(t) = -au(t),\quad u(0)=I,\quad t\in (0,T],
\tag{43}
\end{equation}
$$

numerically discretized by the \( \theta \)-rule:

<p>
$$
u^{n+1} = \frac{1 - (1-\theta) a\Delta t}{1 + \theta a\Delta t}u^n,
\quad u^0=I\thinspace .
$$

Our aim is to plot \( u^0,u^1,\ldots,u^N \)
together with the exact solution \( \uex = Ie^{-at} \)
for various choices of the parameters in this numerical problem:
\( I \), \( a \), \( \Delta t \), and \( \theta \). We are especially interested
in how the discrete solution compares with the exact solution
when the \( \Delta t \) parameter is varied and \( \theta \) takes on the three values
corresponding to the Forward Euler, Backward Euler, and Crank-Nicolson
schemes (\( \theta=0,1,0.5 \), respectively).
</div>
<h3>Software  <a name="___sec66"></a></h3>

<p>
A verified implementation for computing the numerical
solution \( u^n \) and plotting it together
with the exact solution \( \uex \) is found in the file
<a href="http://tinyurl.com/jvzzcfn/decay/decay_mod.py"><tt>decay_mod.py</tt></a>.
This program admits command-line arguments to specify a series of
\( \Delta t \) values and will run a loop over these values and
\( \theta=0,0.5,1 \). We make a slight edit of how the plots are
designed: the numerical solution is specified with line type <code>'r--o'</code>
(dashed red lines with dots at the mesh points), and the <code>show()</code>
command is removed to avoid a lot of plot windows popping up on
the computer screen (but hardcopies of the plot are still stored
in files via <code>savefig</code>). The slightly
modified program has the name
<a href="http://tinyurl.com/jvzzcfn/decay/experiments/decay_mod.py"><tt>experiments/decay_mod.py</tt></a>.
All files associated with the scientific investigation are collected
in a subdirectory <code>experiments</code>.

<p>
Running the experiments is easy since the <code>decay_mod.py</code> program
already has the loops over \( \theta \) and \( \Delta t \) implemented.
An experiment with \( I=1 \), \( a=2 \), \( T=5 \), and \( dt=0.5, 0.25, 0.1, 0.05 \)
is run by

<p>

<!-- code=bash (from !bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">Terminal&gt; python decay_mod.py --I 1 --a 2 --makeplot <span style="color: #CD5555">\ </span>
          --T 5 --dt 0.5 0.25 0.1 0.05
</pre></div>

<h3>Combining plot files  <a name="___sec67"></a></h3>

<p>
The <code>decay_mod.py</code> program generates a lot of image files, e.g.,
<code>FE_*.png</code>, <code>BE_*.png</code>, and <code>CN_*.png</code>.
We want to combine all the <code>FE_*.png</code> files in a table
fashion in one file, with two images in each row,
starting with the largest \( \Delta t \) in the upper
left corner and decreasing the value as we go to the right and down.
This can be done using the <a href="http://www.imagemagick.org/script/montage.php"><tt>montage</tt></a> program. The often occurring white areas around the plots can
be cropped away by the <code>convert -trim</code> command.
The remaining white can be made transparent for HTML pages with a
non-white background by the command <code>convert -transparent white</code>.

<p>
Also plot files in the PDF format with names <code>FE_*.pdf</code>, <code>BE_*.pdf</code>,
and <code>CN_*.pdf</code> are generated and these should be combined using other
tools: <code>pdftk</code> to combine individual plots into one file with one plot
per page, and <code>pdfnup</code> to combine the pages into a table with multiple
plots per page. The resulting image often has some extra surrounding
white space that can be removed by the <code>pdfcrop</code> program.
The code snippets below contain all details about the
usage of <code>montage</code>, <code>convert</code>, <code>pdftk</code>, <code>pdfnup</code>, and <code>pdfcrop</code>.

<p>
Running manual commands is boring, and errors may easily
sneak in. Both for automating manual work and documenting the
operating system commands we actually issued in the experiment,
we should write a <em>script</em> (little program). An alternative is
to write the commands into an IPython notebook and use the
notebook as the script. A plain script as a standard Python
program in a separate text file will be used here.

<p>
<div class="alert alert-block alert-warning alert-text-normal"><b>Reproducible science.</b>
A script that automates running our computer experiments
will ensure
that the experiments can easily be rerun by ourselves or others in
the future, either to check the results or redo the experiments with
other input data. Also, whatever we did to produce the results is
documented in every detail in the script.
Automating scripts are therefore essential to making our
research <em>reproducible</em>, which is a fundamental principle in science.
</div>
<p>
The script takes
a list of \( \Delta t \) values on the command line as input and
makes three combined images, one for each \( \theta \) value,
displaying the quality of the numerical solution as \( \Delta t \)
varies. For example,
<p>

<!-- code=bash (from !bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">Terminal&gt; python decay_exper0.py 0.5 0.25 0.1 0.05
</pre></div>
<p>
results in images <code>FE.png</code>, <code>CN.png</code>, <code>BE.png</code>,
<code>FE.pdf</code>, <code>CN.pdf</code>, and <code>BE.pdf</code>,
each with four plots corresponding to the four \( \Delta t \) values.
Each plot compares the numerical solution with the exact one.
The latter image is shown in Figure <a href="#decay:experiments:fig:BE4a">10</a>.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 10:  Illustration of the Backward Euler method for four time step values. <a name="decay:experiments:fig:BE4a"></a> </p></center>
<p><img src="fig-decay/BE4a.png" align="bottom" width=600,></p>
</center>

<p>
Ideally, the script should be scalable in the sense that it works for
any number of \( \Delta t \) values, which is the case for this particular
implementation:

<p>

<!-- code=python (from !bc pypro) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">os</span>, <span style="color: #008b45; text-decoration: underline">sys</span>

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">run_experiments</span>(I=<span style="color: #B452CD">1</span>, a=<span style="color: #B452CD">2</span>, T=<span style="color: #B452CD">5</span>):
    <span style="color: #228B22"># The command line must contain dt values</span>
    <span style="color: #8B008B; font-weight: bold">if</span> <span style="color: #658b00">len</span>(sys.argv) &gt; <span style="color: #B452CD">1</span>:
        dt_values = [<span style="color: #658b00">float</span>(arg) <span style="color: #8B008B; font-weight: bold">for</span> arg <span style="color: #8B008B">in</span> sys.argv[<span style="color: #B452CD">1</span>:]]
    <span style="color: #8B008B; font-weight: bold">else</span>:
        <span style="color: #8B008B; font-weight: bold">print</span> <span style="color: #CD5555">&#39;Usage: %s dt1 dt2 dt3 ...&#39;</span> %  sys.argv[<span style="color: #B452CD">0</span>]
        sys.exit(<span style="color: #B452CD">1</span>)  <span style="color: #228B22"># abort</span>

    <span style="color: #228B22"># Run module file as a stand-alone application</span>
    cmd = <span style="color: #CD5555">&#39;python decay_mod.py --I %g --a %g --makeplot --T %g&#39;</span> % \
          (I, a, T)
    dt_values_str = <span style="color: #CD5555">&#39; &#39;</span>.join([<span style="color: #658b00">str</span>(v) <span style="color: #8B008B; font-weight: bold">for</span> v <span style="color: #8B008B">in</span> dt_values])
    cmd += <span style="color: #CD5555">&#39; --dt %s&#39;</span> % dt_values_str
    <span style="color: #8B008B; font-weight: bold">print</span> cmd
    failure = os.system(cmd)
    <span style="color: #8B008B; font-weight: bold">if</span> failure:
        <span style="color: #8B008B; font-weight: bold">print</span> <span style="color: #CD5555">&#39;Command failed:&#39;</span>, cmd; sys.exit(<span style="color: #B452CD">1</span>)

    <span style="color: #228B22"># Combine images into rows with 2 plots in each row</span>
    image_commands = []
    <span style="color: #8B008B; font-weight: bold">for</span> method <span style="color: #8B008B">in</span> <span style="color: #CD5555">&#39;BE&#39;</span>, <span style="color: #CD5555">&#39;CN&#39;</span>, <span style="color: #CD5555">&#39;FE&#39;</span>:
        pdf_files = <span style="color: #CD5555">&#39; &#39;</span>.join([<span style="color: #CD5555">&#39;%s_%g.pdf&#39;</span> % (method, dt)
                              <span style="color: #8B008B; font-weight: bold">for</span> dt <span style="color: #8B008B">in</span> dt_values])
        png_files = <span style="color: #CD5555">&#39; &#39;</span>.join([<span style="color: #CD5555">&#39;%s_%g.png&#39;</span> % (method, dt)
                              <span style="color: #8B008B; font-weight: bold">for</span> dt <span style="color: #8B008B">in</span> dt_values])
        image_commands.append(
            <span style="color: #CD5555">&#39;montage -background white -geometry 100%&#39;</span> +
            <span style="color: #CD5555">&#39; -tile 2x %s %s.png&#39;</span> % (png_files, method))
        image_commands.append(
            <span style="color: #CD5555">&#39;convert -trim %s.png %s.png&#39;</span> % (method, method))
        image_commands.append(
            <span style="color: #CD5555">&#39;convert %s.png -transparent white %s.png&#39;</span> %
            (method, method))
        image_commands.append(
            <span style="color: #CD5555">&#39;pdftk %s output tmp.pdf&#39;</span> % pdf_files)
        num_rows = <span style="color: #658b00">int</span>(<span style="color: #658b00">round</span>(<span style="color: #658b00">len</span>(dt_values)/<span style="color: #B452CD">2.0</span>))
        image_commands.append(
            <span style="color: #CD5555">&#39;pdfnup --nup 2x%d tmp.pdf&#39;</span> % num_rows)
        image_commands.append(
            <span style="color: #CD5555">&#39;pdfcrop tmp-nup.pdf %s.pdf&#39;</span> % method)

    <span style="color: #8B008B; font-weight: bold">for</span> cmd <span style="color: #8B008B">in</span> image_commands:
        <span style="color: #8B008B; font-weight: bold">print</span> cmd
        failure = os.system(cmd)
        <span style="color: #8B008B; font-weight: bold">if</span> failure:
            <span style="color: #8B008B; font-weight: bold">print</span> <span style="color: #CD5555">&#39;Command failed:&#39;</span>, cmd; sys.exit(<span style="color: #B452CD">1</span>)

    <span style="color: #228B22"># Remove the files generated above and by decay_mod.py</span>
    <span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">glob</span> <span style="color: #8B008B; font-weight: bold">import</span> glob
    filenames = glob(<span style="color: #CD5555">&#39;*_*.png&#39;</span>) + glob(<span style="color: #CD5555">&#39;*_*.pdf&#39;</span>) + \
                glob(<span style="color: #CD5555">&#39;*_*.eps&#39;</span>) + glob(<span style="color: #CD5555">&#39;tmp*.pdf&#39;</span>)
    <span style="color: #8B008B; font-weight: bold">for</span> filename <span style="color: #8B008B">in</span> filenames:
        os.remove(filename)

<span style="color: #8B008B; font-weight: bold">if</span> __name__ == <span style="color: #CD5555">&#39;__main__&#39;</span>:
    run_experiments()
</pre></div>
<p>
This file is available as <a href="http://tinyurl.com/jvzzcfn/decay/experiments/decay_exper0.py"><tt>experiments/decay_exper0.py</tt></a>.

<p>
We may comment upon many useful constructs in this script:

<p>

<ul>
 <li> <code>[float(arg) for arg in sys.argv[1:]]</code> builds a list of real numbers
   from all the command-line arguments.</li>
 <li> <code>failure = os.system(cmd)</code> runs an operating system command, e.g.,
   another program. The execution is successful only if <code>failure</code> is zero.</li>
 <li> Unsuccessful execution usually makes it meaningless to continue
   the program, and therefore we abort the program with <code>sys.exit(1)</code>.
   Any argument different from 0 signifies to the computer's operating system
   that our program stopped with a failure.</li>
 <li> <code>['%s_%s.png' % (method, dt) for dt in dt_values]</code> builds a list of
   filenames from a list of numbers (<code>dt_values</code>).</li>
 <li> All <code>montage</code>, <code>convert</code>, <code>pdftk</code>, <code>pdfnup</code>, and <code>pdfcrop</code>
   commands for creating
   composite figures are stored in a
   list and later executed in a loop.</li>
 <li> <code>glob('*_*.png')</code> returns a list of the names of all files in the
   current directory where the filename matches the <a href="http://en.wikipedia.org/wiki/Glob_(programming)">Unix wildcard notation</a>
   <code>*_*.png</code> (meaning any text, underscore, any text, and then <code>.png</code>).</li>
 <li> <code>os.remove(filename)</code> removes the file with name <code>filename</code>.</li>
</ul>

<h3>Interpreting output from other programs  <a name="___sec68"></a></h3>

<p>
Programs that run other programs, like <code>decay_exper0.py</code> does, will often
need to interpret output from those programs. Let us demonstrate how
this is done in Python by extracting the relations between \( \theta \),
\( \Delta t \), and the error \( E \) as written to the terminal window
by the <code>decay_mod.py</code> program, when being executed by
<code>decay_exper0.py</code>. We will

<p>

<ul>
  <li> read the output from the <code>decay_mod.py</code> program</li>
  <li> interpret this output and store the \( E \) values in arrays for each
    \( \theta \) value</li>
  <li> plot \( E \) versus \( \Delta t \), for each \( \theta \), in a log-log plot</li>
</ul>

The simple <code>os.system(cmd)</code> call does not allow us to read the
output from running <code>cmd</code>. Instead we need to invoke a bit more
involved procedure:

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">subprocess</span> <span style="color: #8B008B; font-weight: bold">import</span> Popen, PIPE, STDOUT
p = Popen(cmd, shell=<span style="color: #658b00">True</span>, stdout=PIPE, stderr=STDOUT)
output, dummy = p.communicate()
failure = p.returncode
<span style="color: #8B008B; font-weight: bold">if</span> failure:
    <span style="color: #8B008B; font-weight: bold">print</span> <span style="color: #CD5555">&#39;Command failed:&#39;</span>, cmd; sys.exit(<span style="color: #B452CD">1</span>)
</pre></div>
<p>
The command stored in <code>cmd</code> is run and all text that is written to
the standard output <em>and</em> the standard error is available in the
string <code>output</code>. Or in other words, the text in <code>output</code> is what appeared in the
terminal window while running <code>cmd</code>.

<p>
Our next task is to run through the <code>output</code> string, line by line,
and if the current line prints \( \theta \), \( \Delta t \), and \( E \),
we split the line into these three pieces and store the data.
The chosen storage structure is a dictionary <code>errors</code> with keys <code>dt</code>
to hold the \( \Delta t \) values in a list, and three \( \theta \) keys to hold
the corresponding \( E \) values in a list. The relevant code lines are

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">errors = {<span style="color: #CD5555">&#39;dt&#39;</span>: dt_values, <span style="color: #B452CD">1</span>: [], <span style="color: #B452CD">0</span>: [], <span style="color: #B452CD">0.5</span>: []}
<span style="color: #8B008B; font-weight: bold">for</span> line <span style="color: #8B008B">in</span> output.splitlines():
    words = line.split()
    <span style="color: #8B008B; font-weight: bold">if</span> words[<span style="color: #B452CD">0</span>] <span style="color: #8B008B">in</span> (<span style="color: #CD5555">&#39;0.0&#39;</span>, <span style="color: #CD5555">&#39;0.5&#39;</span>, <span style="color: #CD5555">&#39;1.0&#39;</span>):  <span style="color: #228B22"># line with E?</span>
        <span style="color: #228B22"># typical line: 0.0   1.25:    7.463E+00</span>
        theta = <span style="color: #658b00">float</span>(words[<span style="color: #B452CD">0</span>])
        E = <span style="color: #658b00">float</span>(words[<span style="color: #B452CD">2</span>])
        errors[theta].append(E)
</pre></div>
<p>
Note that we do not bother to store the \( \Delta t \) values as we
read them from <code>output</code>, because we already have these values in
the <code>dt_values</code> list.

<p>
We are now ready to plot \( E \) versus \( \Delta t \) for \( \theta=0,0.5,1 \):

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">plt</span>
plt.loglog(errors[<span style="color: #CD5555">&#39;dt&#39;</span>], errors[<span style="color: #B452CD">0</span>], <span style="color: #CD5555">&#39;ro-&#39;</span>)
plt.hold(<span style="color: #CD5555">&#39;on&#39;</span>)
plt.loglog(errors[<span style="color: #CD5555">&#39;dt&#39;</span>], errors[<span style="color: #B452CD">0.5</span>], <span style="color: #CD5555">&#39;b+-&#39;</span>)
plt.loglog(errors[<span style="color: #CD5555">&#39;dt&#39;</span>], errors[<span style="color: #B452CD">1</span>], <span style="color: #CD5555">&#39;gx-&#39;</span>)
plt.legend([<span style="color: #CD5555">&#39;FE&#39;</span>, <span style="color: #CD5555">&#39;CN&#39;</span>, <span style="color: #CD5555">&#39;BE&#39;</span>], loc=<span style="color: #CD5555">&#39;upper left&#39;</span>)
plt.xlabel(<span style="color: #CD5555">&#39;log(time step)&#39;</span>)
plt.ylabel(<span style="color: #CD5555">&#39;log(error)&#39;</span>)
plt.title(<span style="color: #CD5555">&#39;Error vs time step&#39;</span>)
plt.savefig(<span style="color: #CD5555">&#39;error.png&#39;</span>)
plt.savefig(<span style="color: #CD5555">&#39;error.pdf&#39;</span>)
</pre></div>
<p>
Plots occasionally need some manual adjustments. Here, the axis of
the log-log plot look nicer if we adapt them strictly to the data,
see Figure <a href="#decay:exper:Evsdt">11</a>.
To this end, we need to compute \( \min E \) and \( \max E \), and later
specify the extent of the axes:

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%"><span style="color: #228B22"># Find min/max for the axis</span>
E_min = <span style="color: #B452CD">1E+20</span>; E_max = -E_min
<span style="color: #8B008B; font-weight: bold">for</span> theta <span style="color: #8B008B">in</span> <span style="color: #B452CD">0</span>, <span style="color: #B452CD">0.5</span>, <span style="color: #B452CD">1</span>:
    E_min = <span style="color: #658b00">min</span>(E_min, <span style="color: #658b00">min</span>(errors[theta]))
    E_max = <span style="color: #658b00">max</span>(E_max, <span style="color: #658b00">max</span>(errors[theta]))

plt.loglog(errors[<span style="color: #CD5555">&#39;dt&#39;</span>], errors[<span style="color: #B452CD">0</span>], <span style="color: #CD5555">&#39;ro-&#39;</span>)
...
plt.axis([<span style="color: #658b00">min</span>(dt_values), <span style="color: #658b00">max</span>(dt_values), E_min, E_max])
...
</pre></div>
<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 11:  Default plot (left) and manually adjusted axes (right). <a name="decay:exper:Evsdt"></a> </p></center>
<p><img src="fig-decay/error_plot_improvement.png" align="bottom" width=800,></p>
</center>

<p>
The complete program, incorporating the code snippets above, is found
in <a href="http://tinyurl.com/jvzzcfn/decay/experiments/decay_exper1.py"><tt>experiments/decay_exper1.py</tt></a>.
This example can hopefully act as template for numerous
other occasions
where one needs to run experiments, extract data from the output
of programs, make plots, and combine several plots in a figure file.
The <code>decay_exper1.py</code> program
is organized as a module, and other files can then easily extend
the functionality, as illustrated in the next section.

<h3>Making a report <a name="decay:exper:report"></a></h3>

<p>
The results of running computer experiments are best documented in a
little report containing the problem to be solved, key code segments,
and the plots from a series of experiments. At least the part of the
report containing the plots should be automatically generated by the
script that performs the set of experiments, because in that script we
know exactly which input data that were used to generate a specific
plot, thereby ensuring that each figure is connected to the
right data. Take a look at an
example at <a href="http://tinyurl.com/k3sdbuv/writing_reports//sphinx-cloud/"><tt>http://tinyurl.com/k3sdbuv/writing_reports//sphinx-cloud/</tt></a>  to see what we have in
mind.

<h4>Plain HTML  <a name="___sec70"></a></h4>

<p>
Scientific reports can be written in a variety of formats. Here we
begin with the <a href="http://en.wikipedia.org/wiki/HTML">HTML</a> format
which allows efficient viewing of all the experiments in any web
browser. The program
<a href="http://tinyurl.com/jvzzcfn/decay/experiments/decay_exper1_html.py"><tt>decay_exper1_html.py</tt></a> calls
<code>decay_exper1.py</code> to perform the experiments and then runs
statements for creating an HTML file with a summary, a
section on the mathematical problem, a section on the numerical
method, a section on the <code>solver</code> function implementing the
method, and a section with subsections containing figures that show
the results of experiments where \( \Delta t \) is varied for
\( \theta=0,0.5,1 \). The mentioned
Python file contains all the details for writing
this <a href="http://tinyurl.com/k3sdbuv/writing_reports//_static/report_html.html.html">HTML report</a>.
You can view the report on <a href="http://tinyurl.com/k3sdbuv/writing_reports//_static/report_html.html"><tt>http://tinyurl.com/k3sdbuv/writing_reports//_static/report_html.html</tt></a>.

<h4>HTML with MathJax  <a name="___sec71"></a></h4>

<p>
Scientific reports usually need mathematical formulas and hence
mathematical typesetting. In plain HTML, as used in the
<code>decay_exper1_html.py</code> file, we have to use just the keyboard
characters to write mathematics. However, there is an extension to
HTML, called <a href="http://www.mathjax.org/">MathJax</a>, which allows
formulas and equations to be typeset with LaTeX syntax and nicely
rendered in web browsers, see Figure
<a href="#decay:exper:report:fig:mathjax">12</a>.  A relatively small subset of
LaTeX environments is supported, but the syntax for formulas is quite
rich. Inline formulas are look like <code>\( u'=-au \)</code> while equations are
surrounded by <code>$$</code> signs.  Inside such signs, one can use <code>\[ u'=-au
\]</code> for unnumbered equations, or <code>\begin{equation}</code> and
<code>\end{equation}</code> surrounding <code>u'=-au</code> for numbered equations, or
<code>\begin{align}</code> and <code>\end{align}</code> for multiple aligned equations.  You
need to be familiar with <a href="http://en.wikibooks.org/wiki/LaTeX/Mathematics">mathematical typesetting in LaTeX</a>.

<p>
The file <a href="http://tinyurl.com/jvzzcfn/decay/experiments/decay_exper1_html.py"><tt>decay_exper1_mathjax.py</tt></a> contains all the
details for turning the previous plain HTML report into <a href="http://tinyurl.com/k3sdbuv/writing_reports//_static/report_mathjax.html">web pages
with nicely typeset mathematics</a>.  The
<a href="http://tinyurl.com/k3sdbuv/writing_reports//_static/report_mathjax.html.html">corresponding HTML code</a> be studied
to see all details of the mathematical typesetting.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 12:  Report in HTML format with MathJax. <a name="decay:exper:report:fig:mathjax"></a> </p></center>
<p><img src="fig-decay/report_mathjax.png" align="bottom" width=600></p>
</center>

<h4>LaTeX  <a name="___sec72"></a></h4>

<p>
<!-- "http://en.wikibooks.org/wiki/LaTeX" -->

<p>
The <em>de facto</em> language for mathematical typesetting and scientific
report writing is <a href="http://en.wikipedia.org/wiki/LaTeX">LaTeX</a>. A
number of very sophisticated packages have been added to the language
over a period of three decades, allowing very fine-tuned layout and
typesetting. For output in the <a href="http://tinyurl.com/k3sdbuv/writing_reports//_static/report.pdf">PDF format</a>, see Figure
<a href="#decay:exper:report:fig:latex">13</a> for an example, LaTeX is the
definite choice when it comes to quality. The LaTeX language used to
write the reports has typically a lot of commands involving
<a href="http://tinyurl.com/k3sdbuv/writing_reports//_static/report.tex.html">backslashes and braces</a>.  For output on
the web, using HTML (and not the PDF directly in the browser window),
LaTeX struggles with delivering high quality typesetting. Other tools,
especially Sphinx, give better results and can also produce
nice-looking PDFs.  The file <code>decay_exper1_latex.py</code> shows how to
generate the LaTeX source from a program.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 13:  Report in PDF format generated from LaTeX source. <a name="decay:exper:report:fig:latex"></a> </p></center>
<p><img src="fig-decay/report_latexpdf.png" align="bottom" width=600></p>
</center>

<h4>Sphinx  <a name="___sec73"></a></h4>

<p>
<!-- give pointers to source pages -->

<p>
<a href="http://sphinx.pocoo.org/">Sphinx</a> is a typesetting language with
similarities to HTML and LaTeX, but with much less tagging. It has
recently become very popular for software documentation and
mathematical reports. Sphinx can utilize LaTeX for mathematical
formulas and equations (via MathJax or PNG images). Unfortunately, the
subset of LaTeX mathematics supported is less than in full MathJax (in
particular, numbering of multiple equations in an <code>align</code> type
environment is not supported).  The <a href="http://tinyurl.com/k3sdbuv/writing_reports//_static/report_sphinx.rst.html">Sphinx syntax</a> is an extension of
the reStructuredText language. An attractive feature of Sphinx is its
rich support for <a href="http://tinyurl.com/k3sdbuv/writing_reports//_static/sphinx-cloud/index.html">fancy layout of web pages</a>. In particular,
Sphinx can easily be combined with various layout <em>themes</em> that give a
certain look and feel to the web site and that offers table of
contents, navigation, and search facilities, see Figure
<a href="#decay:exper:report:fig:sphinx">14</a>.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 14:  Report in HTML format generated from Sphinx source. <a name="decay:exper:report:fig:sphinx"></a> </p></center>
<p><img src="fig-decay/report_sphinx.png" align="bottom" width=600></p>
</center>

<h4>Markdown  <a name="___sec74"></a></h4>

<p>
A recently popular format for easy writing of web pages is
<a href="http://daringfireball.net/projects/markdown/">Markdown</a>.
Text is written very much like one would do in email, using
spacing and special characters to naturally format the code
instead of heavily tagging the text as in LaTeX and HTML.
With the tool <a href="http://johnmacfarlane.net/pandoc/">Pandoc</a> one
can go from Markdown to a variety of formats.
HTML is a common output format, but LaTeX, epub, XML,
OpenOffice, MediaWiki, and MS Word are some other possibilities.

<h4>Wiki formats  <a name="___sec75"></a></h4>

<p>
A range of wiki formats are popular for creating notes on the web,
especially documents which allow groups of people to edit and add
content. Apart from <a href="http://www.mediawiki.org/wiki/MediaWiki">MediaWiki</a> (the wiki format used for
Wikipedia), wiki formats have no support for mathematical typesetting
and also limited tools for displaying computer code in nice ways.
Wiki formats are therefore less suitable for scientific reports compared
to the other formats mentioned here.

<h4>Doconce  <a name="___sec76"></a></h4>

<p>
Since it is difficult to choose the right tool or format for writing
a scientific report, it is advantageous to write the content in a
format that easily translates to LaTeX, HTML, Sphinx, Markdown,
and various wikis. <a href="https://github.com/hplgit/doconce">Doconce</a> is such
a tool. It is similar to Pandoc, but offers some special convenient
features for writing about mathematics and programming.
The <a href="http://tinyurl.com/k3sdbuv/writing_reports//_static/report.do.txt.html">tagging is modest</a>,
somewhere between LaTeX and Markdown.
The program <code>decay_exper_do.py</code> demonstrates how to generate (and write)
Doconce code for a report.

<h4>Worked example  <a name="___sec77"></a></h4>

<p>
The HTML, LaTeX (PDF), Sphinx, and Doconce formats for the scientific
report whose content is outlined above, are exemplified
with source codes and results at the
web pages associated with this teaching material:
<a href="http://tinyurl.com/k3sdbuv/writing_reports/"><tt>http://tinyurl.com/k3sdbuv/writing_reports/</tt></a>.

<p>
<!-- project with exploring instability (help with matplotlib contour plots, and maybe show such a plot) -->

<h3>Publishing a complete project <a name="decay:exper:github"></a></h3>

<p>
A report documenting scientific investigations should be accompanied by
all the software and data used for the investigations so that others
have a possibility to redo the work and assess the qualify of the results.
This possibility is important for <em>reproducible research</em> and
hence reaching reliable scientific conclusions.

<p>
One way of documenting a complete project is to make a directory tree
with all relevant files. Preferably, the tree is published at
some project hosting site like <a href="http://hplgit.github.com/teamods/bitgit/html/">Bitbucket, GitHub, or Googlecode</a> so that others can download it
as a tarfile, zipfile, or clone the files directly using a version control
system like Mercurial or Git.
For the investigations outlined in the section <a href="#decay:exper:report">Making a report</a>,
we can create a directory tree with files
<p>

<!-- code=text typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">setup.py
./src:
   decay_mod.py
./doc:
   ./src:
      decay_exper1_mathjax.py
      make_report.sh
      run.sh
   ./pub:
      report.html
</pre></div>
<p>
The <code>src</code> directory holds source code (modules) to be reused in other projects,
the <code>setup.py</code> builds and installs such software,
the <code>doc</code> directory contains the documentation, with <code>src</code> for the
source of the documentation and <code>pub</code> for ready-made, published documentation.
The <code>run.sh</code> file is a simple Bash script listing the <code>python</code> command
we used to run <code>decay_exper1_mathjax.py</code> to generate the experiments and
the <code>report.html</code> file.

<p>
<!-- Point to Doconce version -->

<p>
<p>
<!-- begin bottom navigation -->
<a href="._part0003_main_decay-solarized.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="previous"></a>

<a href="._part0005_main_decay-solarized.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end bottom navigation -->

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

