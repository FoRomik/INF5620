<!DOCTYPE html>
<!--
Automatically generated HTML file from Doconce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Introduction to finite element methods">
<meta name="keywords" content="approximation of vectors in the plane,least squreas method vectors,Galerkin method vectors,projection vectors,approximation of general vectors,Galerkin method vectors,projection vectors,approximation of functions,Galerkin method functions,projection functions,approximation by sines,collocation method (approximation),approximation collocation,interpolation,approximation interpolation,Lagrange (interpolating) polynomial,Kronecker delta,Runge's phenomenon,Chebyshev nodes,finite element mesh,mesh finite elements,Kronecker delta,chapeau function,hat function,finite element basis function,linear elements,quadratic elements,P1 element,P2 element,element matrix,assembly,affine mapping,mapping of reference cells affine mapping,sparse matrices,mass matrix,mass lumping,lumped mass matrix,cell,vertex,degree of freedom,reference cell,finite element, definition,dof map,finite element expansion reference element,Hermite polynomials,numerical integration Midpoint rule,numerical integration Trapezoidal rule,numerical integration Simpson's rule,numerical integration Newton-Cotes formulas,Midpoint rule,Trapezoidal rule,Simpson's rule,Newton-Cotes rules,Gauss-Legendre quadrature,tensor product,simplex elements,simplices,faces,edges,affine mapping,isoparametric mapping,mapping of reference cells isoparametric mapping,residual,variational formulation,trial function,test function,trial space,test space,integration by parts,weak form,strong form,natural boundary condition,essential boundary condition,mass matrix,stiffness matrix,mass matrix,mass lumping,lumped mass matrix,mixed finite elements">



<style type="text/css">
    /* solarized style */
    body {
      margin:5;
      padding:0;
      border:0;	/* Remove the border around the viewport in old versions of IE */
      width:100%;
      background: #fdf6e3;
      min-width:600px;	/* Minimum width of layout - remove if not required */
      font-family: Verdana, Helvetica, Arial, sans-serif;
      font-size: 1.0em;
      line-height: 1.3em;
      color: #657b83;
    }
    a { color: #657b83; text-decoration:none; }
    a:hover { color: #b58900; background: #eee8d5; text-decoration:none; }
    h1, h2, h3 { margin:.8em 0 .2em 0; padding:0; line-height: 125%; }
    h2 { font-variant: small-caps; }
    pre {
      background: #fdf6e3;
      -webkit-box-shadow: inset 0 0 2px #000000;
      -moz-box-shadow: inset 0 0 2px #000000;
      box-shadow: inset 0 0 2px #000000;
      color: #586e75;
      margin-left: 0px;
      font-family: 'Droid Sans Mono', monospace;
      padding: 2px;
      -webkit-border-radius: 4px;
      -moz-border-radius: 4px;
      border-radius: 4px;
      -moz-background-clip: padding;
      -webkit-background-clip: padding-box;
      background-clip: padding-box;
    }
    tt { font-family: "Courier New", Courier; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p { text-indent: 0px; }
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .alert-text-small   { font-size: 80%;  }
    .alert-text-large   { font-size: 130%; }
    .alert-text-normal  { font-size: 90%;  }
    .alert {
             padding:8px 35px 8px 14px; margin-bottom:18px;
             text-shadow:0 1px 0 rgba(255,255,255,0.5);
             border:1px solid #FFBF00;
             -webkit-border-radius: 4px; -moz-border-radius: 4px;
             border-radius: 4px
             color: #555;
             background-color: #fbeed5;
             background-position: 10px 5px;
             background-repeat: no-repeat;
             background-size: 38px;
             padding-left: 55px;
             width: 75%;
     }
     .alert-block {padding-top:14px; padding-bottom:14px}
     .alert-block > p, .alert-block > ul {margin-bottom:1em}
     .alert li {margin-top: 1em}
     .alert-block p+p {margin-top:5px}
     .alert-notice { background-image: url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
     .alert-summary  { background-image:url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
     .alert-warning { background-image: url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
     .alert-question {background-image:url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

</style>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Approximation of vectors ',
               1,
               'fem:approx:vec',
               'fem:approx:vec'),
              (' Approximation of planar vectors ',
               2,
               'fem:approx:vec:plane',
               'fem:approx:vec:plane'),
              (' The least squares method ', 3, None, '___sec2'),
              (' The projection method ', 3, None, '___sec3'),
              (' Approximation of general vectors ',
               2,
               'fem:approx:vec:Np1dim',
               'fem:approx:vec:Np1dim'),
              (' The least squares method ', 3, None, '___sec5'),
              (' The Galerkin or projection method ', 3, None, '___sec6'),
              (' Approximation of functions ',
               1,
               'fem:approx:global',
               'fem:approx:global'),
              (' The least squares method ',
               2,
               'fem:approx:LS',
               'fem:approx:LS'),
              (' The projection (or Galerkin) method ', 2, None, '___sec9'),
              (' Example: linear approximation ',
               2,
               'fem:approx:global:linear',
               'fem:approx:global:linear'),
              (' Implementation of the least squares method ',
               2,
               'fem:approx:global:LS:code',
               'fem:approx:global:LS:code'),
              (' Perfect approximation ',
               2,
               'fem:approx:global:exact',
               'fem:approx:global:exact'),
              (' Ill-conditioning ',
               2,
               'fem:approx:global:illconditioning',
               'fem:approx:global:illconditioning'),
              (' Fourier series ',
               2,
               'fem:approx:global:Fourier',
               'fem:approx:global:Fourier'),
              (' Orthogonal basis functions ',
               2,
               'fem:approx:global:orth',
               'fem:approx:global:orth'),
              (' Numerical computations ', 2, None, '___sec16'),
              (' The interpolation (or collocation) method ',
               2,
               'fem:approx:global:interp',
               'fem:approx:global:interp'),
              (' Example ', 3, None, '___sec18'),
              (' Lagrange polynomials ',
               2,
               'fem:approx:global:Lagrange',
               'fem:approx:global:Lagrange'),
              (' Approximation of a polynomial ', 3, None, '___sec20'),
              (' Successful example ', 3, None, '___sec21'),
              (' Less successful example ', 3, None, '___sec22'),
              (' Remedy for strong oscillations ', 3, None, '___sec23'),
              (' Finite element basis functions ',
               1,
               'fem:approx:fe',
               'fem:approx:fe'),
              (' Elements and nodes ',
               2,
               'fem:approx:fe:def:elements:nodes',
               'fem:approx:fe:def:elements:nodes'),
              (' Example ', 3, None, '___sec26'),
              (' The basis functions ', 2, None, '___sec27'),
              (' Construction principles ', 3, None, '___sec28'),
              (' Properties of $\\basphi_i$ ', 3, None, '___sec29'),
              (' Example on piecewise quadratic finite element functions ',
               2,
               None,
               '___sec30'),
              (' Example on piecewise linear finite element functions ',
               2,
               None,
               '___sec31'),
              (' Example on piecewise cubic finite element basis functions ',
               2,
               None,
               '___sec32'),
              (' Calculating the linear system ',
               2,
               'fem:approx:global:linearsystem',
               'fem:approx:global:linearsystem'),
              (' Calculating a specific matrix entry ', 3, None, '___sec34'),
              (' Calculating a general row in the matrix ',
               3,
               None,
               '___sec35'),
              (' Assembly of elementwise computations ',
               2,
               'fem:approx:fe:elementwise',
               'fem:approx:fe:elementwise'),
              (' Mapping to a reference element ',
               2,
               'fem:approx:fe:mapping',
               'fem:approx:fe:mapping'),
              (' Example: Integration over a reference element ',
               2,
               'fem:approx:fe:intg:ref',
               'fem:approx:fe:intg:ref'),
              (' Implementation ',
               1,
               'fem:approx:fe:impl',
               'fem:approx:fe:impl'),
              (' Integration ',
               2,
               'fem:approx:fe:impl:intg',
               'fem:approx:fe:impl:intg'),
              (' Linear system assembly and solution ',
               2,
               'fem:approx:fe:impl:linsys',
               'fem:approx:fe:impl:linsys'),
              (' Example on computing symbolic approximations ',
               2,
               'fem:approx:fe:impl:ex1:symbolic',
               'fem:approx:fe:impl:ex1:symbolic'),
              (' Comparison with finite elements and interpolation/collocation ',
               2,
               'fem:approx:fe:impl:ex1:collocation',
               'fem:approx:fe:impl:ex1:collocation'),
              (' Example on computing numerical approximations ',
               2,
               'fem:approx:fe:impl:ex1:numeric',
               'fem:approx:fe:impl:ex1:numeric'),
              (' The structure of the coefficient matrix ',
               2,
               'fem:approx:fe:A:structure',
               'fem:approx:fe:A:structure'),
              (' Applications ',
               2,
               'fem:approx:fe:impl:ex2',
               'fem:approx:fe:impl:ex2'),
              (' Sparse matrix storage and solution ',
               2,
               'fem:approx:fe:impl:sparse',
               'fem:approx:fe:impl:sparse'),
              (' Comparison of finite element and finite difference approximation ',
               1,
               'fem:approx:fe:fd',
               'fem:approx:fe:fd'),
              (' Finite difference approximation of given functions ',
               2,
               'fem:approx:fe:fd:fdproj',
               'fem:approx:fe:fd:fdproj'),
              (' Finite difference interpretation of a finite element approximation ',
               2,
               'fem:approx:fe:fd:feproj',
               'fem:approx:fe:fd:feproj'),
              (' Making finite elements behave as finite differences ',
               2,
               None,
               '___sec51'),
              (' Computations in physical space ', 3, None, '___sec52'),
              (' Elementwise computations ', 3, None, '___sec53'),
              (' Terminology ', 3, None, '___sec54'),
              (' A generalized element concept ',
               1,
               'fem:approx:fe:element',
               'fem:approx:fe:element'),
              (' Cells, vertices, and degrees of freedom ',
               2,
               'fem:approx:fe:element:terminology',
               'fem:approx:fe:element:terminology'),
              (' Extended finite element concept ',
               2,
               'fem:approx:fe:element:def',
               'fem:approx:fe:element:def'),
              (' Implementation ',
               2,
               'fem:approx:fe:element:impl',
               'fem:approx:fe:element:impl'),
              (' Computing the error of the approximation ',
               2,
               'fem:approx:fe:element:impl:error',
               'fem:approx:fe:element:impl:error'),
              (' Example: Cubic Hermite polynomials ',
               2,
               'fem:approx:fe:element:impl:Hermite',
               'fem:approx:fe:element:impl:Hermite'),
              (' Numerical integration ', 1, None, '___sec61'),
              (' Newton-Cotes rules ',
               2,
               'fem:approx:fe:numint1',
               'fem:approx:fe:numint1'),
              (' Gauss-Legendre rules with optimized points ',
               2,
               None,
               '___sec63'),
              (' Approximation of functions in 2D ',
               1,
               'fem:approx:2D',
               'fem:approx:2D'),
              (' 2D basis functions as tensor products of 1D functions ',
               2,
               'fem:approx:2D:global',
               'fem:approx:2D:global'),
              (' Example: Polynomial basis in 2D ', 2, None, '___sec66'),
              (' Implementation ',
               2,
               'fem:approx:2D:global:code',
               'fem:approx:2D:global:code'),
              (' Extension to 3D ',
               2,
               'fem:approx:3D:global',
               'fem:approx:3D:global'),
              (' Finite elements in 2D and 3D ', 1, None, '___sec69'),
              (' Basis functions over triangles in the physical domain ',
               2,
               None,
               '___sec70'),
              (' Element matrices and vectors ', 3, None, '___sec71'),
              (' Basis functions over triangles in the reference cell ',
               2,
               None,
               '___sec72'),
              (' Affine mapping of the reference cell ', 2, None, '___sec73'),
              (' Isoparametric mapping of the reference cell ',
               2,
               None,
               '___sec74'),
              (' Computing integrals ', 2, None, '___sec75'),
              (' Exercises ', 1, None, '___sec76'),
              (' Exercise 1: Linear algebra refresher I ',
               2,
               'fem:approx:exer:linalg1',
               'fem:approx:exer:linalg1'),
              (' Exercise 2: Linear algebra refresher II ',
               2,
               'fem:approx:exer:linalg2',
               'fem:approx:exer:linalg2'),
              (' Exercise 3: Approximate a three-dimensional vector in a plane ',
               2,
               'fem:approx:exer:vec:3Dby2D',
               'fem:approx:exer:vec:3Dby2D'),
              (' Exercise 4: Approximate the exponential function by power functions ',
               2,
               'fem:approx:exer:exp:powers',
               'fem:approx:exer:exp:powers'),
              (' Exercise 5: Approximate the sine function by power functions ',
               2,
               'fem:approx:exer:sin:powers',
               'fem:approx:exer:sin:powers'),
              (' Exercise 6: Approximate a steep function by sines ',
               2,
               'fem:approx:exer:tanh:sine1',
               'fem:approx:exer:tanh:sine1'),
              (' Exercise 7: Animate the approximation of a steep function by sines ',
               2,
               'fem:approx:exer:tanh:sine2',
               'fem:approx:exer:tanh:sine2'),
              (' Exercise 8: Fourier series as a least squares approximation ',
               2,
               'fem:approx:exer:Fourier',
               'fem:approx:exer:Fourier'),
              (' Exercise 9: Approximate a steep function by Lagrange polynomials ',
               2,
               'fem:approx:exer:tanh',
               'fem:approx:exer:tanh'),
              (' Exercise 10: Define nodes and elements ',
               2,
               'fem:approx:fe:exer:mesh1',
               'fem:approx:fe:exer:mesh1'),
              (' Exercise 11: Define vertices, cells, and dof maps ',
               2,
               'fem:approx:fe:exer:mesh2',
               'fem:approx:fe:exer:mesh2'),
              (' Exercise 12: Construct matrix sparsity patterns ',
               2,
               'fem:approx:fe:exer:defmesh:sparsity',
               'fem:approx:fe:exer:defmesh:sparsity'),
              (' Exercise 13: Perform symbolic finite element computations ',
               2,
               'fem:approx:fe:exer:Asinwt:symbolic',
               'fem:approx:fe:exer:Asinwt:symbolic'),
              (' Exercise 14: Approximate a steep function by P1 and P2 elements ',
               2,
               'fem:approx:exer:tanh',
               'fem:approx:exer:tanh'),
              (' Exercise 15: Approximate a steep function by P3 and P4 elements ',
               2,
               'fem:approx:exer:tanh2',
               'fem:approx:exer:tanh2'),
              (' Exercise 16: Investigate the approximation error in finite elements ',
               2,
               'fem:approx:fe:exer:Asinwt:interpol:error',
               'fem:approx:fe:exer:Asinwt:interpol:error'),
              (' Exercise 17: Approximate a step function by finite elements ',
               2,
               'fem:approx:fe:exer:Heaviside',
               'fem:approx:fe:exer:Heaviside'),
              (' Exercise 18: 2D approximation with orthogonal functions ',
               2,
               'fem:approx:fe:exer:2Dsines:symbolic',
               'fem:approx:fe:exer:2Dsines:symbolic'),
              (' Exercise 19: Use the Trapezoidal rule and P1 elements ',
               2,
               'fem:approx:fe:exer:1D:trapez',
               'fem:approx:fe:exer:1D:trapez'),
              (' Problem 20: Compare P1 elements and interpolation ',
               2,
               'fem:approx:fe:exer:1D:P1:vs:interp',
               'fem:approx:fe:exer:1D:P1:vs:interp'),
              (' Exercise 21: Implement 3D computations with global basis functions ',
               2,
               'fem:approx:fe:exer:3D:approx3D',
               'fem:approx:fe:exer:3D:approx3D'),
              (" Exercise 22: Use Simpson's rule and P2 elements ",
               2,
               'fem:approx:fe:exer:1D:simpson',
               'fem:approx:fe:exer:1D:simpson'),
              (' Basic principles for approximating differential equations ',
               1,
               'fem:deq:1D:principles',
               'fem:deq:1D:principles'),
              (' Differential equation models ',
               2,
               'fem:deq:1D:models',
               'fem:deq:1D:models'),
              (' Simple model problems ',
               2,
               'fem:deq:1D:models:simple',
               'fem:deq:1D:models:simple'),
              (' Forming the residual ',
               2,
               'fem:deq:1D:residual:min',
               'fem:deq:1D:residual:min'),
              (' The least squares method ', 2, None, '___sec103'),
              (' The Galerkin method ', 2, None, '___sec104'),
              (' The Method of Weighted Residuals ', 2, None, '___sec105'),
              (' Test and Trial Functions ', 2, None, '___sec106'),
              (' The collocation method ', 2, None, '___sec107'),
              (' The subdomain collocation method ', 3, None, '___sec108'),
              (' Examples on using the principles ',
               2,
               'fem:deq:1D:ex:sines',
               'fem:deq:1D:ex:sines'),
              (' The model problem ', 3, None, '___sec110'),
              (' Basis functions ', 3, None, '___sec111'),
              (' The residual ', 3, None, '___sec112'),
              (' The least squares method ', 3, None, '___sec113'),
              (' The Galerkin method ', 3, None, '___sec114'),
              (' The collocation method ', 3, None, '___sec115'),
              (' Comparison ', 3, None, '___sec116'),
              (' Integration by parts ',
               2,
               'fem:deq:1D:varform',
               'fem:deq:1D:varform'),
              (' Weak form ', 3, None, '___sec118'),
              (' Boundary function ',
               2,
               'fem:deq:1D:essBC:Bfunc',
               'fem:deq:1D:essBC:Bfunc'),
              (' Abstract notation for variational formulations ',
               2,
               'fem:deq:1D:varform:abstract',
               'fem:deq:1D:varform:abstract'),
              (' Variational problems and optimization of functionals ',
               2,
               'fem:deq:1D:optimization',
               'fem:deq:1D:optimization'),
              (' Examples on variational formulations ',
               1,
               'fem:deq:1D:varform:ex',
               'fem:deq:1D:varform:ex'),
              (' Variable coefficient ', 2, None, '___sec123'),
              (' First-order derivative in the equation and boundary condition ',
               2,
               None,
               '___sec124'),
              (' Nonlinear coefficient ', 2, None, '___sec125'),
              (' Computing with Dirichlet and Neumann conditions ',
               2,
               'fem:deq:1D:varform:ex:DN:case',
               'fem:deq:1D:varform:ex:DN:case'),
              (' When the numerical method is exact ', 2, None, '___sec127'),
              (' Computing with finite elements ',
               1,
               'fem:deq:1D:fem1',
               'fem:deq:1D:fem1'),
              (' Finite element mesh and basis functions ',
               2,
               None,
               '___sec129'),
              (' Computation in the global physical domain ',
               2,
               'fem:deq:1D:comp:global',
               'fem:deq:1D:comp:global'),
              (' Comparison with a finite difference discretization ',
               2,
               None,
               '___sec131'),
              (' Cellwise computations ',
               2,
               'fem:deq:1D:comp:elmwise',
               'fem:deq:1D:comp:elmwise'),
              (' The integral for the element matrix ', 3, None, '___sec133'),
              (' The integral for the element vector ', 3, None, '___sec134'),
              (' Detailed calculations of the element matrix and vector ',
               3,
               None,
               '___sec135'),
              (' Contributions from the first and last cell ',
               3,
               None,
               '___sec136'),
              (' Assembly ', 3, None, '___sec137'),
              (' Boundary conditions: specified nonzero value ',
               1,
               'fem:deq:1D:essBC',
               'fem:deq:1D:essBC'),
              (' General construction of a boundary function ',
               2,
               'fem:deq:1D:fem:essBC:Bfunc',
               'fem:deq:1D:fem:essBC:Bfunc'),
              (' Example on computing with finite element-based a boundary function ',
               2,
               None,
               '___sec140'),
              (' Computations in physical coordinates ',
               3,
               None,
               '___sec141'),
              (' Cellwise computations on the reference element ',
               3,
               None,
               '___sec142'),
              (' Modification of the linear system ',
               2,
               'fem:deq:1D:fem:essBC:Bfunc:modsys',
               'fem:deq:1D:fem:essBC:Bfunc:modsys'),
              (' Computations in the physical system ', 3, None, '___sec144'),
              (' Symmetric modification of the linear system ',
               2,
               'fem:deq:1D:fem:essBC:Bfunc:modsys:symm',
               'fem:deq:1D:fem:essBC:Bfunc:modsys:symm'),
              (' Modification of the element matrix and vector ',
               2,
               None,
               '___sec146'),
              (' Boundary conditions: specified derivative ',
               1,
               'fem:deq:1D:BC:nat',
               'fem:deq:1D:BC:nat'),
              (' The variational formulation ', 2, None, '___sec148'),
              (' Boundary term vanishes because of the test functions ',
               2,
               'fem:deq:1D:BC:nat:uLtest',
               'fem:deq:1D:BC:nat:uLtest'),
              (' Boundary term vanishes because of linear system modifications ',
               2,
               'fem:deq:1D:BC:nat:uLmod',
               'fem:deq:1D:BC:nat:uLmod'),
              (' Direct computation of the global linear system ',
               2,
               'fem:deq:1D:BC:nat:Aub',
               'fem:deq:1D:BC:nat:Aub'),
              (' Cellwise computations ', 2, None, '___sec152'),
              (' Implementation ',
               1,
               'fem:deq:1D:code:global',
               'fem:deq:1D:code:global'),
              (' Global basis functions ', 2, None, '___sec154'),
              (' Example: constant right-hand side ', 2, None, '___sec155'),
              (' Finite elements ', 2, None, '___sec156'),
              (' Variational formulations in 2D and 3D ',
               1,
               'fem:deq:2D:varform',
               'fem:deq:2D:varform'),
              (' Transformation to a reference cell in 2D and 3D ',
               2,
               None,
               '___sec158'),
              (' Numerical integration ', 2, None, '___sec159'),
              (' Convenient formulas for P1 elements in 2D ',
               2,
               None,
               '___sec160'),
              (' Summary ', 1, None, '___sec161'),
              (' Time-dependent problems ',
               1,
               'fem:deq:timedep',
               'fem:deq:timedep'),
              (' Discretization in time by a Forward Euler scheme ',
               2,
               'fem:deq:diffu:FE',
               'fem:deq:diffu:FE'),
              (' Time discretization ', 3, None, '___sec164'),
              (' Space discretization ', 3, None, '___sec165'),
              (' Variational forms ', 2, None, '___sec166'),
              (' Simplified notation for the solution at recent time levels ',
               2,
               None,
               '___sec167'),
              (' Deriving the linear systems ', 2, None, '___sec168'),
              (' Computational algorithm ', 2, None, '___sec169'),
              (' Comparing P1 elements with the finite difference method ',
               2,
               'fem:deq:diffu:FE:fdvsP1fe',
               'fem:deq:diffu:FE:fdvsP1fe'),
              (' Lumping the mass matrix ', 3, None, '___sec171'),
              (' Discretization in time by a Backward Euler scheme ',
               2,
               'fem:deq:diffu:BE',
               'fem:deq:diffu:BE'),
              (' Time discretization ', 3, None, '___sec173'),
              (' Variational forms ', 3, None, '___sec174'),
              (' Linear systems ', 3, None, '___sec175'),
              (' Dirichlet boundary conditions ',
               2,
               'fem:deq:diffu:Dirichlet',
               'fem:deq:diffu:Dirichlet'),
              (' Boundary function ', 3, None, '___sec177'),
              (' Finite element basis functions ', 3, None, '___sec178'),
              (' Modification of the linear system ', 3, None, '___sec179'),
              (' Example: Oscillating Dirichlet boundary condition ',
               2,
               'fem:deq:diffu:Dirichlet:ex',
               'fem:deq:diffu:Dirichlet:ex'),
              (' Analysis of the discrete equations ',
               2,
               'fem:deq:diffu:anal',
               'fem:deq:diffu:anal'),
              (' Forward Euler discretization ', 3, None, '___sec182'),
              (' Backward Euler discretization ', 3, None, '___sec183'),
              (' Comparing amplification factors ', 3, None, '___sec184'),
              (' Systems of differential equations ',
               1,
               'fem:sys',
               'fem:sys'),
              (' Variational forms ', 2, 'fem:sys:vform', 'fem:sys:vform'),
              (' A worked example ', 2, 'fem:sys:uT:ex', 'fem:sys:uT:ex'),
              (' Identical function spaces for the unknowns ',
               2,
               None,
               '___sec188'),
              (' Variational form of each individual PDE ',
               3,
               None,
               '___sec189'),
              (' Compound scalar variational form ', 3, None, '___sec190'),
              (' Decoupled linear systems ', 3, None, '___sec191'),
              (' Coupled linear systems ', 3, None, '___sec192'),
              (' Different function spaces for the unknowns ',
               2,
               None,
               '___sec193'),
              (' Computations in 1D ', 2, None, '___sec194'),
              (' Exercises ', 1, None, '___sec195'),
              (' Exercise 23: Refactor functions into a more general class ',
               2,
               'fem:deq:exer:BVP1D:class',
               'fem:deq:exer:BVP1D:class'),
              (' Exercise 24: Compute the deflection of a cable with sine functions ',
               2,
               'fem:deq:exer:tension:cable',
               'fem:deq:exer:tension:cable'),
              (' Exercise 25: Check integration by parts ',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              (' Exercise 26: Compute the deflection of a cable with 2 P1 elements ',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              (' Exercise 27: Compute the deflection of a cable with 1 P2 element ',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              (' Exercise 28: Compute the deflection of a cable with a step load ',
               2,
               'fem:deq:exer:intg:parts',
               'fem:deq:exer:intg:parts'),
              (' Exercise 29: Show equivalence between linear systems ',
               2,
               'fem:deq:exer:Aub:essbc:equiv',
               'fem:deq:exer:Aub:essbc:equiv'),
              (' Exercise 30: Compute with a non-uniform mesh ',
               2,
               'fem:deq:exer:1D:mesh:nonuniform',
               'fem:deq:exer:1D:mesh:nonuniform'),
              (' Problem 31: Solve a 1D finite element problem by hand ',
               2,
               'fem:deq:exer:1D:gen:problem1',
               'fem:deq:exer:1D:gen:problem1'),
              (' Exercise 32: Compare finite elements and differences for a radially symmetric Poisson equation ',
               2,
               'fem:deq:exer:1D:Poisson:polar',
               'fem:deq:exer:1D:Poisson:polar'),
              (' Exercise 33: Compute with variable coefficients and P1 elements by hand ',
               2,
               'fem:deq:exer:1D:gen:problem2',
               'fem:deq:exer:1D:gen:problem2'),
              (' Exercise 34: Solve a 2D Poisson equation using polynomials and sines ',
               2,
               'fem:deq:exer:2D:torsion:xy:sin',
               'fem:deq:exer:2D:torsion:xy:sin'),
              (' Exercise 35: Analyze a Crank-Nicolson scheme for the diffusion equation ',
               2,
               'fem:deq:exer:diffu:analysis:CN',
               'fem:deq:exer:diffu:analysis:CN')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">


<!-- newcommands_keep.tex -->
$$
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\uexd}[1]{{u_{\small\mbox{e}, #1}}}
\newcommand{\vex}{{v_{\small\mbox{e}}}}
\newcommand{\vexd}[1]{{v_{\small\mbox{e}, #1}}}
\newcommand{\Aex}{{A_{\small\mbox{e}}}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\halfi}{{1/2}}
\newcommand{\tp}{\thinspace .}

\newcommand{\Ddt}[1]{\frac{D #1}{dt}}
\newcommand{\E}[1]{\hbox{E}\lbrack #1 \rbrack}
\newcommand{\Var}[1]{\hbox{Var}\lbrack #1 \rbrack}
\newcommand{\Std}[1]{\hbox{Std}\lbrack #1 \rbrack}

\newcommand{\xpoint}{\boldsymbol{x}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\Oof}[1]{\mathcal{O}(#1)}

\newcommand{\x}{\boldsymbol{x}}
\newcommand{\X}{\boldsymbol{X}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\w}{\boldsymbol{w}}
\newcommand{\V}{\boldsymbol{V}}
\newcommand{\e}{\boldsymbol{e}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\strain}{\boldsymbol{\varepsilon}}
\newcommand{\stressc}{{\sigma}}
\newcommand{\strainc}{{\varepsilon}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\T}{\boldsymbol{T}}

\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
\newcommand{\ir}{\boldsymbol{i}_r}
\newcommand{\ith}{\boldsymbol{i}_{\theta}}
\newcommand{\iz}{\boldsymbol{i}_z}

\newcommand{\Ix}{\mathcal{I}_x}
\newcommand{\Iy}{\mathcal{I}_y}
\newcommand{\Iz}{\mathcal{I}_z}
\newcommand{\It}{\mathcal{I}_t}
\newcommand{\If}{\mathcal{I}_s}     % for FEM
\newcommand{\Ifd}{{I_d}}  % for FEM
\newcommand{\Ifb}{{I_b}}  % for FEM
\newcommand{\setb}[1]{#1^0}    % set begin
\newcommand{\sete}[1]{#1^{-1}} % set end
\newcommand{\setl}[1]{#1^-}
\newcommand{\setr}[1]{#1^+}
\newcommand{\seti}[1]{#1^i}
\newcommand{\sequencei}[1]{\left\{ {#1}_i \right\}_{i\in\If}}

\newcommand{\basphi}{\varphi}
\newcommand{\baspsi}{\psi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\psib}{\boldsymbol{\psi}}
\newcommand{\sinL}[1]{\sin\left((#1+1)\pi\frac{x}{L}\right)}
\newcommand{\xno}[1]{x_{#1}}
\newcommand{\Xno}[1]{X_{(#1)}}
\newcommand{\yno}[1]{y_{#1}}
\newcommand{\Yno}[1]{Y_{(#1)}}
\newcommand{\xdno}[1]{\boldsymbol{x}_{#1}}

\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Integerp}{\mathbb{N}}
\newcommand{\Integer}{\mathbb{Z}}
$$




    
<a name="part0014"></a>
<!-- begin top navigation -->
<a href="._main_fem-solarized013.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="previous"></a>

<a href="._main_fem-solarized015.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end top navigation -->

<p>
<!-- !split -->

<h2>Boundary conditions: specified nonzero value <a name="fem:deq:1D:essBC"></a></h2>

<p>
We have to take special actions to incorporate Dirichlet conditions,
such as \( u(L)=D \), into the computational procedures. The present
section outlines alternative, yet mathematically equivalent, methods.

<h3>General construction of a boundary function <a name="fem:deq:1D:fem:essBC:Bfunc"></a></h3>

<p>
In the section <a href="._main_fem-solarized011.html#fem:deq:1D:essBC:Bfunc">Boundary function</a> we introduce a boundary function \( B(x) \)
to deal with nonzero Dirichlet boundary conditions for \( u \). The
construction of such a function is not always trivial, especially not
in multiple dimensions. However, a simple and general construction
idea exists when the
basis functions have the property

<p>
$$
\begin{equation*}
\basphi_i(\xno{j}) = \delta_{ij},\quad
\delta_{ij} = \left\lbrace\begin{array}{ll}
1, & i=j,\\ 
0, & i\neq j,
\end{array}\right.
\end{equation*}
$$

where \( \xno{j} \) is a boundary point. Examples on such
functions are the Lagrange interpolating polynomials and finite
element functions.

<p>
Suppose now that \( u \) has Dirichlet boundary conditions at nodes
with numbers \( i\in\Ifb \). For example, \( \Ifb = \{0,N_n\} \) in a 1D
mesh with node numbering from left to right.
Let \( U_i \) be the corresponding prescribed values of \( u(\xno{i}) \).
We can then, in general, use

<p>
$$
\begin{equation}
B(x) = \sum_{j\in\Ifb} U_j\basphi_j(x)\tp
\end{equation}
$$

It is easy to verify that
\( B(\xno{i})= \sum_{j\in\Ifb} U_j\basphi_j(\xno{i})=U_i \).

<p>
The unknown function can then be written as

<p>
$$
\begin{equation}
u(x) = \sum_{j\in\Ifb} U_j\basphi_j(x) + \sum_{j\in\If}c_j\basphi_{\nu(j)},
\end{equation}
$$

where \( \nu(j) \) maps unknown number \( j \) in the equation system to
node \( \nu(j) \). We can easily show that with this \( u \), a Dirichlet
condition \( u(\xno{k})=U_k \) is fulfilled:

<p>
$$
u(\xno{k}) = \sum_{j\in\Ifb} U_j\underbrace{\basphi_j(x)}_{\neq 0
\hbox{ only for }j=k} +
\sum_{j\in\If} c_j\underbrace{\basphi_{\nu(j)}(\xno{k})}_{=0,\ k\not\in\If}
= U_k $$


<p>
Some examples will further clarify the notation. With a regular
left-to-right numbering of nodes in a mesh with P1 elements,
and Dirichlet conditions at \( x=0 \), we use finite element basis
functions associated with the nodes \( 1, 2, \ldots, N_n \), implying
that  \( \nu(j)=j+1 \), \( j=0,\ldots,N \), where \( N=N_n-1 \). For the particular mesh
below the expansion becomes

<p>
$$ u(x) = U_0\basphi_0(x) + c_0\basphi_1(x) +
c_1\basphi_2(x) + \cdots + c_4\basphi_5(x)\tp
$$


<p>
<center><p><img src="fig-fem/fe_mesh1D.png" align="bottom" width=500></p></center>

<p>
Here is a mesh with an irregular cell and node numbering:

<p>
<center><p><img src="fig-fem/fe_mesh1D_random_numbering.png" align="bottom" width=500></p></center>

<p>
Say we in this latter mesh
have Dirichlet conditions on the left-most and right-most
node, with numbers 3 and 1, respectively. Then
we can number the unknowns at the interior nodes from left
to right, giving \( \nu(0)=0 \), \( \nu(1)=4 \), \( \nu(2)=5 \), \( \nu(3)=2 \).
This gives

<p>
$$ B(x) = U_3\basphi_3(x) + U_1\basphi_1(x),$$

and

<p>
$$ u(x) = B(x) + \sum_{j=0}^3 c_j\basphi_{\nu(j)}
= U_3\basphi_3 + U_1\basphi_1 + c_0\basphi_0 + c_1\basphi_4
+ c_2\basphi_5 + c_3\basphi_2\tp$$


<p>
Switching to the more standard case of left-to-right numbering and
boundary conditions \( u(0)=C \), \( u(L)=D \), we have \( N=N_n-2 \) and

<p>
$$
\begin{align*}
u(x) &= C\basphi_0 + D\basphi_{N_n} + \sum_{j\in\If} c_j\basphi_{j+1}\\ 
&= C\basphi_0 + D\basphi_{N_n} + c_0\basphi_1 + c_1\basphi_2 +\cdots
+ c_N\basphi_{N_n-1}\tp
\end{align*}
$$


<p>
The idea of constructing \( B \) described here generalizes almost
trivially to 2D and 3D problems: \( B=\sum_{j\in\Ifb}U_j\basphi_j \),
where \( \Ifb \) is the index set containing the numbers of all the
nodes on the boundaries where Dirichlet values are prescribed.

<h3>Example on computing with finite element-based a boundary function  <a name="___sec140"></a></h3>

<p>
Let us see how the model problem \( -u''=2 \), \( u(0)=C \), \( u(L)=D \),
is affected by a \( B(x) \) to incorporate boundary values.
Inserting the expression

<p>
$$ u(x) = B(x) + \sum_{j\in\If}c_j\baspsi_j(x)$$

in \( -(u'',\baspsi_i)=(f,\baspsi_i) \) and
integrating by parts results in a linear system with

<p>
$$
A_{i,j} = \int_0^L \baspsi_i'(x)\baspsi_j'(x) \dx,\quad
b_i = \int_0^L (f(x) - B'(x))\baspsi_i(x) \dx\tp
$$

We choose \( \baspsi_i=\basphi_{i+1} \), \( i=0,\ldots,N=N_n-2 \)
if the node numbering is from left
to right. (Later we also need the assumption that the cells too
are numbered from left to right.)
The boundary function becomes

<p>
$$ B(x) = C\basphi_0(x) + D\basphi_{N_n}(x)\tp$$

The expansion for \( u(x) \) is

<p>
$$ u(x)  = B(x) + \sum_{j\in\If} c_j\basphi_{j+1}(x)\tp $$

We can write the matrix and right-hand side entries as

<p>
$$
A_{i-1,j-1} = \int_0^L \basphi_i'(x)\basphi_j'(x) \dx,\quad
b_{i-1} = \int_0^L (f(x) - C\basphi_{0}'(x) - D\basphi_{N_n}'(x))\basphi_i(x) \dx,
$$

for \( i,j = 1,\ldots,N+1=N_n-1 \). Note that we have here used
\( B'=C\basphi_0' + D\basphi_{N_n}' \).

<h4>Computations in physical coordinates  <a name="___sec141"></a></h4>

<p>
Most of the terms in the linear system have already been computed
so we concentrate on the new contribution from the boundary function.
The integral \( C\int_0^L \basphi_{0}'(x))\basphi_i(x) \dx \) can only get
a nonzero contribution from the first cell,
\( \Omega^{(0)}=[\xno{0},\xno{1}] \)
since \( \basphi_{0}'(x)=0 \) on all other cells. Moreover,
\( \basphi_{0}'(x)\basphi_i(x) \dx \neq 0 \) only for \( i=0 \) and \( i=1 \)
(but \( i=0 \) is excluded),
since \( \basphi_{i}=0 \) on the first cell if \( i>1 \).
With a similar reasoning we realize that
\( D\int_0^L \basphi_{N_n}'(x))\basphi_i(x) \dx \) can only get
a nonzero contribution from the last cell.
From the explanations of the
calculations in the section <a href="._main_fem-solarized003.html#fem:approx:global:linearsystem">Calculating the linear system</a> we then find that

<p>
$$ \int_0^L \basphi_{0}'(x)\basphi_{1}(x) \dx =
\frac{1}{h}\cdot\frac{1}{h} = -{\half},\quad
\int_0^L \basphi_{N_n}'(x)\basphi_{N_n-1}(x) \dx =
\frac{1}{h}\cdot\frac{1}{h} = \half\tp$$

The extra boundary term because of \( B(x) \) boils down to adding
\( C/2 \) to \( b_{0} \) and \( -D/2 \) to \( b_{N} \).

<h4>Cellwise computations on the reference element  <a name="___sec142"></a></h4>

<p>
As an equivalent alternative, we now turn to cellwise computations.
The element matrices and vectors are calculated as the section <a href="._main_fem-solarized013.html#fem:deq:1D:comp:elmwise">Cellwise computations</a>, so we concentrate on the impact of
the new term involving \( B(x) \).
We observe that \( C\basphi_0'=0 \) on all cells except \( e=0 \),
and \( D\basphi_{N_n}'=0 \) on all cells except \( e=N_e \).
In this case there is only one unknown in these cells
since \( u(0) \) and \( u(L) \) are prescribed, so
the element vector has only one entry. The entry for the
last cell, \( e=N_e \), becomes

<p>
$$
\tilde b_0^{(e)} = \int_{-1}^1 \left(
f - D\frac{2}{h}\frac{d\refphi_1}{dX}\right)
\refphi_0\frac{h}{2} \dX
= (\frac{h}{2}(2 - D\frac{2}{h}\half)
\int_{-1}^1 \refphi_0 \dX =  h - D/2\tp
$$

Similar computations on the first cell yield

<p>
$$
\tilde b_0^{(0)} = \int_{-1}^1 \left(f - C\frac{2}{h}
\frac{d\refphi_0}{dX}\right)
\refphi_1\frac{h}{2} \dX
= (\frac{h}{2}(2 + C\frac{2}{h}\half)
\int_{-1}^1 \refphi_1 \dX =  h + C/2\tp
$$

When assembling these contributions, we see that \( b_0 \) gets
right-hand side of the linear system gets an extra term
\( C/2 \) and \( b_{N} \) gets
\( -D/2 \), as in the computations in the physical domain.

<h3>Modification of the linear system <a name="fem:deq:1D:fem:essBC:Bfunc:modsys"></a></h3>

<p>
From an implementational point of view, there is a convenient alternative
to adding the \( B(x) \) function and using only the basis functions associated
with nodes where \( u \) is truly unknown.
Instead of seeking

<p>
$$
\begin{equation}
u(x) = \sum_{j\in\Ifb} U_j\basphi_j(x)
+ \sum_{j\in\If}c_j\basphi_{\nu(j)}(x),
\tag{79}
\end{equation}
$$

we use the sum over all degrees of freedom, including the known boundary
values:

<p>
$$
\begin{equation}
u(x) = \sum_{j\in\If}c_j\basphi_j(x)\tp
\tag{80}
\end{equation}
$$

Note that the collections of unknowns
\( \sequencei{c} \) in <a href="#mjx-eqn-79">(79)</a>
and <a href="#mjx-eqn-80">(80)</a> are different:
in <a href="#mjx-eqn-79">(79)</a> \( N \) counts the
number of nodes where \( u \) is not known, while
in <a href="#mjx-eqn-79">(79)</a> \( N \) counts all
the nodes (\( N=N_n \)).

<p>
The idea is to compute the entries in the linear system as if no
Dirichlet values are prescribed. Afterwards, we modify the linear system
to ensure that the known \( c_j \) values are incorporated.

<p>
A potential problem arises for the boundary term \( [u'v]_0^L \) from the
integration by parts: imagining no Dirichlet conditions means that we
no longer require \( v=0 \) at Dirichlet points, and the boundary term is
then nonzero at these points. However, when we modify the linear
system, we will erase whatever the contribution from \( [u'v]_0^L \)
should be at the Dirichlet points in the right-hand side of the linear
system. We can therefore safely forget \( [u'v]_0^L \) at any point where
a Dirichlet condition applies.

<h4>Computations in the physical system  <a name="___sec144"></a></h4>

<p>
Let us redo the computations in the example in
the section <a href="#fem:deq:1D:fem:essBC:Bfunc">General construction of a boundary function</a>. We solve \( -u''=2 \) with
\( u(0)=0 \) and \( u(L)=D \). The expressions for \( A_{i,j} \) and \( b_i \)
are the same, but the numbering is different as the numbering of
unknowns and nodes now coincide:

<p>
$$
A_{i,j} = \int_0^L \basphi_i'(x)\basphi_j'(x) \dx,\quad
b_{i} = \int_0^L f(x)\basphi_i(x) \dx,
$$

for \( i,j = 0,\ldots,N=N_n \).
The integrals involving basis functions
corresponding to interior mesh nodes, \( i,j=1,\ldots,N_n-1 \), are
obviously the same as before. We concentrate on the contributions
from \( \basphi_0 \) and \( \basphi_{N_n} \):

<p>
$$
\begin{align*}
A_{0,0} &= \int_0^L (\basphi_0')^2\dx = \int_{0}^{\xno{1}}
= (\basphi_0')^2\dx \frac{1}{h},\\ 
A_{0,1} &= \int_0^L \basphi_0'\basphi_1'\dx
= \int_{0}^{\xno{1}} \basphi_0'\basphi_1'\dx = -\frac{1}{h},\\ 
A_{N,N} &= \int_0^L (\basphi_0')^2\dx
= \int_{\xno{N_n-1}}^{\xno{N_n}} (\basphi_0')^2\dx = \frac{1}{h},\\ 
A_{N,N-1} &= \int_0^L (\basphi_0')^2\dx
=\int_{\xno{N_n-1}}^{\xno{N_n}} (\basphi_0')^2\dx = -\frac{1}{h}\tp
\end{align*}
$$


<p>
The new terms on the right-hand side are also those involving
\( \basphi_0 \) and \( \basphi_{N_n} \):

<p>
$$
\begin{align*}
b_0 &= \int_0^L 2\basphi_0(x) \dx = \int_0^{\xno{1}} 2\basphi_0(x)\dx = h,\\ 
b_N &=  \int_0^L 2\basphi_{N_n}\dx =
\int_{\xno{N_n-1}}^{\xno{N_n}} 2\basphi_{N_n}\dx = h\tp
\end{align*}
$$


<p>
The complete matrix system, involving all degrees of freedom, takes the form

<p>
$$
\begin{equation}
\frac{1}{h}\left(
\begin{array}{ccccccccc}
1 & -1 & 0
&\cdots &
\cdots & \cdots & \cdots &
\cdots & 0 \\ 
-1 & 2 & -1 & \ddots &   & &  & &  \vdots \\ 
0 & -1 & 2 & -1 &
\ddots & &  &  & \vdots \\ 
\vdots & \ddots &  & \ddots & \ddots & 0 &  & & \vdots \\ 
\vdots &  & \ddots & \ddots & \ddots & \ddots & \ddots & & \vdots \\ 
\vdots & &  & 0 & -1 & 2 & -1 & \ddots & \vdots \\ 
\vdots & & &  & \ddots & \ddots & \ddots &\ddots  & 0 \\ 
\vdots & & & &  &\ddots  & \ddots &\ddots  & -1 \\ 
0 &\cdots & \cdots &\cdots & \cdots & \cdots  & 0 & -1 & 1
\end{array}
\right)
\left(
\begin{array}{c}
c_0 \\ 
\vdots\\ 
\vdots\\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots\\ 
c_{N}
\end{array}
\right)
=
\left(
\begin{array}{c}
h \\ 
2h\\ 
\vdots\\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
2h\\ 
h
\end{array}
\right)
\tag{81}
\end{equation}
$$


<p>
Incorporation of Dirichlet values can now be done by replacing
the first and last equation by
\( c_0=0 \) and \( c_N=D \). This action changes the system to

<p>
$$
\begin{equation}
\frac{1}{h}\left(
\begin{array}{ccccccccc}
h & 0 & 0
&\cdots &
\cdots & \cdots & \cdots &
\cdots & 0 \\ 
-1 & 2 & -1 & \ddots &   & &  & &  \vdots \\ 
0 & -1 & 2 & -1 &
\ddots & &  &  & \vdots \\ 
\vdots & \ddots &  & \ddots & \ddots & 0 &  & & \vdots \\ 
\vdots &  & \ddots & \ddots & \ddots & \ddots & \ddots & & \vdots \\ 
\vdots & &  & 0 & -1 & 2 & -1 & \ddots & \vdots \\ 
\vdots & & &  & \ddots & \ddots & \ddots &\ddots  & 0 \\ 
\vdots & & & &  &\ddots  & \ddots &\ddots  & -1 \\ 
0 &\cdots & \cdots &\cdots & \cdots & \cdots  & 0 & 0 & h
\end{array}
\right)
\left(
\begin{array}{c}
c_0 \\ 
\vdots\\ 
\vdots\\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots\\ 
c_{N}
\end{array}
\right)
=
\left(
\begin{array}{c}
0 \\ 
2h\\ 
\vdots\\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
2h\\ 
D
\end{array}
\right)
\tag{82}
\end{equation}
$$


<p>
Note that because we do not require \( \basphi_i(0)=0 \) and
\( \basphi_i(L) \), \( i\in\If \), the boundary term \( [u'v]_0^L \) gives in
principle contributions \( u'(0)\basphi_0(0) \) to \( b_0 \) and
\( u'(L)\basphi_N(L) \) to \( b_N \) (\( u'\basphi_i \) vanishes for \( x=0 \) or
\( x=L \) for \( i=1,\ldots,N-1 \)).  Nevertheless, we erase these
contributions in \( b_0 \) and \( b_N \) and insert boundary values instead. This
argument shows why we can drop computing \( [u'v]_0^L \) at Dirichlet
nodes when we implement the Dirichlet values by modifying the linear
system.

<h3>Symmetric modification of the linear system <a name="fem:deq:1D:fem:essBC:Bfunc:modsys:symm"></a></h3>

<p>
The original matrix system <a href="._main_fem-solarized013.html#mjx-eqn-74">(74)</a> is symmetric,
but the modifications in <a href="#mjx-eqn-82">(82)</a> destroy the
symmetry. Our described modification will in general destroy an
initial symmetry in the matrix system. This is not a particular
computational disadvantage for tridiagonal systems arising in 1D
problems, but may be more serious in 2D and 3D problems when the
systems are large and exploiting symmetry can be important for halving
the storage demands, speeding up computations, and/or making the
solution algorithm more robust.  Therefore, an alternative
modification which preserves symmetry is frequently applied.

<p>
Let \( c_k \) be a coefficient corresponding to a known value
\( u(\xno{k}) = U_k \).
We want to replace equation \( k \) in the system by \( c_k=U_k \), i.e.,
insert zeroes in row number \( k \) in the coefficient matrix,
set 1 on the diagonal, and replace \( b_k \) by \( U_k \).
A symmetry-preserving modification consists in first
subtracting column number \( k \) in the coefficient matrix, i.e., \( A_{i,k} \)
for \( i\in\If \), times the boundary value \( U_k \), from the
right-hand side: \( b_i \leftarrow b_i - A_{i,k}U_k \). Then we put
zeroes in row number \( k \) <em>and</em> column number \( k \) in the coefficient matrix,
and finally set \( b_k=U_k \). The steps in algorithmic form becomes

<p>

<ol>
 <li> \( b_i \leftarrow b_i - A_{i,k}U_k \) for \( i\in\If \)</li>
 <li> \( A_{i,k} = A_{k,i} = 0 \) for \( i\in\If \)</li>
 <li> \( A_{k,k}=1 \)</li>
 <li> \( b_i = U_k \)</li>
</ol>

This modification goes as follows for the specific linear system
written out in <a href="#mjx-eqn-81">(81)</a> in
the section <a href="#fem:deq:1D:fem:essBC:Bfunc:modsys">Modification of the linear system</a>. First we
subtract the first column in the coefficient matrix, times the boundary
value, from the right-hand side. Because \( c_0=0 \), this subtraction
has no effect. Then we subtract the last column, times the boundary value \( D \),
from the right-hand side. This action results in \( b_{N-1}=2h+D/h \) and
\( b_N=h-2D/h \). Thereafter, we place zeros in the first and last row and
column in the coefficient matrix and 1 on the two corresponding diagonal
entries. Finally, we set \( b_0=0 \) and \( b_N=D \). The result becomes

<p>
$$
\begin{equation}
\frac{1}{h}\left(
\begin{array}{ccccccccc}
h & 0 & 0
&\cdots &
\cdots & \cdots & \cdots &
\cdots & 0 \\ 
0 & 2 & -1 & \ddots &   & &  & &  \vdots \\ 
0 & -1 & 2 & -1 &
\ddots & &  &  & \vdots \\ 
\vdots & \ddots &  & \ddots & \ddots & 0 &  & & \vdots \\ 
\vdots &  & \ddots & \ddots & \ddots & \ddots & \ddots & & \vdots \\ 
\vdots & &  & 0 & -1 & 2 & -1 & \ddots & \vdots \\ 
\vdots & & &  & \ddots & \ddots & \ddots &\ddots  & 0 \\ 
\vdots & & & &  &\ddots  & \ddots &\ddots  & 0 \\ 
0 &\cdots & \cdots &\cdots & \cdots & \cdots  & 0 & 0 & h
\end{array}
\right)
\left(
\begin{array}{c}
c_0 \\ 
\vdots\\ 
\vdots\\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots\\ 
c_{N}
\end{array}
\right)
=
\left(
\begin{array}{c}
0 \\ 
2h\\ 
\vdots\\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
\vdots \\ 
2h +D/h\\ 
D
\end{array}
\right)
\tag{83}
\end{equation}
$$

<h3>Modification of the element matrix and vector  <a name="___sec146"></a></h3>

<p>
The modifications of the global linear system can alternatively
be done for the element matrix and vector. (The assembled
system will get the value \( n \) on the main diagonal if \( n \) elements contribute
to the same unknown, but the factor \( n \) will also appear on the
right-hand side and hence cancel out.)

<p>
We have, in the present computational example, the element matrix and vector
<a href="._main_fem-solarized013.html#mjx-eqn-77">(77)</a>. The modifications are needed in
cells where one of the degrees of freedom is known. Here, this means
the first and last cell. We compute the element matrix
and vector as there are no Dirichlet conditions. The boundary term
\( [u'v]_0^L \) is simply forgotten at nodes that have Dirichlet conditions
because the modification of the element vector will anyway erase the
contribution from the boundary term. In the first cell,
local degree of freedom number 0
is known and the modification becomes

<p>
$$
\begin{equation}
\tilde A^{(0)} =
A = \frac{1}{h}\left(\begin{array}{rr}
h & 0\\ 
-1 & 1
\end{array}\right),\quad
\tilde b^{(0)} = \left(\begin{array}{c}
0\\ 
h
\end{array}\right)\tp
\tag{84}
\end{equation}
$$

In the last cell we set

<p>
$$
\begin{equation}
\tilde A^{(N_e)} =
A = \frac{1}{h}\left(\begin{array}{rr}
1 & -1\\ 
0 & h
\end{array}\right),\quad
\tilde b^{(N_e)} = \left(\begin{array}{c}
h\\ 
D
\end{array}\right)\tp
\tag{85}
\end{equation}
$$


<p>
We can also perform the symmetric modification. This operation affects
only the last cell with a nonzero Dirichlet condition. The algorithm
is the same as for the global linear system, resulting in

<p>
$$
\begin{equation}
\tilde A^{(N-1)} =
A = \frac{1}{h}\left(\begin{array}{rr}
h & 0\\ 
0 & 1
\end{array}\right),\quad
\tilde b^{(N-1)} = \left(\begin{array}{c}
h + D/h\\ 
D
\end{array}\right)\tp
\tag{86}
\end{equation}
$$

The reader is encouraged to assemble the element matrices and vectors and
check that the result coincides with the system
<a href="#mjx-eqn-83">(83)</a>.

<p>
<!-- As a final remark, we repeat that Dirichlet conditions are referred -->
<!-- to as essential boundary conditions because they require -->
<!-- quite some work with modifying -->
<!-- either the linear system or the expansion formula -->
<!-- for \( u \). Boundary conditions for the derivative are much easier to -->
<!-- implement, as shown next, and therefore deserve the name <em>natural -->
<!-- boundary condition</em>. -->

<p>
<p>
<!-- begin bottom navigation -->
<a href="._main_fem-solarized013.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="previous"></a>

<a href="._main_fem-solarized015.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end bottom navigation -->

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

