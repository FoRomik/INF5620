

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Truncation errors in vibration ODEs &mdash; Truncation Error Analysis</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Truncation Error Analysis" href="index.html" />
    <link rel="next" title="Truncation errors in wave equations" href="._part0003_main_trunc.html" />
    <link rel="prev" title="Truncation errors in exponential decay ODE" href="._part0001_main_trunc.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._part0003_main_trunc.html" title="Truncation errors in wave equations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._part0001_main_trunc.html" title="Truncation errors in exponential decay ODE"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Truncation Error Analysis</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="truncation-errors-in-vibration-odes">
<span id="trunc-vib"></span><h1>Truncation errors in vibration ODEs<a class="headerlink" href="#truncation-errors-in-vibration-odes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="linear-model-without-damping">
<span id="trunc-vib-undamped"></span><h2>Linear model without damping<a class="headerlink" href="#linear-model-without-damping" title="Permalink to this headline">¶</a></h2>
<p>The next example on computing the truncation error involves the
following ODE for vibration problems:</p>
<div class="math" id="equation-trunc:vib:undamped:ode">
<span class="eqno">(1)</span>\[     u''(t) + \omega^2 u(t) = 0{\thinspace .}\]</div>
<p>Here, <span class="math">\(\omega\)</span> is a given constant.</p>
<div class="section" id="the-truncation-error-of-a-centered-finite-difference-scheme">
<h3>The truncation error of a centered finite difference scheme<a class="headerlink" href="#the-truncation-error-of-a-centered-finite-difference-scheme" title="Permalink to this headline">¶</a></h3>
<p>Using a standard, second-ordered, central difference for the
second-order derivative time, we have the scheme</p>
<div class="math" id="equation-trunc:vib:undamped:scheme">
<span class="eqno">(2)</span>\[     [D_tD_t u + \omega^2u=0]^n\]\[     \thinspace .\]</div>
<p>Inserting the exact solution <span class="math">\({u_{\small\mbox{e}}}\)</span> in this equation and adding
a residual <span class="math">\(R\)</span> so that <span class="math">\({u_{\small\mbox{e}}}\)</span> can fulfill the equation results in</p>
<div class="math">
\[[D_tD_t {u_{\small\mbox{e}}} + \omega^2{u_{\small\mbox{e}}} =R]^n
\thinspace .\]</div>
<p>To calculate the truncation error <span class="math">\(R^n\)</span>, we use <a href="#equation-trunc:fd2:center">(?)</a>, i.e.,</p>
<div class="math">
\[[D_tD_t {u_{\small\mbox{e}}}]^n = {u_{\small\mbox{e}}}''(t_n) + \frac{1}{12}{u_{\small\mbox{e}}}''''(t_n)\Delta t^2,\]</div>
<p>and the fact that <span class="math">\({u_{\small\mbox{e}}}''(t) + \omega^2{u_{\small\mbox{e}}}(t)=0\)</span>. The result is</p>
<div class="math">
\[R^n =  \frac{1}{12}{u_{\small\mbox{e}}}''''(t_n)\Delta t^2 + {\mathcal{O}(\Delta t^4)}
\thinspace .\]</div>
</div>
<div class="section" id="the-truncation-error-of-approximating">
<h3>The truncation error of approximating <span class="math">\(u'(0)\)</span><a class="headerlink" href="#the-truncation-error-of-approximating" title="Permalink to this headline">¶</a></h3>
<p>The initial conditions for <a href="#equation-trunc:vib:undamped:ode">(1)</a> are
<span class="math">\(u(0)=I\)</span> and <span class="math">\(u'(0)=V\)</span>. The latter involves a finite difference
approximation. The standard choice</p>
<div class="math">
\[[D_{2t}u=V]^0,\]</div>
<p>where <span class="math">\(u^{-1}\)</span> is eliminated with the aid of the discretized ODE
for <span class="math">\(n=0\)</span>, involves a centered difference with an
<span class="math">\({\mathcal{O}(\Delta t^2)}\)</span> truncation error
given by <a href="#equation-trunc:fd1:center2">(?)</a>. The simpler choice</p>
<div class="math">
\[[D_t^+u = V]^0,\]</div>
<p>is based on a forward difference with a truncation error <span class="math">\({\mathcal{O}(\Delta t)}\)</span>.
A central question is if this initial error will impact the
order of the scheme throughout the simulation.
<a class="reference internal" href="main_trunc.html#trunc-exer-vib-ic-fw"><em>Exercise 11: Investigate the impact of approximating </em></a> asks you to quickly perform an
experiment to investigate this question.</p>
</div>
<div class="section" id="computing-correction-terms">
<h3>Computing correction terms<a class="headerlink" href="#computing-correction-terms" title="Permalink to this headline">¶</a></h3>
<p>The idea of using correction terms to increase the order of <span class="math">\(R^n\)</span> can
be applied as described in the section <a class="reference internal" href="main_trunc.html#trunc-decay-corr"><em>Increasing the accuracy by adding correction terms</em></a>. We look at</p>
<div class="math">
\[[D_tD_t {u_{\small\mbox{e}}} + \omega^2{u_{\small\mbox{e}}} =C + R]^n,\]</div>
<p>and observe that <span class="math">\(C^n\)</span> must be chosen to cancel
the <span class="math">\(\Delta t^2\)</span> term in <span class="math">\(R^n\)</span>. That is,</p>
<div class="math">
\[C^n = \frac{1}{12}{u_{\small\mbox{e}}}''''(t_n)\Delta t^2{\thinspace .}\]</div>
<p>To get rid of the 4th-order derivative we can use the differential
equation: <span class="math">\(u''=-\omega^u\)</span>, which implies <span class="math">\(u'''' = \omega^4 u\)</span>.
Adding the correction term to the ODE results in</p>
<div class="math" id="equation-trunc:vib:undamped:corr:ode">
<span class="eqno">(3)</span>\[     u'' + \omega^2(1 - \frac{1}{12}\omega^2\Delta t^2)u = 0{\thinspace .}\]</div>
<p>Solving this equation by the standard scheme</p>
<div class="math">
\[[D_tD_t u + \omega^2(1 - \frac{1}{12}\omega^2\Delta t^2)u=0]^n,\]</div>
<p>will result in a scheme with trunction error <span class="math">\({\mathcal{O}(\Delta t^4)}\)</span>.</p>
<p>We can use another set of arguments to justify that <a href="#equation-trunc:vib:undamped:corr:ode">(3)</a> leads to a higher-order method.
Mathematical analysis of the scheme <a href="#equation-trunc:vib:undamped:scheme">(2)</a>
reveals that the numerical frequency <span class="math">\(\tilde\omega\)</span> is (approximately
as <span class="math">\(\Delta t\rightarrow 0\)</span>)</p>
<div class="math">
\[\tilde\omega = \omega (1+\frac{1}{24}\omega^2\Delta t^2){\thinspace .}\]</div>
<p>One can therefore attempt to replace <span class="math">\(\omega\)</span> in the ODE by
a slightly smaller <span class="math">\(\omega\)</span> since the numerics will make it larger:</p>
<div class="math">
\[[ u'' + (\omega(1 - \frac{1}{24}\omega^2\Delta t^2))^2 u = 0{\thinspace .}\]</div>
<p>Expanding the squared term and omitting the higher-order term <span class="math">\(\Delta t^4\)</span>
gives exactly the ODE <a href="#equation-trunc:vib:undamped:corr:ode">(3)</a>. Experiments
show that <span class="math">\(u^n\)</span> is computed to 4th order in <span class="math">\(\Delta t\)</span>.</p>
</div>
</div>
<div class="section" id="model-with-damping-and-nonlinearity">
<span id="trunc-vib-gen"></span><h2>Model with damping and nonlinearity<a class="headerlink" href="#model-with-damping-and-nonlinearity" title="Permalink to this headline">¶</a></h2>
<p>The model <a href="#equation-trunc:vib:undamped:ode">(1)</a>
can be extended to include damping <span class="math">\(\beta u'\)</span>,
a nonlinear restoring (spring) force <span class="math">\(s(u)\)</span>, and some
known excitation force <span class="math">\(F(t)\)</span>:</p>
<div class="math" id="equation-trunc:vib:gen:ode1">
<span class="eqno">(4)</span>\[     mu'' + \beta u' + s(u) =F(t){\thinspace .}\]</div>
<p>The coefficient <span class="math">\(m\)</span> usually represents the mass of the system.
This governing equation can by discretized by centered differences:</p>
<div class="math">
\[[mD_tD_t u + \beta D_{2t} u + s(u)=F]^n
\thinspace .\]</div>
<p>The exact solution <span class="math">\({u_{\small\mbox{e}}}\)</span> fulfills the discrete equations with a residual term:</p>
<div class="math">
\[[mD_tD_t {u_{\small\mbox{e}}} + \beta D_{2t} {u_{\small\mbox{e}}} + s({u_{\small\mbox{e}}})=F + R]^n
\thinspace .\]</div>
<p>Using <a href="#equation-trunc:fd2:center">(?)</a> and <a href="#equation-trunc:fd1:center2">(?)</a> we
get</p>
<div class="math">
\[\begin{split}[mD_tD_t {u_{\small\mbox{e}}} + \beta D_{2t} {u_{\small\mbox{e}}}]^n &amp;=
m{u_{\small\mbox{e}}}''(t_n) + \beta{u_{\small\mbox{e}}}'(t_n) + \\
&amp;\quad \left(\frac{m}{12}{u_{\small\mbox{e}}}''''(t_n) +
  \frac{\beta}{6}{u_{\small\mbox{e}}}'''(t_n)\right)\Delta t^2 + {\mathcal{O}(\Delta t^4)}\end{split}\]</div>
<p>Combining this with the previous equation, we can collect the terms</p>
<div class="math">
\[m{u_{\small\mbox{e}}}''(t_n) + \beta{u_{\small\mbox{e}}}'(t_n) + \omega^2{u_{\small\mbox{e}}}(t_n) + s({u_{\small\mbox{e}}}(t_n)) - F^n,\]</div>
<p>and set this sum to zero because <span class="math">\({u_{\small\mbox{e}}}\)</span> solves
the differential equation. We are left with
the truncation error</p>
<div class="math" id="equation-trunc:vib:gen:R">
<span class="eqno">(5)</span>\[     R^n = \left(\frac{m}{12}{u_{\small\mbox{e}}}''''(t_n) +
       \frac{\beta}{6}{u_{\small\mbox{e}}}'''(t_n)\right)\Delta t^2 + {\mathcal{O}(\Delta t^4)},\]</div>
<p>so the scheme is of second order.</p>
<p>According to <a href="#equation-trunc:vib:gen:R">(5)</a>, we can add correction terms</p>
<div class="math">
\[C^n = \left(\frac{m}{12}{u_{\small\mbox{e}}}''''(t_n) +
 \frac{\beta}{6}{u_{\small\mbox{e}}}'''(t_n)\right)\Delta t^2,\]</div>
<p>to the right-hand side of the ODE to obtain a fourth-order scheme.
However, expressing <span class="math">\(u''''\)</span> and <span class="math">\(u'''\)</span> in terms
of lower-order derivatives is now harder because the differential equation
is more complicated:</p>
<div class="math">
\[\begin{split}u''' &amp;= \frac{1}{m}(F' - \beta u'' - s'(u)u'),\\
u'''' &amp;= \frac{1}{m}(F'' - \beta u''' - s''(u)(u')^2 - s'(u)u''),\\
&amp;= \frac{1}{m}(F'' - \beta \frac{1}{m}(F' - \beta u'' - s'(u)u')
- s''(u)(u')^2 - s'(u)u''){\thinspace .}\end{split}\]</div>
<p>It is not impossible to discretize the resulting modified ODE, but it is up
to debate whether correction terms are feasible and the way to go.
Computing with a smaller <span class="math">\(\Delta t\)</span> is usually always possible in these
problems to achieve the desired accuracy.</p>
</div>
<div class="section" id="extension-to-quadratic-damping">
<h2>Extension to quadratic damping<a class="headerlink" href="#extension-to-quadratic-damping" title="Permalink to this headline">¶</a></h2>
<p>Instead of the linear damping term <span class="math">\(\beta u'\)</span> in <a href="#equation-trunc:vib:gen:ode1">(4)</a>
we now consider quadratic damping <span class="math">\(\beta |u'|u'\)</span>:</p>
<div class="math" id="equation-trunc:vib:gen:ode2">
<span class="eqno">(6)</span>\[     mu'' + \beta |u'|u' + s(u) =F(t){\thinspace .}\]</div>
<p>A centered difference for <span class="math">\(u'\)</span> gives rise to a nonlinearity, which can
be linearized using a geometric mean:
<span class="math">\([|u'|u']^n \approx |[u']^{n-\frac{1}{2}}|[u']^{n+\frac{1}{2}}\)</span>.
The resulting scheme becomes</p>
<div class="math">
\[[mD_t D_t u]^n + \beta |[D_{t} u]^{n-\frac{1}{2}}|[D_t u]^{n+\frac{1}{2}}
+ s(u^n)=F^n{\thinspace .}\]</div>
<p>The truncation error is defined through</p>
<div class="math">
\[[mD_t D_t {u_{\small\mbox{e}}}]^n +
\beta |[D_{t} {u_{\small\mbox{e}}}]^{n-\frac{1}{2}}|[D_t {u_{\small\mbox{e}}}]^{n+\frac{1}{2}}
+ s({u_{\small\mbox{e}}}^n)-F^n = R^n{\thinspace .}\]</div>
<p>We start with expressing the truncation error of the geometric mean.
According to <a href="#equation-trunc:avg:geom">(?)</a>,</p>
<div class="math">
\[|[D_{t} {u_{\small\mbox{e}}}]^{n-\frac{1}{2}}|[D_t {u_{\small\mbox{e}}}]^{n+\frac{1}{2}}
= [|D_t{u_{\small\mbox{e}}}|D_t{u_{\small\mbox{e}}}]^n
- \frac{1}{4}u'(t_n)^2\Delta t^2  + \frac{1}{4}u(t_n)u''(t_n)\Delta t^2
+ {\mathcal{O}(\Delta t^4)}{\thinspace .}\]</div>
<p>Using <a href="#equation-trunc:fd1:center">(?)</a> for the <span class="math">\(D_t{u_{\small\mbox{e}}}\)</span> factors results in</p>
<div class="math">
\[[|D_t{u_{\small\mbox{e}}}|D_t{u_{\small\mbox{e}}}]^n = |{u_{\small\mbox{e}}}' + \frac{1}{24}{u_{\small\mbox{e}}}'''(t_n)\Delta t^2 +
{\mathcal{O}(\Delta t^4)}|({u_{\small\mbox{e}}}' + \frac{1}{24}{u_{\small\mbox{e}}}'''(t_n)\Delta t^2 +
{\mathcal{O}(\Delta t^4)})\]</div>
<p>We can remove the absolute value since it essentially gives a factor 1 or -1
only. Calculating the product, we have the leading-order terms</p>
<div class="math">
\[[D_t{u_{\small\mbox{e}}} D_t{u_{\small\mbox{e}}}]^n = ({u_{\small\mbox{e}}}'(t_n))^2 +
\frac{1}{12}{u_{\small\mbox{e}}}(t_n){u_{\small\mbox{e}}}'''(t_n)\Delta t^2 +
{\mathcal{O}(\Delta t^4)}{\thinspace .}\]</div>
<p>With</p>
<div class="math">
\[m[D_t D_t{u_{\small\mbox{e}}}]^n = m{u_{\small\mbox{e}}}''(t_n) + \frac{m}{12}{u_{\small\mbox{e}}}''''(t_n)\Delta t^2
+{\mathcal{O}(\Delta t^4)},\]</div>
<p>and using the differential equation on the
form <span class="math">\(mu'' + \beta (u')^2 + s(u)=F\)</span>, we end up with</p>
<div class="math">
\[R^n = (\frac{m}{12}{u_{\small\mbox{e}}}''''(t_n) +
\frac{\beta}{12}{u_{\small\mbox{e}}}(t_n){u_{\small\mbox{e}}}'''(t_n))
\Delta t^2 + {\mathcal{O}(\Delta t^4)}{\thinspace .}\]</div>
<p>This result demonstrates that we have
second-order accuracy also with quadratic damping.
The key elements that lead to the second-order accuracy is that
the difference approximations are <span class="math">\({\mathcal{O}(\Delta t^2)}\)</span> <em>and</em> the
geometric mean approximation is also of <span class="math">\({\mathcal{O}(\Delta t^2)}\)</span>.</p>
</div>
<div class="section" id="the-general-model-formulated-as-first-order-odes">
<span id="trunc-vib-gen-staggered"></span><h2>The general model formulated as first-order ODEs<a class="headerlink" href="#the-general-model-formulated-as-first-order-odes" title="Permalink to this headline">¶</a></h2>
<p>The second-order model <a href="#equation-trunc:vib:gen:ode2">(6)</a> can be
formulated as a first-order system,</p>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:u">
<span class="eqno">(7)</span>\[     u' = v,\]</div>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:v">
<span class="eqno">(8)</span>\[     v' = \frac{1}{m}\left( F(t) - \beta |v|v - s(u)\right){\thinspace .}\]</div>
<p>The system <a href="#equation-trunc:vib:gen:2x2model:ode:u">(7)</a>-<a href="#equation-trunc:vib:gen:2x2model:ode:u">(7)</a> can be solved either by a forward-backward scheme or a centered
scheme on a staggered mesh.</p>
<div class="section" id="the-forward-backward-scheme">
<h3>The forward-backward scheme<a class="headerlink" href="#the-forward-backward-scheme" title="Permalink to this headline">¶</a></h3>
<p>The discretization is based on the idea of stepping
<a href="#equation-trunc:vib:gen:2x2model:ode:u">(7)</a> forward in time and then
using a backward difference in <a href="#equation-trunc:vib:gen:2x2model:ode:v">(8)</a>
with the recently computed (and therefore known) <span class="math">\(u\)</span>:</p>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:u:fw">
<span class="eqno">(9)</span>\[     [D_t^+ u = v]^n,\]</div>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:v:bw">
<span class="eqno">(10)</span>\[     [D_t^-v = \frac{1}{m}( F(t) - \beta |v|v - s(u))]^{n+1}{\thinspace .}\]</div>
<p>The term <span class="math">\(|v|v\)</span> gives rise to a nonlinearity <span class="math">\(|v^{n+1}|v^{n+1}\)</span>,
which can be linearized as <span class="math">\(|v^{n}|v^{n+1}\)</span>:</p>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:u:fw2">
<span class="eqno">(11)</span>\[     [D_t^+ u = v]^n,\]</div>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:v:bw2">
<span class="eqno">(12)</span>\[     [D_t^-v]^{n+1} = \frac{1}{m}( F(t_{n+1}) - \beta |v^n|v^{n+1} - s(u^{n+1})){\thinspace .}\]</div>
<p>Each ODE will have a truncation error when inserting the exact
solutions <span class="math">\({u_{\small\mbox{e}}}\)</span> and <span class="math">\({v_{\small\mbox{e}}}\)</span> in
<a href="#equation-trunc:vib:gen:2x2model:ode:u:fw">(9)</a>-<a href="#equation-trunc:vib:gen:2x2model:ode:v:bw">(10)</a>:</p>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:u:fw:R">
<span class="eqno">(13)</span>\[     [D_t^+ {u_{\small\mbox{e}}} = {v_{\small\mbox{e}}} + R_u]^n,\]</div>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:v:bw:R">
<span class="eqno">(14)</span>\[     [D_t^-{v_{\small\mbox{e}}}]^{n+1} = \frac{1}{m}( F(t_{n+1}) - \beta |{v_{\small\mbox{e}}}(t_n)|{v_{\small\mbox{e}}}(t_{n+1}) - s({u_{\small\mbox{e}}}(t_{n+1}))) + R_v^{n+1}{\thinspace .}\]</div>
<p>Application of <a href="#equation-trunc:fd1:fw">(?)</a> and <a href="#equation-trunc:fd1:bw">(?)</a>
in <a href="#equation-trunc:vib:gen:2x2model:ode:u:fw:R">(13)</a> and
<a href="#equation-trunc:vib:gen:2x2model:ode:v:bw:R">(14)</a>, respectively, gives</p>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:u:fw:R2">
<span class="eqno">(15)</span>\[     {u_{\small\mbox{e}}}'(t_n) + \frac{1}{2}{u_{\small\mbox{e}}}''(t_n)\Delta t + {\mathcal{O}(\Delta t^2)}
     = {v_{\small\mbox{e}}}(t_n) + R_u^n,\]</div>
<div class="math">
\[{v_{\small\mbox{e}}}'(t_{n+1}) - \frac{1}{2}{v_{\small\mbox{e}}}''(t_{n+1})\Delta t + {\mathcal{O}(\Delta t^2)}
= \frac{1}{m}(F(t_{n+1}) - \beta|{v_{\small\mbox{e}}}(t_n)|{v_{\small\mbox{e}}}(t_{n+1}) +\nonumber\]</div>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:v:bw:R2">
<span class="eqno">(16)</span>\[     \quad s({u_{\small\mbox{e}}}(t_{n+1}))+ R_v^n{\thinspace .}\]</div>
<p>Since <span class="math">\({u_{\small\mbox{e}}} ' = {v_{\small\mbox{e}}}\)</span>, <a href="#equation-trunc:vib:gen:2x2model:ode:u:fw:R2">(15)</a>
gives</p>
<div class="math">
\[R_u^n = \frac{1}{2}{u_{\small\mbox{e}}}''(t_n)\Delta t + {\mathcal{O}(\Delta t^2)}{\thinspace .}\]</div>
<p>In <a href="#equation-trunc:vib:gen:2x2model:ode:v:bw:R2">(16)</a> we can collect the
terms that constitute the ODE, but the damping term has the wrong
form.
Let us drop the absolute value in the damping term for simplicity.
Adding a substracting the right form <span class="math">\(v^{n+1}v^{n+1}\)</span> helps:</p>
<div class="math">
\[\begin{split}{v_{\small\mbox{e}}}'(t_{n+1}) &amp;-
\frac{1}{m}(F(t_{n+1}) - \beta {v_{\small\mbox{e}}}(t_{n+1}){v_{\small\mbox{e}}}(t_{n+1}) +
s({u_{\small\mbox{e}}}(t_{n+1})) + \\
&amp; (\beta {v_{\small\mbox{e}}}(t_n){v_{\small\mbox{e}}}(t_{n+1}) - \beta {v_{\small\mbox{e}}}(t_{n+1}){v_{\small\mbox{e}}}(t_{n+1}))),\end{split}\]</div>
<p>which reduces to</p>
<div class="math">
\[\begin{split}\frac{\beta}{m}{v_{\small\mbox{e}}}(t_{n+1}({v_{\small\mbox{e}}}(t_n) - {v_{\small\mbox{e}}}(t_{n+1}))
&amp;= \frac{\beta}{m}{v_{\small\mbox{e}}}(t_{n+1}[D_t^-{v_{\small\mbox{e}}}]^{n+1}\Delta t\\
&amp;= \frac{\beta}{m}{v_{\small\mbox{e}}}(t_{n+1}({v_{\small\mbox{e}}}'(t_{n+1})\Delta t +
-\frac{1}{2}{v_{\small\mbox{e}}}'''(t_{n+1})\Delta t^ + {\mathcal{O}(\Delta t^3)}){\thinspace .}\end{split}\]</div>
<p>We end with <span class="math">\(R_u^n\)</span> and <span class="math">\(R_v^{n+1}\)</span> as <span class="math">\({\mathcal{O}(\Delta t)}\)</span>, simply because
all the building blocks in the schemes (the forward and backward
differences and the linearization trick) are only first-order
accurate. However, this analysis is misleading: the building blocks
play together in a way that makes the scheme second-order accurate.
This is shown by considering an alternative, yet equivalent, formulation
of the above scheme.</p>
</div>
<div class="section" id="a-centered-scheme-on-a-staggered-mesh">
<h3>A centered scheme on a staggered mesh<a class="headerlink" href="#a-centered-scheme-on-a-staggered-mesh" title="Permalink to this headline">¶</a></h3>
<p>We now introduce a staggered mesh where we
seek <span class="math">\(u\)</span> at mesh points <span class="math">\(t_n\)</span> and <span class="math">\(v\)</span> at points <span class="math">\(t_{n+\frac{1}{2}}\)</span>
in between the <span class="math">\(u\)</span> points. The staggered mesh makes it easy to
formulate centered differences in the system
<a href="#equation-trunc:vib:gen:2x2model:ode:u">(7)</a>-<a href="#equation-trunc:vib:gen:2x2model:ode:u">(7)</a>:</p>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:u:staggered">
<span class="eqno">(17)</span>\[     [D_t u = v]^{n-\frac{1}{2}},\]</div>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:v:staggered">
<span class="eqno">(18)</span>\[     [D_t v = \frac{1}{m}( F(t) - \beta |v|v - s(u))]^{n}{\thinspace .}\]</div>
<p>The term <span class="math">\(|v^n|v^n\)</span> causes trouble since <span class="math">\(v^n\)</span> is not computed, only
<span class="math">\(v^{n-\frac{1}{2}}\)</span> and <span class="math">\(v^{n+\frac{1}{2}}\)</span>. Using geometric mean,
we can express <span class="math">\(|v^n|v^n\)</span> in terms of known quantities:
<span class="math">\(|v^n|v^n \approx |v^{n-\frac{1}{2}}|v^{n+\frac{1}{2}}\)</span>.
We then have</p>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:u:staggered2">
<span class="eqno">(19)</span>\[     [D_t u]^{n-\frac{1}{2}} = v^{n-\frac{1}{2}},\]</div>
<div class="math" id="equation-trunc:vib:gen:2x2model:ode:v:staggered2">
<span class="eqno">(20)</span>\[     [D_t v]^n = \frac{1}{m}( F(t_n) -
     \beta |v^{n-\frac{1}{2}}|v^{n+\frac{1}{2}} - s(u^n)){\thinspace .}\]</div>
<p>The truncation error in each equation fulfills</p>
<div class="math">
\[\begin{split}[D_t {u_{\small\mbox{e}}}]^{n-\frac{1}{2}} &amp;= {v_{\small\mbox{e}}}(t_{n-\frac{1}{2}}) + R_u^{n-\frac{1}{2}},\\
[D_t {v_{\small\mbox{e}}}]^n &amp;= \frac{1}{m}( F(t_n) -
\beta |{v_{\small\mbox{e}}}(t_{n-\frac{1}{2}})|{v_{\small\mbox{e}}}(t_{n+\frac{1}{2}}) - s(u^n)) + R_v^n{\thinspace .}\end{split}\]</div>
<p>The truncation error of the centered differences is given
by <a href="#equation-trunc:fd1:center">(?)</a>, and the geometric mean approximation
analysis can be taken from <a href="#equation-trunc:avg:geom">(?)</a>.
These results lead to</p>
<div class="math">
\[{u_{\small\mbox{e}}}'(t_{n-\frac{1}{2}}) +
\frac{1}{24}{u_{\small\mbox{e}}}'''(t_{n-\frac{1}{2}})\Delta t^2 + {\mathcal{O}(\Delta t^4)}
= {v_{\small\mbox{e}}}(t_{n-\frac{1}{2}}) + R_u^{n-\frac{1}{2}},\]</div>
<p>and</p>
<div class="math">
\[{v_{\small\mbox{e}}}'(t_n) =
\frac{1}{m}( F(t_n) -
\beta |{v_{\small\mbox{e}}}(t_n)|{v_{\small\mbox{e}}}(t_n) + {\mathcal{O}(\Delta t^2)} - s(u^n)) + R_v^n{\thinspace .}\]</div>
<p>The ODEs fulfilled by <span class="math">\({u_{\small\mbox{e}}}\)</span> and <span class="math">\({v_{\small\mbox{e}}}\)</span> are evident in these equations,
and we achieve second-order accuracy for the truncation error
in both equations:</p>
<div class="math">
\[R_u^{n-\frac{1}{2}}= {\mathcal{O}(\Delta t^2)}, \quad R_v^n = {\mathcal{O}(\Delta t^2)}{\thinspace .}\]</div>
<p>Comparing
<a href="#equation-trunc:vib:gen:2x2model:ode:u:staggered2">(19)</a>-<a href="#equation-trunc:vib:gen:2x2model:ode:v:staggered2">(20)</a>
with
<a href="#equation-trunc:vib:gen:2x2model:ode:u:fw2">(11)</a>-<a href="#equation-trunc:vib:gen:2x2model:ode:v:bw2">(12)</a>,
we can hopefully realize that these schemes are equivalent (which
becomes clear when we implement both).  The obvious advantage with the
staggered mesh approach is that we can all the way use second-order
accurate building blocks and in this way concince ourselves that the
resulting scheme has an error of <span class="math">\({\mathcal{O}(\Delta t^2)}\)</span>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Truncation errors in vibration ODEs</a><ul>
<li><a class="reference internal" href="#linear-model-without-damping">Linear model without damping</a><ul>
<li><a class="reference internal" href="#the-truncation-error-of-a-centered-finite-difference-scheme">The truncation error of a centered finite difference scheme</a></li>
<li><a class="reference internal" href="#the-truncation-error-of-approximating">The truncation error of approximating <span class="math">\(u'(0)\)</span></a></li>
<li><a class="reference internal" href="#computing-correction-terms">Computing correction terms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#model-with-damping-and-nonlinearity">Model with damping and nonlinearity</a></li>
<li><a class="reference internal" href="#extension-to-quadratic-damping">Extension to quadratic damping</a></li>
<li><a class="reference internal" href="#the-general-model-formulated-as-first-order-odes">The general model formulated as first-order ODEs</a><ul>
<li><a class="reference internal" href="#the-forward-backward-scheme">The forward-backward scheme</a></li>
<li><a class="reference internal" href="#a-centered-scheme-on-a-staggered-mesh">A centered scheme on a staggered mesh</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._part0001_main_trunc.html"
                        title="previous chapter">Truncation errors in exponential decay ODE</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._part0003_main_trunc.html"
                        title="next chapter">Truncation errors in wave equations</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/._part0002_main_trunc.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._part0003_main_trunc.html" title="Truncation errors in wave equations"
             >next</a> |</li>
        <li class="right" >
          <a href="._part0001_main_trunc.html" title="Truncation errors in exponential decay ODE"
             >previous</a> |</li>
        <li><a href="index.html">Truncation Error Analysis</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
  <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
  </div>
</div>

  </body>
</html>