<!DOCTYPE html>
<!--
Automatically generated HTML file from Doconce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Study Guide: Solving differential equations with finite elements">
<meta name="keywords" content="trial function,test function,trial space,test space,integration by parts">



<style type="text/css">
    /* bloodish style */

    body {
      font-family: Helvetica, Verdana, Arial, Sans-serif;
      color: #404040;
      background: #ffffff;
    }
    h1 { font-size: 1.8em;  color: #8A0808; }
    h2 { font-size: 1.6em;  color: #8A0808; }
    h3 { font-size: 1.4em;  color: #8A0808; }
    h4 { color: #8A0808; }
    a { color: #8A0808; text-decoration:none; }
    tt { font-family: "Courier New", Courier; }
    
    p { text-indent: 0px; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .alert-text-small   { font-size: 80%;  }
    .alert-text-large   { font-size: 130%; }
    .alert-text-normal  { font-size: 90%;  }
    .alert {
             padding:8px 35px 8px 14px; margin-bottom:18px;
             text-shadow:0 1px 0 rgba(255,255,255,0.5);
             border:1px solid #bababa;
             -webkit-border-radius: 4px; -moz-border-radius: 4px;
             border-radius: 4px
             color: #555;
             background-color: #f8f8f8;
             background-position: 10px 5px;
             background-repeat: no-repeat;
             background-size: 38px;
             padding-left: 55px;
             width: 75%;
     }
     .alert-block {padding-top:14px; padding-bottom:14px}
     .alert-block > p, .alert-block > ul {margin-bottom:1em}
     .alert li {margin-top: 1em}
     .alert-block p+p {margin-top:5px}
     .alert-notice { background-image: url(https://doconce.googlecode.com/hg/bundled/html_images/small_gray_notice.png); }
     .alert-summary  { background-image:url(https://doconce.googlecode.com/hg/bundled/html_images/small_gray_summary.png); }
     .alert-warning { background-image: url(https://doconce.googlecode.com/hg/bundled/html_images/small_gray_warning.png); }
     .alert-question {background-image:url(https://doconce.googlecode.com/hg/bundled/html_images/small_gray_question.png); }

</style>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Differential equation models ',
               1,
               'fem:deq:1D:models',
               'fem:deq:1D:models'),
              (' Abstract differential equation ', 2, None, '___sec1'),
              (' Abstract boundary conditions ', 2, None, '___sec2'),
              (' Reminder about notation ', 2, None, '___sec3'),
              (' Residual-minimizing principles ',
               2,
               'fem:deq:1D:residual:min',
               'fem:deq:1D:residual:min'),
              (' The least squares method ', 2, None, '___sec5'),
              (' The Galerkin method ', 2, None, '___sec6'),
              (' The Method of Weighted Residuals ', 2, None, '___sec7'),
              (' Terminology: test and Trial Functions ', 2, None, '___sec8'),
              (' The collocation method ', 2, None, '___sec9'),
              (' Examples on using the principles ',
               1,
               'fem:deq:1D:ex:sines',
               'fem:deq:1D:ex:sines'),
              (' The first model problem ', 2, None, '___sec11'),
              (' Boundary conditions ', 2, None, '___sec12'),
              (' The least squares method; principle ', 2, None, '___sec13'),
              (' The least squares method; equation system ',
               2,
               None,
               '___sec14'),
              (' Orthogonality of the basis functions gives diagonal matrix ',
               2,
               None,
               '___sec15'),
              (' Least squares method; solution ', 2, None, '___sec16'),
              (' The Galerkin method; principle ', 2, None, '___sec17'),
              (' The Galerkin method; solution ', 2, None, '___sec18'),
              (' The collocation method ', 2, None, '___sec19'),
              (' Comparison of the methods ', 2, None, '___sec20'),
              (' Useful techniques ', 1, None, '___sec21'),
              (' Integration by parts ',
               2,
               'fem:deq:1D:varform',
               'fem:deq:1D:varform'),
              (' Boundary function; principles ',
               2,
               'fem:deq:1D:essBC:Bfunc',
               'fem:deq:1D:essBC:Bfunc'),
              (' Boundary function; example ', 2, None, '___sec24'),
              (' Abstract notation for variational formulations ',
               2,
               'fem:deq:1D:varform:abstract',
               'fem:deq:1D:varform:abstract'),
              (' Example on abstract notation ', 2, None, '___sec26'),
              (' Bilinear and linear forms ', 2, None, '___sec27'),
              (' The linear system associated with abstract form ',
               2,
               None,
               '___sec28'),
              (' Equivalence with minimization problem ',
               2,
               None,
               '___sec29'),
              (' Examples on variational formulations ',
               1,
               'fem:deq:1D:varform:ex',
               'fem:deq:1D:varform:ex'),
              (' Variable coefficient; problem ', 2, None, '___sec31'),
              (' Variable coefficient; variational formulation (1) ',
               2,
               None,
               '___sec32'),
              (' Variable coefficient; variational formulation (2) ',
               2,
               None,
               '___sec33'),
              (' Variable coefficient; abstract notation ',
               2,
               None,
               '___sec34'),
              (' Variable coefficient; linear system ', 2, None, '___sec35'),
              (' First-order derivative in the equation and boundary condition; problem ',
               2,
               None,
               '___sec36')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">


<!-- newcommands_keep.tex -->
$$
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\uexd}[1]{{u_{\small\mbox{e}, #1}}}
\newcommand{\vex}{{v_{\small\mbox{e}}}}
\newcommand{\vexd}[1]{{v_{\small\mbox{e}, #1}}}
\newcommand{\Aex}{{A_{\small\mbox{e}}}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\halfi}{{1/2}}
\newcommand{\tp}{\thinspace .}

\newcommand{\Ddt}[1]{\frac{D #1}{dt}}
\newcommand{\E}[1]{\hbox{E}\lbrack #1 \rbrack}
\newcommand{\Var}[1]{\hbox{Var}\lbrack #1 \rbrack}
\newcommand{\Std}[1]{\hbox{Std}\lbrack #1 \rbrack}

\newcommand{\xpoint}{\boldsymbol{x}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\Oof}[1]{\mathcal{O}(#1)}

\newcommand{\x}{\boldsymbol{x}}
\newcommand{\X}{\boldsymbol{X}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\w}{\boldsymbol{w}}
\newcommand{\V}{\boldsymbol{V}}
\newcommand{\e}{\boldsymbol{e}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\strain}{\boldsymbol{\varepsilon}}
\newcommand{\stressc}{{\sigma}}
\newcommand{\strainc}{{\varepsilon}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\T}{\boldsymbol{T}}

\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
\newcommand{\ir}{\boldsymbol{i}_r}
\newcommand{\ith}{\boldsymbol{i}_{\theta}}
\newcommand{\iz}{\boldsymbol{i}_z}

\newcommand{\Ix}{{I_x}}
\newcommand{\Iy}{{I_y}}
\newcommand{\Iz}{{I_z}}
\newcommand{\It}{{I_t}}
\newcommand{\If}{{I}}     % for FEM
\newcommand{\Ifd}{{I_d}}  % for FEM
\newcommand{\Ifb}{{I_b}}  % for FEM
\newcommand{\setb}[1]{#1^0}    % set begin
\newcommand{\sete}[1]{#1^{-1}} % set end
\newcommand{\setl}[1]{#1^-}
\newcommand{\setr}[1]{#1^+}
\newcommand{\seti}[1]{#1^i}
\newcommand{\sequencei}[1]{\left\{ {#1}_i \right\}_{i\in\If}}

\newcommand{\basphi}{\varphi}
\newcommand{\baspsi}{\psi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\psib}{\boldsymbol{\psi}}
\newcommand{\sinL}[1]{\sin\left((#1+1)\pi\frac{x}{L}\right)}
\newcommand{\xno}[1]{x_{#1}}
\newcommand{\Xno}[1]{X_{(#1)}}
\newcommand{\yno}[1]{y_{#1}}
\newcommand{\Yno}[1]{Y_{(#1)}}
\newcommand{\xdno}[1]{\boldsymbol{x}_{#1}}

\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Integerp}{\mathbb{N}}
\newcommand{\Integer}{\mathbb{Z}}
$$




    
<!-- ------------------- main content ---------------------- -->


<title>Study Guide: Solving differential equations with finite elements</title>

<center><h1>Study Guide: Solving differential equations with finite elements</h1></center>  <!-- document title -->

<p>
<!-- author(s): Hans Petter Langtangen -->

<center>
<b>Hans Petter Langtangen</b> [1, 2]
</center>


<p>
<!-- institution(s) -->

<center>[1] <b>Center for Biomedical Computing, Simula Research Laboratory</b></center>
<center>[2] <b>Department of Informatics, University of Oslo</b></center>
<p>
<center><h4>Oct 23, 2013</h4></center> <!-- date -->
<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2>Table of contents</h2>

<p>
<a href="#fem:deq:1D:models"> Differential equation models </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec1"> Abstract differential equation </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec2"> Abstract boundary conditions </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec3"> Reminder about notation </a><br>
&nbsp; &nbsp; &nbsp; <a href="#fem:deq:1D:residual:min"> Residual-minimizing principles </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec5"> The least squares method </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec6"> The Galerkin method </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec7"> The Method of Weighted Residuals </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec8"> Terminology: test and Trial Functions </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec9"> The collocation method </a><br>
<a href="#fem:deq:1D:ex:sines"> Examples on using the principles </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec11"> The first model problem </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec12"> Boundary conditions </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec13"> The least squares method; principle </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec14"> The least squares method; equation system </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec15"> Orthogonality of the basis functions gives diagonal matrix </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec16"> Least squares method; solution </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec17"> The Galerkin method; principle </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec18"> The Galerkin method; solution </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec19"> The collocation method </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec20"> Comparison of the methods </a><br>
<a href="#___sec21"> Useful techniques </a><br>
&nbsp; &nbsp; &nbsp; <a href="#fem:deq:1D:varform"> Integration by parts </a><br>
&nbsp; &nbsp; &nbsp; <a href="#fem:deq:1D:essBC:Bfunc"> Boundary function; principles </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec24"> Boundary function; example </a><br>
&nbsp; &nbsp; &nbsp; <a href="#fem:deq:1D:varform:abstract"> Abstract notation for variational formulations </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec26"> Example on abstract notation </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec27"> Bilinear and linear forms </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec28"> The linear system associated with abstract form </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec29"> Equivalence with minimization problem </a><br>
<a href="#fem:deq:1D:varform:ex"> Examples on variational formulations </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec31"> Variable coefficient; problem </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec32"> Variable coefficient; variational formulation (1) </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec33"> Variable coefficient; variational formulation (2) </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec34"> Variable coefficient; abstract notation </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec35"> Variable coefficient; linear system </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec36"> First-order derivative in the equation and boundary condition; problem </a><br>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2>Differential equation models <a name="fem:deq:1D:models"></a></h2>

<p>
Our aim is to extend the ideas for approximating \( f \) by \( u \), or solving

<p>
$$ u = f $$


<p>
to real differential equations.

<p>
Three methods:

<p>

<ol>
<p><li> least squares</li>
<p><li> Galerkin/projection</li>
<p><li> collocation (interpolation)</li>
</ol>

Method 2 will be totally dominating!

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Abstract differential equation  <a name="___sec1"></a></h3>

<p>
$$
\begin{equation}
\mathcal{L}(u) = 0,\quad x\in\Omega  \end{equation}
$$


<p>
Examples:

<p>
$$
\begin{align}
\mathcal{L}(u) &= \frac{d^2u}{dx^2} - f(x),
\label{fem:deq:1D:L1}\\ 
\mathcal{L}(u) &= \frac{d}{dx}\left(\dfc(x)\frac{du}{dx}\right) + f(x),
\label{fem:deq:1D:L2}\\ 
\mathcal{L}(u) &= \frac{d}{dx}\left(\dfc(u)\frac{du}{dx}\right) - au + f(x),
\label{fem:deq:1D:L3}\\ 
\mathcal{L}(u) &= \frac{d}{dx}\left(\dfc(u)\frac{du}{dx}\right) + f(u,x)
\label{fem:deq:1D:L4}
\end{align}
$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Abstract boundary conditions  <a name="___sec2"></a></h3>

<p>
$$
\begin{equation}
{\cal B}_0(u)=0,\ x=0,\quad {\cal B}_1(u)=0,\ x=L
\end{equation}
$$


<p>
Examples:

<p>
$$
\begin{align}
\mathcal{B}_i(u) &= u - g,\quad &\hbox{Dirichlet condition}\\ 
\mathcal{B}_i(u) &= -\dfc \frac{du}{dx} - g,\quad &\hbox{Neumann condition}\\ 
\mathcal{B}_i(u) &= -\dfc \frac{du}{dx} - h(u-g),\quad &\hbox{Robin condition}
\end{align}
$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Reminder about notation  <a name="___sec3"></a></h3>

<p>

<ul>
 <p><li> \( \uex(x) \) is the symbol for the <em>exact</em> solution
   of \( \mathcal{L}(\uex)=0 \)</li>
 <p><li> \( u(x) \) denotes an <em>approximate</em> solution</li>
 <p><li> \( V = \hbox{span}\{ \baspsi_0(x),\ldots,\baspsi_N(x)\} \): we seek \( u\in V \)</li>
 <p><li> \( V \) has basis \( \sequencei{\baspsi} \)</li>
 <p><li> \( \If =\{0,\ldots,N\} \) is an index set</li>
 <p><li> \( u(x) = \sum_{j\in\If} c_j\baspsi_j(x) \)</li>
 <p><li> Inner product: \( (u,v) = \int_\Omega uv\dx \)</li>
 <p><li> Norm: \( ||u||=\sqrt{(u,u)} \)</li>
</ul>

<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Residual-minimizing principles <a name="fem:deq:1D:residual:min"></a></h3>

<p>

<ul>
 <p><li> When solving \( u=f \) we knew the error \( e=f-u \) and could
   use principles for minimizing the error</li>
 <p><li> When solving \( \mathcal{L}(\uex)=0 \) we do not know \( \uex \) and
   cannot work with the error \( e=\uex - u \)</li>
 <p><li> We only have the <em>error in the equation</em>: the residual \( R \)</li>
</ul>

Inserting \( u=\sum_jc_j\baspsi_j \) in \( \mathcal{L}=0 \) gives
a residual

<p>
$$
\begin{equation}
R = \mathcal{L}(u) = \mathcal{L}(\sum_j c_j \baspsi_j) \neq 0
\end{equation}
$$


<p>
Goal: minimize \( R \) wrt \( \sequencei{c} \) (and hope it makes a small \( e \) too)

<p>
$$ R=R(c_0,\ldots,c_N; x)$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>The least squares method  <a name="___sec5"></a></h3>

<p>
Idea: minimize

<p>
$$
\begin{equation}
E = ||R||^2 = (R,R) = \int_{\Omega} R^2 dx
\end{equation}
$$


<p>
Minimization wrt \( \sequencei{c} \) implies

<p>
$$
\begin{equation}
\frac{\partial E}{\partial c_i} =
\int_{\Omega} 2R\frac{\partial R}{\partial c_i} dx = 0\quad
\Leftrightarrow\quad (R,\frac{\partial R}{\partial c_i})=0,\quad
i\in\If
\label{fem:deq:1D:LS:eq1}
\end{equation}
$$


<p>
\( N+1 \) equations for \( N+1 \) unknowns \( \sequencei{c} \)

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>The Galerkin method  <a name="___sec6"></a></h3>

<p>
Idea: make \( R \) orthogonal to \( V \),

<p>
$$
\begin{equation}
(R,v)=0,\quad \forall v\in V
\label{fem:deq:1D:Galerkin0}
\end{equation}
$$


<p>
This implies

<p>
$$
\begin{equation}
(R,\baspsi_i)=0,\quad i\in\If,
\label{fem:deq:1D:Galerkin}
\end{equation}
$$


<p>
\( N+1 \) equations for \( N+1 \) unknowns \( \sequencei{c} \)

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>The Method of Weighted Residuals  <a name="___sec7"></a></h3>

<p>
Generalization of the Galerkin method: demand \( R \)
orthogonal to some space \( W \), possibly \( W\neq V \):

<p>
$$
\begin{equation}
(R,v)=0,\quad \forall v\in W
\label{fem:deq:1D:WRM0}
\end{equation}
$$


<p>
If \( \{w_0,\ldots,w_N\} \) is a basis for \( W \):

<p>
$$
\begin{equation}
(R,w_i)=0,\quad i\in\If
\label{fem:deq:1D:WRM}
\end{equation}
$$


<p>

<ul>
 <p><li> \( N+1 \) equations for \( N+1 \) unknowns \( \sequencei{c} \)</li>
 <p><li> Weighted residual with \( w_i = \partial R/\partial c_i \) gives
   least squares</li>
</ul>

<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Terminology: test and Trial Functions  <a name="___sec8"></a></h3>

<p>

<ul>
 <p><li> \( \baspsi_j \) used in \( \sum_jc_j\baspsi_j \): <em>trial function</em></li>
 <p><li> \( \baspsi_i \) or \( w_i \) used as weight in Galerkin's method: <em>test function</em></li>
</ul>

<!-- !split --><br><br><br><br><br><br><br><br>

<h3>The collocation method  <a name="___sec9"></a></h3>

<p>
Idea: demand \( R=0 \) at \( N+1 \) points

<p>
$$
\begin{equation}
R(\xno{i}; c_0,\ldots,c_N)=0,\quad i\in\If
\label{fem:deq:1D:collocation}
\end{equation}
$$


<p>
Note: The collocation method is a weighted residual method with
delta functions as weights

<p>
$$
\begin{equation}
\hbox{property of } \delta(x):\quad
\int_{\Omega} f(x)\delta (x-\xno{i}) dx = f(\xno{i}),\quad \xno{i}\in\Omega
\label{fem:deq:1D:Dirac}
\end{equation}
$$


<p>
$$ 0 = \int_\Omega R(x;c_0,\ldots,c_N)
\delta(x-\xno{i})\dx = R(\xno{i}; c_0,\ldots,c_N)$$


<p>
<center><p><img src="fig-fem/delta_func_weight.png" align="bottom" width=300></p></center>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2>Examples on using the principles <a name="fem:deq:1D:ex:sines"></a></h2>

<p>
<div class="alert alert-block alert-block alert-text-normal"><b>Goal.</b>
Exemplify the least squares, Galerkin, and collocation methods
in a simple 1D problem with global basis functions.
</div>
<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>The first model problem  <a name="___sec11"></a></h3>

<p>
$$
\begin{equation}
-u''(x) = f(x),\quad x\in\Omega=[0,L],\quad u(0)=0,\ u(L)=0
\label{fem:deq:1D:model1b}
\end{equation}
$$


<p>
Basis functions:

<p>
$$
\begin{equation}
\baspsi_i(x) = \sinL{i},\quad i\in\If
\label{fem:deq:1D:ex:sines:psi}
\end{equation}
$$


<p>
The residual:

<p>
$$
\begin{align}
R(x;c_0,\ldots,c_N) &= u''(x) + f(x),\nonumber\\ 
&= \frac{d^2}{dx^2}\left(\sum_{j\in\If} c_j\baspsi_j(x)\right)
+ f(x),\nonumber\\ 
&= -\sum_{j\in\If} c_j\baspsi_j''(x) + f(x)
\label{fem:deq:1D:ex:sines:res}
\end{align}
$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Boundary conditions  <a name="___sec12"></a></h3>

<p>
Since \( u(0)=u(L)=0 \) we must ensure that
all \( \baspsi_i(0)=\baspsi_i(L)=0 \). Then

<p>
$$ u(0) = \sum_jc_j\baspsi_j(0) = 0,\quad u(L) = \sum_jc_j\baspsi_j(L) $$


<p>

<ul>
 <p><li> \( u \) known: Dirichlet boundary condition</li>
 <p><li> \( u' \) known: Neumann boundary condition</li>
 <p><li> Must have \( \baspsi_i=0 \) where Dirichlet conditions apply</li>
</ul>

<!-- !split --><br><br><br><br><br><br><br><br>

<h3>The least squares method; principle  <a name="___sec13"></a></h3>

<p>
$$
(R,\frac{\partial R}{\partial c_i}) = 0,\quad i\in\If
$$


<p>
$$
\begin{equation}
\frac{\partial R}{\partial c_i} =
\frac{\partial}{\partial c_i}
\left(\sum_{j\in\If} c_j\baspsi_j''(x) + f(x)\right)
= \baspsi_i''(x)  \end{equation}
$$


<p>
Because:
$$
\frac{\partial}{\partial c_i}\left(c_0\baspsi_0'' + c_1\baspsi_1'' + \cdots +
c_{i-1}\baspsi_{i-1}'' + c_i\baspsi_{i}'' + c_{i+1}\baspsi_{i+1}''
+ \cdots + c_N\baspsi_N'' \right) = \baspsi_{i}''
$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>The least squares method; equation system  <a name="___sec14"></a></h3>

<p>
$$
\begin{equation}
(\sum_j c_j \baspsi_j'' + f,\baspsi_i'')=0,\quad i\in\If,
\end{equation}
$$


<p>
Rearrangement:

<p>
$$
\begin{equation}
\sum_{j\in\If}(\baspsi_i'',\baspsi_j'')c_j = -(f,\baspsi_i''),\quad i\in\If  \end{equation}
$$


<p>
This is a linear system

<p>
$$
\begin{equation*} \sum_{j\in\If}A_{i,j}c_j = b_i,\quad i\in\If,
\end{equation*}
$$

with

<p>
$$
\begin{align}
A_{i,j} &= (\baspsi_i'',\baspsi_j'')\nonumber\\ 
& = \pi^4(i+1)^2(j+1)^2L^{-4}\int_0^L \sinL{i}\sinL{j}\, dx\nonumber\\ 
&= \left\lbrace
\begin{array}{ll} {1\over2}L^{-3}\pi^4(i+1)^4 & i=j  \\ 0, & i\neq j
\end{array}\right.
\\ 
b_i &= -(f,\baspsi_i'') = (i+1)^2\pi^2L^{-2}\int_0^Lf(x)\sinL{i}\, dx
\end{align}
$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Orthogonality of the basis functions gives diagonal matrix  <a name="___sec15"></a></h3>

<p>
Useful property:

<p>
$$
\begin{equation}
\int\limits_0^L \sinL{i}\sinL{j}\, dx = \delta{ij},\quad
\Rightarrow (\baspsi_i'',\baspsi_j'') = \delta_{ij},
\quad\delta_{ij} = \left\lbrace
\begin{array}{ll} \half L & i=j  \\ 0, & i\neq j
\end{array}\right.
\end{equation}
$$


<p>
With diagonal \( A_{i,j} \) we can easily solve for \( c_i \):

<p>
$$
\begin{equation}
c_i = \frac{2L}{\pi^2(i+1)^2}\int_0^Lf(x)\sinL{i}\, dx
\label{fem:deq:1D:ex:sines:solution}
\end{equation}
$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Least squares method; solution  <a name="___sec16"></a></h3>

<p>
Let's <code>sympy</code> do the work (\( f(x)=2 \)):

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span>

i, j <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;i j&#39;</span>, integer<span style="color: #666666">=</span><span style="color: #008000">True</span>)
x, L <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;x L&#39;</span>)
f <span style="color: #666666">=</span> <span style="color: #666666">2</span>
a <span style="color: #666666">=</span> <span style="color: #666666">2*</span>L<span style="color: #666666">/</span>(pi<span style="color: #666666">**2*</span>(i<span style="color: #666666">+1</span>)<span style="color: #666666">**2</span>)
c_i <span style="color: #666666">=</span> a<span style="color: #666666">*</span>integrate(f<span style="color: #666666">*</span>sin((i<span style="color: #666666">+1</span>)<span style="color: #666666">*</span>pi<span style="color: #666666">*</span>x<span style="color: #666666">/</span>L), (x, <span style="color: #666666">0</span>, L))
c_i <span style="color: #666666">=</span> simplify(c_i)
<span style="color: #008000; font-weight: bold">print</span> c_i
</pre></div>
<p>
$$
\begin{equation*}
c_i = 4 \frac{L^{2} \left(\left(-1\right)^{i} + 1\right)}{\pi^{3}
\left(i^{3} + 3 i^{2} + 3 i + 1\right)}
\end{equation*}
$$


<p>
$$
\begin{equation}
u(x) = \sum_{k=0}^{N/2} \frac{8L^2}{\pi^3(2k+1)^3}\sinL{2k}\tp  \end{equation}
$$


<p>

<ul>
 <p><li> Fast decay: \( c_2 = c_0/27 \), \( c_4=c_0/125 \)</li>
 <p><li> Only one term might be good enough</li>
</ul>

$$
\begin{equation*} u(x) \approx \frac{8L^2}{\pi^3}\sin\left(\pi\frac{x}{L}\right)\tp  \end{equation*}
$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>The Galerkin method; principle  <a name="___sec17"></a></h3>

<p>
$$
\begin{equation*}
(u''+f,v)=0,\quad \forall v\in V,
\end{equation*}
$$

or

<p>
$$
\begin{equation}
(u'',v) = -(f,v),\quad\forall v\in V  \end{equation}
$$


<p>
This is a <em>variational formulation</em> of the differential equation problem.

<p>
\( \forall v\in V \) means for all basis functions:

<p>
$$
\begin{equation}
(\sum_{j\in\If} c_j\baspsi_j'', \baspsi_i)=-(f,\baspsi_i),\quad i\in\If  \end{equation}
$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>The Galerkin method; solution  <a name="___sec18"></a></h3>

<p>
Since \( \baspsi_i''\propto \baspsi_i \),
Galerkin's method gives the same linear system and the same solution
as the least squares method (in this particular example).

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>The collocation method  <a name="___sec19"></a></h3>

<p>
\( R=0 \) or the differential equation must be satisfied at \( N+1 \) points:

<p>
$$
\begin{equation}
-\sum_{j\in\If} c_j\baspsi_j''(\xno{i}) = f(\xno{i}),\quad i\in\If
\end{equation}
$$


<p>
This is a linear system \( \sum_j A_{i,j}=b_i \) with entries

<p>
$$
\begin{equation*} A_{i,j}=-\baspsi_j''(\xno{i})=
(j+1)^2\pi^2L^{-2}\sin\left((j+1)\pi \frac{x_i}{L}\right),
\quad b_i=2
\end{equation*}
$$


<p>
Choose: \( N=0 \), \( x_0=L/2 \)

<p>
$$ c_0=2L^2/\pi^2 $$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Comparison of the methods  <a name="___sec20"></a></h3>

<p>

<ul>
 <p><li> Exact solution: \( u(x)=x(L-x) \)</li>
 <p><li> Galerkin or least squares (\( N=0 \)): \( u(x)=8L^2\pi^{-3}\sin (\pi x/L) \)</li>
 <p><li> Collocation method (\( N=0 \)): \( u(x)=2L^2\pi^{-2}\sin (\pi x/L) \).</li>
 <p><li> Max error in Galerkin/least sq.: \( -0.008L^2 \)</li>
 <p><li> Max error in collocation: \( 0.047L^2 \)</li>
</ul>

<!-- !split --><br><br><br><br><br><br><br><br>

<h2>Useful techniques  <a name="___sec21"></a></h2>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Integration by parts <a name="fem:deq:1D:varform"></a></h3>

<p>
Second-order derivatives will hereafter be integrated by parts

<p>
$$
\begin{align}
\int_0^L u''(x)v(x) dx &= - \int_0^Lu'(x)v'(x)dx
+ [vu']_0^L\nonumber\\ 
&= - \int_0^Lu'(x)v'(x) dx
+ u'(L)v(L) - u'(0)v(0)
\label{fem:deq:1D:intbyparts}
\end{align}
$$


<p>
Motivation:

<p>

<ul>
 <p><li> Lowers the order of derivatives</li>
 <p><li> Gives more symmetric forms (incl. matrices)</li>
 <p><li> Enables easy handling of Neumann boundary conditions</li>
 <p><li> Finite element basis functions \( \basphi_i \) have discontinuous
   derivatives (at cell boundaries) and are not suited for
   terms with \( \basphi_i'' \)</li>
</ul>

<h3>Boundary function; principles <a name="fem:deq:1D:essBC:Bfunc"></a></h3>

<p>

<ul>
 <p><li> What about nonzero Dirichlet conditions?</li>
 <p><li> E.g. \( u(L)=D \)</li>
 <p><li> Problem: \( u(L) = \sum_j c_j\baspsi_j(L)=0 \) - always</li>
 <p><li> Remedy: \( u(x) = B(x) + \sum_j c_j\baspsi_j(x) \)</li>
 <p><li> Construct \( B \) such that \( B(0)=u(0) \), \( B(L)=u(L) \)</li>
 <p><li> No restrictions of how \( B(x) \) varies in the interior of \( \Omega \)</li>
</ul>

<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Boundary function; example  <a name="___sec24"></a></h3>

<p>
\( u(0)=C \) and \( u(L)=D \). Choose

<p>
$$ B(x) = L^{-1}(C(L-x) + Dx):\qquad B(0)=C,\ B(L)=D  $$


<p>
$$
\begin{equation}
u(x) = L^{-1}(C(L-x) + Dx) + \sum_{j\in\If} c_j\baspsi_j(x),
\label{fem:deq:1D:essBC:Bfunc:u1}
\end{equation}
$$


<p>
$$ u(0) = C,\quad u(L) = 0  $$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Abstract notation for variational formulations <a name="fem:deq:1D:varform:abstract"></a></h3>

<p>
The finite element literature (and much FEniCS documentation)
applies an abstract notation for the variational formulation:

<p>
<div class="alert alert-block alert-block alert-text-normal"><b></b>
*Find \( (u-B)\in V \) such that
$$ a(u,v) = L(v)\quad \forall v\in V $$
</div>
<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Example on abstract notation  <a name="___sec26"></a></h3>

<p>
Given a variational formulation for \( -u''=f \):

<p>
$$
\int_{\Omega} u' v'dx = \int_{\Omega} fvdx\quad\hbox{or}\quad (u',v') = (f,v)
\quad\forall v\in V
$$


<p>
Abstract formulation: finn \( (u-B)\in V \) such that

<p>
$$ a(u,v) = L(v)\quad \forall v\in V$$


<p>
We identify

<p>
$$ a(u,v) = (u',v'),\quad L(v) = (f,v)  $$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Bilinear and linear forms  <a name="___sec27"></a></h3>

<p>

<ul>
 <p><li> \( a(u,v) \) is a <em>bilinear form</em></li>
 <p><li> \( L(v) \) is a <em>linear form</em></li>
</ul>

Linear form means

<p>
$$ L(\alpha_1 v_1 + \alpha_2 v_2)
=\alpha_1 L(v_1) + \alpha_2 L(v_2),
$$


<p>
Bilinear form means
$$
\begin{align*}
a(\alpha_1 u_1 + \alpha_2 u_2, v) &= \alpha_1 a(u_1,v) + \alpha_2 a(u_2, v),
\\ 
a(u, \alpha_1 v_1 + \alpha_2 v_2) &= \alpha_1 a(u,v_1) + \alpha_2 a(u, v_2)
\end{align*}
$$


<p>
In nonlinear problems: Find \( (u-B)\in V \) such that \( F(u;v)=0\ \forall v\in V \)

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>The linear system associated with abstract form  <a name="___sec28"></a></h3>

<p>
$$ a(u,v) = L(v)\quad \forall v\in V$$


<p>
is equivalent to

<p>
$$ a(u,\baspsi_i) = L(\baspsi_i)\quad i\in\If$$


<p>
Insert \( u=\sum_jc_j\baspsi_j \) and use linearity:

<p>
$$ \sum_{j\in\If} a(\baspsi_j,\baspsi_i)c_j = L(\baspsi_i)\quad i\in\If$$


<p>
This is a linear system

<p>
$$ \sum_{j\in\If} A_{i,j}c_j=b_i,\quad i\in\If$$

with
$$
\begin{align*}
A_{i,j} &= a(\baspsi_j,\baspsi_i)\\ 
b_i &= L(\baspsi_i)
\end{align*}
$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Equivalence with minimization problem  <a name="___sec29"></a></h3>

<p>
If \( a(u,v)=a(v,u) \),

<p>
$$ a(u,v)=L(v)\quad\forall v\in V,$$


<p>
is equivalent to minimizing the functional

<p>
$$ F(v) = \frac{1}{2}a(v,v) - L(v) $$

over all functions \( v\in V \). That is,

<p>
$$ F(u)\leq F(v)\quad \forall v\in V\tp $$


<p>

<ul>
 <p><li> Much used in the early days of finite elements</li>
 <p><li> Still much used in structural analysis and elasticity</li>
 <p><li> Not as general as Galerkin's method (since \( a(u,v)=a(v,u) \))</li>
</ul>

<!-- !split --><br><br><br><br><br><br><br><br>

<h2>Examples on variational formulations <a name="fem:deq:1D:varform:ex"></a></h2>

<p>
<div class="alert alert-block alert-block alert-text-normal"><b>Goal.</b>
Derive variational formulations for many prototype differential
equations in 1D that include

<p>

<ul>
 <p><li> variable coefficints</li>
 <p><li> mixed Dirichlet and Neumann conditions</li>
 <p><li> nonlinear coefficients</li>
</ul>
</div>
<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Variable coefficient; problem  <a name="___sec31"></a></h3>

<p>
$$
\begin{equation}
-\frac{d}{dx}\left( \dfc(x)\frac{du}{dx}\right) = f(x),\quad x\in\Omega =[0,L],\ 
u(0)=C,\ u(L)=D\tp
\end{equation}
$$


<p>

<ul>
 <p><li> Variable coefficient \( \dfc(x) \)</li>
 <p><li> <em>Nonzero</em> Dirichlet conditions at \( x=0 \) <em>and</em> \( x=L \)</li>
 <p><li> Must have \( \baspsi_i(0)=\baspsi_i(L)=0 \)</li>
 <p><li> \( V = \hbox{span}\{\baspsi_0,\ldots,\baspsi_N\} \)</li>
 <p><li> \( v\in V \): \( v(0)=v(L)=0 \)</li>
</ul>

$$
u(x) = B(x) + \sum_{j\in\If} c_j\baspsi_i(x)
$$


<p>
$$ B(x) = C + \frac{1}{L}(D-C)x$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Variable coefficient; variational formulation (1)  <a name="___sec32"></a></h3>

<p>
$$ R = -\frac{d}{dx}\left( a\frac{du}{dx}\right) -f $$


<p>
Galerkin's method:

<p>
$$
(R, v) = 0,\quad \forall v\in V,
$$


<p>
or with integrals:

<p>
$$
\int_{\Omega} \left(\frac{d}{dx}\left( \dfc\frac{du}{dx}\right) -f\right)v \dx = 0,\quad \forall v\in V \tp
$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Variable coefficient; variational formulation (2)  <a name="___sec33"></a></h3>

<p>
Integration by parts:

<p>
$$ -\int_{\Omega} \frac{d}{dx}\left( \dfc(x)\frac{du}{dx}\right) v \dx
= \int_{\Omega} \dfc(x)\frac{du}{dx}\frac{dv}{dx}\dx -
\left[\dfc\frac{du}{dx}v\right]_0^L
\tp
$$


<p>
Boundary terms vanish since \( v(0)=v(L)=0 \)

<p>
<div class="alert alert-block alert-notice alert-text-normal"><b>Variational formulation.</b>

<p>
Find \( (u-B)\in V \) such that

<p>
$$
\int_{\Omega} \dfc(x)\frac{du}{dx}\frac{dv}{dx}dx = \int_{\Omega} f(x)vdx,\quad
\forall v\in V,
$$


<p>
Compact notation:

<p>
$$ (\dfc u',v') = (f,v),\quad \forall v\in V $$
</div>
<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Variable coefficient; abstract notation  <a name="___sec34"></a></h3>

<p>
$$ a(u,v)=L(v)\quad\forall v\in V,$$


<p>
$$ a(u,v)= (\dfc u',v'),\quad L(v)=(f,v)   $$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>Variable coefficient; linear system  <a name="___sec35"></a></h3>

<p>
\( v=\baspsi_i \) and \( u=B + \sum_jc_j\baspsi_j \):

<p>
$$
(\dfc B' + \dfc \sum_{j\in\If} c_j \baspsi_j', \baspsi_i') =
(f,\baspsi_i), \quad i\in\If \tp
$$


<p>
Reorder to form linear system:

<p>
$$ \sum_{j\in\If} (\dfc\baspsi_j', \baspsi_i')c_j  =
(f,\baspsi_i) + (a(D-C)L^{-1}, \baspsi_i'), \quad i\in\If
\tp
$$


<p>
This is \( \sum_j A_{i,j}c_j=b_i \) with

<p>
$$
\begin{align*}
A_{i,j} &= (a\baspsi_j', \baspsi_i') = \int_{\Omega} \dfc(x)\baspsi_j'(x),
\baspsi_i'(x)\dx,\\ 
b_i &= (f,\baspsi_i) + (a(D-C)L^{-1},\baspsi_i')=
\int_{\Omega} \left(f(x)\baspsi_i(x) + \dfc(x)\frac{D-C}{L}\baspsi_i'(x)\right) \dx
\tp
\end{align*}
$$


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h3>First-order derivative in the equation and boundary condition; problem  <a name="___sec36"></a></h3>

<p>
[[[

<p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

