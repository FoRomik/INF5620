<!DOCTYPE html>
<!--
Automatically generated HTML file from Doconce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Study Guide: Approximation of functions with finite elements">
<meta name="keywords" content="approximation of general vectors,Galerkin method,projection,approximation of functions,approximation by sines,collocation method (approximation),approximation collocation,Lagrange (interpolating) polynomial,sparse matrices,mass matrix,mass lumping,lumped mass matrix,numerical integration Midpoint rule,numerical integration Trapezoidal rule,numerical integration Simpson's rule,Midpoint rule,Trapezoidal rule,Simpson's rule,Gauss-Legendre quadrature,simplex elements,simplices,faces,edges,isoparametric mapping,mapping of reference cells isoparametric mapping">



<style type="text/css">
    /* bloodish style */

    body {
      font-family: Helvetica, Verdana, Arial, Sans-serif;
      color: #404040;
      background: #ffffff;
    }
    h1 { font-size: 1.8em;  color: #8A0808; }
    h2 { font-size: 1.5em;  color: #8A0808; }
    h3, h4 { color: #8A0808; }
    a { color: #8A0808; text-decoration:none; }
    tt { font-family: "Courier New", Courier; }
    
    p { text-indent: 0px; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .alert-text-small   { font-size: 80%;  }
    .alert-text-large   { font-size: 130%; }
    .alert-text-normal  { font-size: 90%;  }
    .alert {
             padding:8px 35px 8px 14px; margin-bottom:18px;
             text-shadow:0 1px 0 rgba(255,255,255,0.5);
             border:1px solid #bababa;
             -webkit-border-radius: 4px; -moz-border-radius: 4px;
             border-radius: 4px
             color: #555;
             background-color: #f8f8f8;
             background-position: 10px 5px;
             background-repeat: no-repeat;
             background-size: 38px;
             padding-left: 55px;
             width: 75%;
     }
     .alert-block {padding-top:14px; padding-bottom:14px}
     .alert-block > p, .alert-block > ul {margin-bottom:1em}
     .alert li {margin-top: 1em}
     .alert-block p+p {margin-top:5px}
     .alert-notice { background-image: url(https://doconce.googlecode.com/hg/bundled/html_images/small_gray_notice.png); }
     .alert-summary  { background-image:url(https://doconce.googlecode.com/hg/bundled/html_images/small_gray_summary.png); }
     .alert-warning { background-image: url(https://doconce.googlecode.com/hg/bundled/html_images/small_gray_warning.png); }
     .alert-question {background-image:url(https://doconce.googlecode.com/hg/bundled/html_images/small_gray_question.png); }

</style>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Why finite elements? ', 1, None, '___sec0'),
              (' Domain for flow around a dolphin ', 2, None, '___sec1'),
              (' The flow ', 2, None, '___sec2'),
              (' Basic ingredients of the finite element method ',
               2,
               None,
               '___sec3'),
              (' Our learning strategy ', 2, None, '___sec4'),
              (' Approximation set-up ', 2, None, '___sec5'),
              (' How to determine the coefficients? ', 2, None, '___sec6'),
              (' Approximation of planar vectors; problem ',
               2,
               'fem:approx:vec:plane',
               'fem:approx:vec:plane'),
              (' Approximation of planar vectors; vector space terminology ',
               2,
               None,
               '___sec8'),
              (' The least squares method; principle ', 2, None, '___sec9'),
              (' The least squares method; calculations ',
               2,
               None,
               '___sec10'),
              (' Observation for later ', 2, None, '___sec11'),
              (' The projection (or Galerkin) method ', 2, None, '___sec12'),
              (' Approximation of general vectors ',
               2,
               'fem:approx:vec:Np1dim',
               'fem:approx:vec:Np1dim'),
              (' The least squares method ', 2, None, '___sec14'),
              (' The Galerkin or projection method ', 2, None, '___sec15'),
              (' Approximation of functions ',
               1,
               'fem:approx:global',
               'fem:approx:global'),
              (' The least squares method ',
               2,
               'fem:approx:LS',
               'fem:approx:LS'),
              (' The Galerkin or projection method ', 2, None, '___sec18'),
              (' Example: linear approximation (1) ',
               2,
               'fem:approx:global:linear',
               'fem:approx:global:linear'),
              (' Example: linear approximation (2) ', 2, None, '___sec20'),
              (' Example: linear approximation (3) ', 2, None, '___sec21'),
              (' Implementation of the least squares method (1) ',
               2,
               'fem:approx:global:LS:code',
               'fem:approx:global:LS:code'),
              (' Implementation of the least squares method (2) ',
               2,
               None,
               '___sec23'),
              (' Implementation of the least squares method (3) ',
               2,
               None,
               '___sec24'),
              (' Implementation of the least squares method (4) ',
               2,
               None,
               '___sec25'),
              (' Perfect approximation; parabola approximating parabola ',
               2,
               'fem:approx:global:exact',
               'fem:approx:global:exact'),
              (' Perfect approximation; the general result ',
               2,
               None,
               '___sec27'),
              (' Perfect approximation; proof of the general result ',
               2,
               None,
               '___sec28'),
              (' Finite-precision/numerical computations ',
               2,
               'fem:approx:global:illconditioning',
               'fem:approx:global:illconditioning'),
              (' Ill-conditioning (1) ', 2, None, '___sec30'),
              (' Ill-conditioning (2) ', 2, None, '___sec31'),
              (' Fourier series approximation; problem and code ',
               2,
               'fem:approx:global:Fourier',
               'fem:approx:global:Fourier'),
              (' Fourier series approximation; plot ', 2, None, '___sec33'),
              (' Fourier series approximation; improvements ',
               2,
               None,
               '___sec34'),
              (' Fourier series approximation; final results ',
               2,
               None,
               '___sec35'),
              (' Orthogonal basis functions ', 2, None, '___sec36'),
              (' The collocation or interpolation method; ideas and math ',
               2,
               'fem:approx:global:interp',
               'fem:approx:global:interp'),
              (' The collocation or interpolation method; implementation ',
               2,
               None,
               '___sec38'),
              (' The collocation or interpolation method; approximating a parabola by linear functions ',
               2,
               None,
               '___sec39'),
              (' Lagrange polynomials; motivation and ideas ',
               2,
               'fem:approx:global:Lagrange',
               'fem:approx:global:Lagrange'),
              (' Lagrange polynomials; formula ', 2, None, '___sec41'),
              (' Lagrange polynomials; implementation ', 2, None, '___sec42'),
              (' Lagrange polynomials; successful example approximating a sine ',
               2,
               None,
               '___sec43'),
              (' Lagrange polynomials; a less successful example approximating abs ',
               2,
               None,
               '___sec44'),
              (' Lagrange polynomials; oscillatory behavior ',
               2,
               None,
               '___sec45'),
              (' Lagrange polynomials; remedy for strong oscillations ',
               2,
               None,
               '___sec46'),
              (' Lagrange polynomials; recalculation with Chebyshev nodes ',
               2,
               None,
               '___sec47'),
              (' Lagrange polynomials; less oscillations with Chebyshev nodes ',
               2,
               None,
               '___sec48'),
              (' Finite element basis functions ',
               1,
               'fem:approx:fe',
               'fem:approx:fe'),
              (' So far: basis functions have been global ',
               2,
               None,
               '___sec50'),
              (' In the finite element method we use local basis functions ',
               2,
               None,
               '___sec51'),
              (' The linear combination of hat functions is a piecewise linear function ',
               2,
               None,
               '___sec52'),
              (' Elements and nodes ',
               2,
               'fem:approx:fe:def:elements:nodes',
               'fem:approx:fe:def:elements:nodes'),
              (' Example on elements with two nodes (P1 elements) ',
               2,
               None,
               '___sec54'),
              (' Illustration of two basis functions on the mesh ',
               2,
               None,
               '___sec55'),
              (' Example on elements with three nodes (P2 elements) ',
               2,
               None,
               '___sec56'),
              (' Examples on elements with four nodes per element (P3 elements) ',
               2,
               None,
               '___sec57'),
              (' The numbering does not need to be regular from left to right ',
               2,
               None,
               '___sec58'),
              (' Interpretation of the coefficients $c_i$ ',
               2,
               None,
               '___sec59'),
              (' Properties of the basis functions ', 2, None, '___sec60'),
              (' How to construct quadratic $\\basphi_i$ (P2 elements) ',
               2,
               None,
               '___sec61'),
              (' Example on linear $\\basphi_i$ (P1 elements) ',
               2,
               None,
               '___sec62'),
              (' Example on cubic $\\basphi_i$ (P3 elements) ',
               2,
               None,
               '___sec63'),
              (' Calculating the linear system for $c_i$ ',
               1,
               'fem:approx:global:linearsystem',
               'fem:approx:global:linearsystem'),
              (' Computing a specific matrix entry $A_{2,3}$ ',
               2,
               None,
               '___sec65'),
              (' Computing a specific matrix entry $A_{2,2}$ ',
               2,
               None,
               '___sec66'),
              (' Calculating a general row in the matrix; figure ',
               2,
               None,
               '___sec67'),
              (' Calculating a general row in the matrix; details ',
               2,
               None,
               '___sec68'),
              (' Calculation of the right-hand side ', 2, None, '___sec69'),
              (' Specific example: two elements; linear system and solution ',
               2,
               None,
               '___sec70'),
              (' Specific example: two elements; plot ', 2, None, '___sec71'),
              (' Specific example: what about four elements? ',
               2,
               None,
               '___sec72'),
              (' Assembly of elementwise computations ',
               1,
               'fem:approx:fe:elementwise',
               'fem:approx:fe:elementwise'),
              (' Split the integrals into elementwise integrals ',
               2,
               None,
               '___sec74'),
              (' The element matrix ', 2, None, '___sec75'),
              (' Illustration of the matrix assembly: regularly numbered P1 elements ',
               2,
               None,
               '___sec76'),
              (' Illustration of the matrix assembly: regularly numbered P3 elements ',
               2,
               None,
               '___sec77'),
              (' Illustration of the matrix assembly: irregularly numbered P1 elements ',
               2,
               None,
               '___sec78'),
              (' Assembly of the right-hand side ', 2, None, '___sec79'),
              (' Mapping to a reference element ',
               1,
               'fem:approx:fe:mapping',
               'fem:approx:fe:mapping'),
              (' Affine mapping ', 2, None, '___sec81'),
              (' Integral transformation ', 2, None, '___sec82'),
              (' Advantages of the reference element ', 2, None, '___sec83'),
              (' Standardized basis functions for P1 elements ',
               2,
               None,
               '___sec84'),
              (' Standardized basis functions for P2 elements ',
               2,
               None,
               '___sec85'),
              (' Integration over a reference element; element matrix ',
               2,
               'fem:approx:fe:intg:ref',
               'fem:approx:fe:intg:ref'),
              (' Integration over a reference element; element vector ',
               2,
               None,
               '___sec87'),
              (" Tedious calculations! Let's use symbolic software ",
               2,
               None,
               '___sec88'),
              (' Implementation ', 1, None, '___sec89'),
              (' Compute finite element basis functions ',
               2,
               None,
               '___sec90'),
              (' Compute the element matrix ', 2, None, '___sec91'),
              (' Example on symbolic and numeric element matrix ',
               2,
               None,
               '___sec92'),
              (' Compute the element vector ', 2, None, '___sec93'),
              (' Fallback on numerical integration if symbolic integration fails ',
               2,
               None,
               '___sec94'),
              (' Linear system assembly and solution ', 2, None, '___sec95'),
              (' Linear system solution ', 2, None, '___sec96'),
              (' Example on computing approximations ', 2, None, '___sec97'),
              (' The structure of the coefficient matrix ',
               2,
               'fem:approx:fe:A:structure',
               'fem:approx:fe:A:structure'),
              (' General result: the coefficient matrix is sparse ',
               2,
               None,
               '___sec99'),
              (' Exemplifying the sparsity for P2 elements ',
               2,
               None,
               '___sec100'),
              (' Matrix sparsity pattern for regular/random numbering of P1 elements ',
               2,
               None,
               '___sec101'),
              (' Matrix sparsity pattern for regular/random numbering of P3 elements ',
               2,
               None,
               '___sec102'),
              (' Sparse matrix storage and solution ',
               2,
               'fem:approx:fe:impl:sparse',
               'fem:approx:fe:impl:sparse'),
              (' Approximate $f\\sim x^9$ by various elements; code ',
               2,
               None,
               '___sec104'),
              (' Approximate $f\\sim x^9$ by various elements; plot ',
               2,
               None,
               '___sec105'),
              (' Comparison of finite element and finite difference approximation ',
               1,
               'fem:approx:fe:fd',
               'fem:approx:fe:fd'),
              (' Interpolation/collocation with finite elements ',
               2,
               None,
               '___sec107'),
              (' Finite difference interpretation of a finite element approximation ',
               2,
               None,
               '___sec108'),
              (' Making finite elements behave as finite differences ',
               2,
               None,
               '___sec109'),
              (' A generalized element concept ',
               1,
               'fem:approx:fe:element',
               'fem:approx:fe:element'),
              (' The concept of a finite element ', 3, None, '___sec111'),
              (' Implementation ',
               2,
               'fem:approx:fe:element:impl',
               'fem:approx:fe:element:impl'),
              (' Example on doing the algorithmic steps ',
               2,
               None,
               '___sec113'),
              (' Approximating a parabola by P0 elements ',
               2,
               None,
               '___sec114'),
              (' Computing the error of the approximation ',
               2,
               'fem:approx:fe:element:impl:error',
               'fem:approx:fe:element:impl:error'),
              (' How does the error depend on $h$ and $d$? ',
               2,
               None,
               '___sec116'),
              (' Cubic Hermite polynomials; definition ',
               2,
               None,
               '___sec117'),
              (' Cubic Hermite polynomials; derivation ',
               2,
               None,
               '___sec118'),
              (' Numerical integration ', 1, None, '___sec119'),
              (' Newton-Cotes rules ',
               2,
               'fem:approx:fe:numint1',
               'fem:approx:fe:numint1'),
              (' Gauss-Legendre rules with optimized points ',
               2,
               None,
               '___sec121'),
              (' Approximation of functions in 2D ',
               1,
               'fem:approx:2D',
               'fem:approx:2D'),
              (' Constructing 2D basis functions from 1D functions ',
               3,
               None,
               '___sec123'),
              (' Finite elements in 2D and 3D ', 1, None, '___sec124'),
              (' Basis functions over triangles in the physical domain ',
               2,
               None,
               '___sec125'),
              (' Element matrices and vectors ', 3, None, '___sec126'),
              (' Basis functions over triangles in the reference cell ',
               2,
               None,
               '___sec127'),
              (' Affine mapping of the reference cell ',
               2,
               None,
               '___sec128'),
              (' Isoparametric mapping of the reference cell ',
               2,
               None,
               '___sec129'),
              (' Computing integrals ', 2, None, '___sec130')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">


<!-- newcommands_keep.tex -->
$$
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\uexd}[1]{{u_{\small\mbox{e}, #1}}}
\newcommand{\vex}{{v_{\small\mbox{e}}}}
\newcommand{\vexd}[1]{{v_{\small\mbox{e}, #1}}}
\newcommand{\Aex}{{A_{\small\mbox{e}}}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\halfi}{{1/2}}
\newcommand{\tp}{\thinspace .}

\newcommand{\Ddt}[1]{\frac{D #1}{dt}}
\newcommand{\E}[1]{\hbox{E}\lbrack #1 \rbrack}
\newcommand{\Var}[1]{\hbox{Var}\lbrack #1 \rbrack}
\newcommand{\Std}[1]{\hbox{Std}\lbrack #1 \rbrack}

\newcommand{\xpoint}{\boldsymbol{x}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\Oof}[1]{\mathcal{O}(#1)}

\newcommand{\x}{\boldsymbol{x}}
\newcommand{\X}{\boldsymbol{X}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\w}{\boldsymbol{w}}
\newcommand{\V}{\boldsymbol{V}}
\newcommand{\e}{\boldsymbol{e}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\strain}{\boldsymbol{\varepsilon}}
\newcommand{\stressc}{{\sigma}}
\newcommand{\strainc}{{\varepsilon}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\T}{\boldsymbol{T}}

% Unit vectors
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
\newcommand{\ir}{\boldsymbol{i}_r}
\newcommand{\ith}{\boldsymbol{i}_{\theta}}
\newcommand{\iz}{\boldsymbol{i}_z}

% Index sets
\newcommand{\Ix}{\mathcal{I}_x}
\newcommand{\Iy}{\mathcal{I}_y}
\newcommand{\Iz}{\mathcal{I}_z}
\newcommand{\It}{\mathcal{I}_t}
%\newcommand{\If}{\mathcal{I}}     % for FEM
\newcommand{\If}{I}     % for FEM
%\newcommand{\Ifd}{\mathcal{I}_d}  % for FEM
\newcommand{\Ifd}{I_d}  % for FEM
\newcommand{\setb}[1]{#1^0}    % set begin
\newcommand{\sete}[1]{#1^{-1}} % set end
%\newcommand{\setl}[1]{#1\setminus\{\set1{#1}\}}
%\newcommand{\setr}[1]{#1\setminus\{\set0{#1}\}}
%\newcommand{\seti}[1]{#1\setminus\{\set0{#1},\set1{#1}\}}
\newcommand{\setl}[1]{#1^-}
\newcommand{\setr}[1]{#1^+}
\newcommand{\seti}[1]{#1^i}
\newcommand{\sequencei}[1]{\left\{ {#1}_i \right\}_{i\in\If}}

% Finite elements
\newcommand{\basphi}{\varphi}
\newcommand{\baspsi}{\psi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\psib}{\boldsymbol{\psi}}
\newcommand{\sinL}[1]{\sin\left((#1+1)\pi\frac{x}{L}\right)}
\newcommand{\xno}[1]{x_{#1}}
%\newcommand{\xno}[1]{x^{(#1)}}
\newcommand{\Xno}[1]{X_{(#1)}}
\newcommand{\yno}[1]{y_{#1}}
\newcommand{\Yno}[1]{Y_{(#1)}}
\newcommand{\xdno}[1]{\boldsymbol{x}_{#1}}

% FEniCS commands
\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Integerp}{\mathbb{N}}
\newcommand{\Integer}{\mathbb{Z}}
$$




    
<a name="part0110"></a>
<!-- begin top navigation -->
<a href="._part0109_lecture_fem_approx.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="previous"></a>

<a href="._part0111_lecture_fem_approx.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end top navigation -->

<p>
<!-- !split -->

<h2>A generalized element concept <a name="fem:approx:fe:element"></a></h2>

<p>
So far,

<p>

<ul>
 <p><li> <em>Nodes</em>: points for defining \( \basphi_i \) and compute \( u \) values</li>
 <p><li> <em>Elements</em>: subdomain (containing some nodes)</li>
 <p><li> This is a common notion of nodes and elements.</li>
</ul>

An extended and generalized element concept:

<p>

<ul>
 <p><li> An <em>element</em> is the collection of the subdomain (previous "element"),
   points where we seek function values, basis functions, numberings,
   mappings, etc.</li>
 <p><li> We introduce <em>cell</em> for the subdomain that we up to now called element.</li>
 <p><li> A cell has <em>vertices</em> (interval end points).</li>
 <p><li> <em>Nodes</em> are, almost as before,
   points where we want to compute unknown functions.</li>
 <p><li> <em>Degrees of freedom</em> is what the \( c_j \) represent (usually function values
   at nodes).</li>
</ul>

<h4>The concept of a finite element  <a name="___sec111"></a></h4>

<p>

<ul>
  <p><li> a <em>reference cell</em> in a local reference coordinate system;</li>
  <p><li> a set of <em>basis functions</em> \( \refphi_i \) defined on the cell;</li>
  <p><li> a set of <em>degrees of freedom</em> that uniquely determine
    the basis functions such that \( \refphi_i=1 \) for degree of freedom
    number \( i \) and \( \refphi_i=0 \) for all other degrees of freedom;</li>
  <p><li> a mapping between local and global degree of freedom numbers (<em>dof map</em>);</li>
  <p><li> a geometric <em>mapping</em> of the reference cell onto to cell in the physical
    domain.</li>
</ul>

<h3>Implementation <a name="fem:approx:fe:element:impl"></a></h3>

<p>

<ul>
  <p><li> We introduce <code>vertices</code> to equal <code>nodes</code> for P1 elements</li>
  <p><li> We introduce <code>cells</code> such that <code>cell[e][r]</code> gives the mapping
    from local vertex <code>r</code> in cell <code>e</code> to the global vertex number
    in <code>vertices</code>.</li>
  <p><li> We replace <code>elements</code> by <code>dof_map</code> (the contents are the same
    for P$d$ elements).</li>
</ul>

Example: \( \Omega =[0,1] \) is divided into two cells,
\( \Omega^{(0)}=[0,0.4] \) and \( \Omega^{(1)}=[0.4,1] \).
Define P2 elements in each cell.

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">vertices <span style="color: #666666">=</span> [<span style="color: #666666">0</span>, <span style="color: #666666">0.4</span>, <span style="color: #666666">1</span>]
cells <span style="color: #666666">=</span> [[<span style="color: #666666">0</span>, <span style="color: #666666">1</span>], [<span style="color: #666666">1</span>, <span style="color: #666666">2</span>]]
dof_map <span style="color: #666666">=</span> [[<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">2</span>], [<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>]]
</pre></div>
<p>
Example: \( u \) is piecewise constant in each cell (P0 element).
Same <code>vertices</code> and <code>cells</code>, but

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">dof_map <span style="color: #666666">=</span> [[<span style="color: #666666">0</span>], [<span style="color: #666666">1</span>], [<span style="color: #666666">2</span>]]
</pre></div>
<p>
May think of nodes in the middle of each element.

<p>
The assembly process must now use the <code>dof_map</code> (no <code>elements</code> data
structure anymore):

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">A[dof_map[e][r], dof_map[e][s]] <span style="color: #666666">+=</span> A_e[r,s]
b[dof_map[e][r]] <span style="color: #666666">+=</span> b_e[r]
</pre></div>
<p>
We will hereafter work with <code>cells</code>, <code>vertices</code>, and <code>dof_map</code>.

<h3>Example on doing the algorithmic steps  <a name="___sec113"></a></h3>

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">fe_approx1D_numint</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>

x <span style="color: #666666">=</span> sm<span style="color: #666666">.</span>Symbol(<span style="color: #BA2121">&#39;x&#39;</span>)
f <span style="color: #666666">=</span> x<span style="color: #666666">*</span>(<span style="color: #666666">1</span> <span style="color: #666666">-</span> x)

N_e <span style="color: #666666">=</span> <span style="color: #666666">10</span>
vertices, cells, dof_map <span style="color: #666666">=</span> mesh_uniform(N_e, d<span style="color: #666666">=3</span>, Omega<span style="color: #666666">=</span>[<span style="color: #666666">0</span>,<span style="color: #666666">1</span>])
phi <span style="color: #666666">=</span> [basis(<span style="color: #008000">len</span>(dof_map[e])<span style="color: #666666">-1</span>) <span style="color: #008000; font-weight: bold">for</span> e <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(N_e)]
A, b <span style="color: #666666">=</span> assemble(vertices, cells, dof_map, phi, f)
c <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linalg<span style="color: #666666">.</span>solve(A, b)

<span style="color: #408080; font-style: italic"># Make very fine mesh and sample u(x) on this mesh for plotting</span>
x_u, u <span style="color: #666666">=</span> u_glob(c, vertices, cells, dof_map,
                resolution_per_element<span style="color: #666666">=51</span>)
plot(x_u, u)
</pre></div>
<p>
The <code>approximate</code> function automates these steps (next slide).

<p>
<p>
<!-- begin bottom navigation -->
<a href="._part0109_lecture_fem_approx.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="previous"></a>

<a href="._part0111_lecture_fem_approx.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end bottom navigation -->

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

