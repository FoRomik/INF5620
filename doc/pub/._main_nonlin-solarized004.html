<!DOCTYPE html>
<!--
Automatically generated HTML file from Doconce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Nonlinear differential equation problems">
<meta name="keywords" content="linearization explicit time integration,Picard iteration,successive substitutions,fixed-point iteration,linearization Picard iteration,linearization successive substitutions,linearization fixed-point iteration,stopping criteria (nonlinear problems),single Picard iteration technique,relaxation (nonlinear equations),stopping criteria (nonlinear problems),group finite element method,product approximation technique,continuation method,online rendering of LaTeX formulas,continuation method">



<style type="text/css">
    /* solarized style */
    body {
      margin:5;
      padding:0;
      border:0;	/* Remove the border around the viewport in old versions of IE */
      width:100%;
      background: #fdf6e3;
      min-width:600px;	/* Minimum width of layout - remove if not required */
      font-family: Verdana, Helvetica, Arial, sans-serif;
      font-size: 1.0em;
      line-height: 1.3em;
      color: #657b83;
    }
    a { color: #657b83; text-decoration:none; }
    a:hover { color: #b58900; background: #eee8d5; text-decoration:none; }
    h1, h2, h3 { margin:.8em 0 .2em 0; padding:0; line-height: 125%; }
    h2 { font-variant: small-caps; }
    pre {
      background: #fdf6e3;
      -webkit-box-shadow: inset 0 0 2px #000000;
      -moz-box-shadow: inset 0 0 2px #000000;
      box-shadow: inset 0 0 2px #000000;
      color: #586e75;
      margin-left: 0px;
      font-family: 'Droid Sans Mono', monospace;
      padding: 2px;
      -webkit-border-radius: 4px;
      -moz-border-radius: 4px;
      border-radius: 4px;
      -moz-background-clip: padding;
      -webkit-background-clip: padding-box;
      background-clip: padding-box;
    }
    tt { font-family: "Courier New", Courier; }
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p { text-indent: 0px; }
    p.caption { width: 80%; font-style: normal; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .alert-text-small   { font-size: 80%;  }
    .alert-text-large   { font-size: 130%; }
    .alert-text-normal  { font-size: 90%;  }
    .alert {
             padding:8px 35px 8px 14px; margin-bottom:18px;
             text-shadow:0 1px 0 rgba(255,255,255,0.5);
             border:1px solid #FFBF00;
             -webkit-border-radius: 4px; -moz-border-radius: 4px;
             border-radius: 4px
             color: #555;
             background-color: #fbeed5;
             background-position: 10px 5px;
             background-repeat: no-repeat;
             background-size: 38px;
             padding-left: 55px;
             width: 75%;
     }
     .alert-block {padding-top:14px; padding-bottom:14px}
     .alert-block > p, .alert-block > ul {margin-bottom:1em}
     .alert li {margin-top: 1em}
     .alert-block p+p {margin-top:5px}
     .alert-notice { background-image: url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
     .alert-summary  { background-image:url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
     .alert-warning { background-image: url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
     .alert-question {background-image:url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

</style>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Basic examples using the logistic equation ',
               1,
               'nonlin:timediscrete:logistic',
               'nonlin:timediscrete:logistic'),
              (' Linearization by explicit time discretization ',
               2,
               'nonlin:timediscrete:logistic:FE',
               'nonlin:timediscrete:logistic:FE'),
              (' Exact solution of nonlinear equations ',
               2,
               'nonlin:timediscrete:logistic:roots',
               'nonlin:timediscrete:logistic:roots'),
              (' Linearization ', 2, None, '___sec3'),
              (' Picard iteration ',
               2,
               'nonlin:timediscrete:logistic:Picard',
               'nonlin:timediscrete:logistic:Picard'),
              (' Stopping criteria ', 3, None, '___sec5'),
              (' A single Picard iteration ', 3, None, '___sec6'),
              (' Linearization by a geometric mean ',
               2,
               'nonlin:timediscrete:logistic:geometric:mean',
               'nonlin:timediscrete:logistic:geometric:mean'),
              (" Newton's method ",
               2,
               'nonlin:timediscrete:logistic:Newton',
               'nonlin:timediscrete:logistic:Newton'),
              (' Relaxation ',
               2,
               'nonlin:timediscrete:logistic:relaxation',
               'nonlin:timediscrete:logistic:relaxation'),
              (' Implementation and experiments ', 2, None, '___sec10'),
              (' Generalization to a general nonlinear ODE ',
               2,
               'nonlin:ode:generic',
               'nonlin:ode:generic'),
              (' Explicit time discretization ', 3, None, '___sec12'),
              (' Backward Euler discretization ', 3, None, '___sec13'),
              (' Crank-Nicolson discretization ', 3, None, '___sec14'),
              (' Systems of nonlinear algebraic equations ',
               1,
               'nonlin:systems:alg',
               'nonlin:systems:alg'),
              (' Picard iteration ',
               2,
               'nonlin:systems:alg:Picard',
               'nonlin:systems:alg:Picard'),
              (" Newton's method ",
               2,
               'nonlin:systems:alg:Newton',
               'nonlin:systems:alg:Newton'),
              (' Stopping criteria ',
               2,
               'nonlin:systems:alg:terminate',
               'nonlin:systems:alg:terminate'),
              (' Example: A nonlinear ODE model from epidemiology ',
               2,
               'nonlin:systems:alg:SI',
               'nonlin:systems:alg:SI'),
              (' Implicit time discretization ', 3, None, '___sec20'),
              (' A Picard iteration ', 3, None, '___sec21'),
              (" Newton's method ", 3, None, '___sec22'),
              (' Linearization at the differential equation level ',
               1,
               'nonlin:pdelevel',
               'nonlin:pdelevel'),
              (' Explicit time integration ',
               2,
               'nonlin:pdelevel:explicit',
               'nonlin:pdelevel:explicit'),
              (' Picard iteration ',
               2,
               'nonlin:pdelevel:Picard',
               'nonlin:pdelevel:Picard'),
              (" Newton's method ",
               2,
               'nonlin:pdelevel:Newton',
               'nonlin:pdelevel:Newton'),
              (' Discretization of nonlinear differential equations ',
               1,
               'nonlin:alglevel:1D',
               'nonlin:alglevel:1D'),
              (' Finite difference discretizations ',
               2,
               'nonlin:alglevel:1D:fd',
               'nonlin:alglevel:1D:fd'),
              (' Discretization ', 3, None, '___sec29'),
              (' Solution of algebraic equations ', 3, None, '___sec30'),
              (' Finite element discretizations ',
               2,
               'nonlin:alglevel:1D:fe',
               'nonlin:alglevel:1D:fe'),
              (' Remark ', 3, None, '___sec32'),
              (' The group finite element method ',
               2,
               'nonlin:alglevel:1D:fe:group',
               'nonlin:alglevel:1D:fe:group'),
              (' Finite element notation ', 3, None, '___sec34'),
              (' Integrating nonlinear functions ', 3, None, '___sec35'),
              (' Finite element approximation of functions of $u$ ',
               3,
               None,
               '___sec36'),
              (' Application ', 3, None, '___sec37'),
              (' Numerical integration of nonlinear terms ',
               2,
               'nonlin:alglevel:1D:fe:f',
               'nonlin:alglevel:1D:fe:f'),
              (' Finite element discretization of a variable coefficient Laplace term ',
               2,
               'nonlin:alglevel:1D:fe:Laplace',
               'nonlin:alglevel:1D:fe:Laplace'),
              (' Picard iteration defined from the variational form ',
               2,
               'nonlin:alglevel:1D:fe:Picard',
               'nonlin:alglevel:1D:fe:Picard'),
              (" Newton's method defined from the variational form ",
               2,
               'nonlin:alglevel:1D:fe:Newton',
               'nonlin:alglevel:1D:fe:Newton'),
              (' Dirichlet conditions ', 3, None, '___sec42'),
              (' Multi-dimensional PDE problems ', 1, None, '___sec43'),
              (' Finite element discretization ', 2, None, '___sec44'),
              (' Finite difference discretization ', 2, None, '___sec45'),
              (' Continuation methods ', 2, None, '___sec46'),
              (' Exercises ', 1, 'nonlin:exer', 'nonlin:exer'),
              (' Problem 1: Determine if equations are nonlinear or not ',
               2,
               'nonlin:exer:lin:vs:nonlin',
               'nonlin:exer:lin:vs:nonlin'),
              (' Problem 2: Linearize a nonlinear vibration ODE ',
               2,
               'nonlin:exer:vib:geometric:mean',
               'nonlin:exer:vib:geometric:mean'),
              (' Exercise 3: Find the sparsity of the Jacobian ',
               2,
               'nonlin:exer:sparsity:Jacobian',
               'nonlin:exer:sparsity:Jacobian'),
              (" Exercise 4: Newton's method for linear problems ",
               2,
               'nonlin:exer:Newton:linear',
               'nonlin:exer:Newton:linear'),
              (' Exercise 5: Differentiate a highly nonlinear term ',
               2,
               'nonlin:exer:grad:pow:term',
               'nonlin:exer:grad:pow:term'),
              (' Problem 6: Discretize a 1D problem with a nonlinear coefficient ',
               2,
               'nonlin:exer:1D:1pu2:fem',
               'nonlin:exer:1D:1pu2:fem'),
              (' Problem 7: Linearize a 1D problem with a nonlinear coefficient ',
               2,
               'nonlin:exer:1D:1pu2:PicardNewton',
               'nonlin:exer:1D:1pu2:PicardNewton'),
              (' Problem 8: Finite differences for the 1D Bratu problem ',
               2,
               'nonlin:exer:1D:fu:discretize:fd',
               'nonlin:exer:1D:fu:discretize:fd'),
              (' Problem 9: Integrate functions of finite element expansions ',
               2,
               'nonlin:exer:fu:fem:int',
               'nonlin:exer:fu:fem:int'),
              (' Problem 10: Finite elements for the 1D Bratu problem ',
               2,
               'nonlin:exer:1D:fu:discretize:fe',
               'nonlin:exer:1D:fu:discretize:fe'),
              (' Problem 11: Derive the Newton system from a variational form ',
               2,
               'nonlin:exer:dD:heat:nonlinear:c:a',
               'nonlin:exer:dD:heat:nonlinear:c:a'),
              (' Problem 12: Derive algebraic equations for nonlinear 1D heat conduction ',
               2,
               'nonlin:exer:1D:heat:nonlinear:c:a',
               'nonlin:exer:1D:heat:nonlinear:c:a'),
              (' Problem 13: Investigate a 1D problem with a continuation method ',
               2,
               'nonlin:exer:continuation:1DnNflow',
               'nonlin:exer:continuation:1DnNflow'),
              (' Bibliography ', 1, None, '___sec61')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">


<!-- newcommands_keep.tex -->
$$
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\uexd}[1]{{u_{\small\mbox{e}, #1}}}
\newcommand{\vex}{{v_{\small\mbox{e}}}}
\newcommand{\vexd}[1]{{v_{\small\mbox{e}, #1}}}
\newcommand{\Aex}{{A_{\small\mbox{e}}}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\halfi}{{1/2}}
\newcommand{\tp}{\thinspace .}

\newcommand{\Ddt}[1]{\frac{D #1}{dt}}
\newcommand{\E}[1]{\hbox{E}\lbrack #1 \rbrack}
\newcommand{\Var}[1]{\hbox{Var}\lbrack #1 \rbrack}
\newcommand{\Std}[1]{\hbox{Std}\lbrack #1 \rbrack}

\newcommand{\xpoint}{\boldsymbol{x}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\Oof}[1]{\mathcal{O}(#1)}

\newcommand{\x}{\boldsymbol{x}}
\newcommand{\X}{\boldsymbol{X}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\w}{\boldsymbol{w}}
\newcommand{\V}{\boldsymbol{V}}
\newcommand{\e}{\boldsymbol{e}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\strain}{\boldsymbol{\varepsilon}}
\newcommand{\stressc}{{\sigma}}
\newcommand{\strainc}{{\varepsilon}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\T}{\boldsymbol{T}}

\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
\newcommand{\ir}{\boldsymbol{i}_r}
\newcommand{\ith}{\boldsymbol{i}_{\theta}}
\newcommand{\iz}{\boldsymbol{i}_z}

\newcommand{\Ix}{\mathcal{I}_x}
\newcommand{\Iy}{\mathcal{I}_y}
\newcommand{\Iz}{\mathcal{I}_z}
\newcommand{\It}{\mathcal{I}_t}
\newcommand{\If}{\mathcal{I}_s}     % for FEM
\newcommand{\Ifd}{{I_d}}  % for FEM
\newcommand{\Ifb}{{I_b}}  % for FEM
\newcommand{\setb}[1]{#1^0}    % set begin
\newcommand{\sete}[1]{#1^{-1}} % set end
\newcommand{\setl}[1]{#1^-}
\newcommand{\setr}[1]{#1^+}
\newcommand{\seti}[1]{#1^i}
\newcommand{\sequencei}[1]{\left\{ {#1}_i \right\}_{i\in\If}}

\newcommand{\basphi}{\varphi}
\newcommand{\baspsi}{\psi}
\newcommand{\refphi}{\tilde\basphi}
\newcommand{\psib}{\boldsymbol{\psi}}
\newcommand{\sinL}[1]{\sin\left((#1+1)\pi\frac{x}{L}\right)}
\newcommand{\xno}[1]{x_{#1}}
\newcommand{\Xno}[1]{X_{(#1)}}
\newcommand{\yno}[1]{y_{#1}}
\newcommand{\Yno}[1]{Y_{(#1)}}
\newcommand{\xdno}[1]{\boldsymbol{x}_{#1}}

\newcommand{\dX}{\, \mathrm{d}X}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Integerp}{\mathbb{N}}
\newcommand{\Integer}{\mathbb{Z}}
$$




    
<a name="part0004"></a>
<!-- begin top navigation -->
<a href="._main_nonlin-solarized003.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="previous"></a>

<a href="._main_nonlin-solarized005.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end top navigation -->

<p>
<!-- !split -->

<h2>Multi-dimensional PDE problems  <a name="___sec43"></a></h2>

<h3>Finite element discretization  <a name="___sec44"></a></h3>

<p>
The derivation of \( F_i \) and \( J_{i,j} \) in the 1D model problem
is easily generalized to multi-dimensional problems.
For example, Backward Euler discretization of the
PDE

<p>
$$ u_t = \nabla\cdot(\dfc(u)\nabla u) + f(u),$$

gives the nonlinear time-discrete PDEs

<p>
$$ u^n - \Delta t\nabla\cdot(\dfc(u^n)\nabla u^n) + f(u^n) = u^{n-1},$$

or with \( u^n \) simply as \( u \) and \( u^{n-1} \) as \( u_1 \),

<p>
$$ u - \Delta t\nabla\cdot(\dfc(u^n)\nabla u) - \Delta t f(u) = u_1\tp$$

The variational form, assuming homogeneous Neumann conditions
for simplicity, becomes

<p>
$$
\begin{equation}
\int_\Omega (uv + \Delta t\dfc(u)\nabla u\cdot\nabla v
- \Delta t f(u)v - u_1v)\dx\tp
\tag{40}
\end{equation}
$$

The nonlinear algebraic equations follow from setting \( v=\baspsi_i \)
and using the representation \( u=\sum_kc_k\baspsi_k \), which we
just write as

<p>
$$
\begin{equation}
F_i =
\int_\Omega (u\baspsi_i + \Delta t\dfc(u)\nabla u\cdot\nabla \baspsi_i
- \Delta t f(u)\baspsi_i - u_1\baspsi_i)\dx\tp
\tag{41}
\end{equation}
$$

Picard iteration needs a linearization where we use
the most recent approximation \( u_{-} \) to \( u \) in
\( \dfc \) and \( f \):

<p>
$$
\begin{equation}
F_i \approx \hat F_i =
\int_\Omega (u_{-}\baspsi_i + \Delta t\dfc(u_{-})\nabla u\cdot\nabla \baspsi_i
- \Delta t f(u_{-})\baspsi_i - u_1\baspsi_i)\dx\tp
\tag{42}
\end{equation}
$$

The equations \( \hat F_i=0 \) are now linear and we can easily derive
a linear system for the unknown coefficients
\( \sequencei{c} \) by inserting \( u=\sum_jc_j\baspsi_j \).

<p>
In Newton's method we need to evaluate \( F_i \) with the known value
\( u_{-} \) for \( u \):

<p>
$$
\begin{equation}
F_i \approx \hat F_i =
\int_\Omega (u_{-}\baspsi_i + \Delta t\dfc(u_{-})
\nabla u_{-}\cdot\nabla \baspsi_i
- \Delta t f(u_{-})\baspsi_i - u_1\baspsi_i)\dx\tp
\tag{43}
\end{equation}
$$

The Jacobian is obtained by differentiating
<a href="#mjx-eqn-41">(41)</a> and using \( \partial u/\partial c_j=\baspsi_j \):

<p>
$$
\begin{align}
J_{i,j} = \frac{\partial F_i}{\partial c_j} =
\int_\Omega & (\baspsi_j\baspsi_i + \Delta t\dfc'(u)\baspsi_j
\nabla u\cdot\nabla \baspsi_i +
\Delta t\dfc(u)\nabla\baspsi_j\cdot\nabla\baspsi_i - \nonumber\\ 
&\ \Delta t f'(u)\baspsi_j\baspsi_i - u_1\baspsi_i)\dx\tp
\tag{45}
\end{align}
$$

The evaluation of \( J_{i,j} \) as the coefficient matrix in the linear
system in Newton's method applies the known approximation \( u_{-} \)
for \( u \):

<p>
$$
\begin{align}
J_{i,j} =
\int_\Omega & (\baspsi_j\baspsi_i + \Delta t\dfc'(u_{-})\baspsi_j
\nabla u_{-}\cdot\nabla \baspsi_i +
\Delta t\dfc(u_{-})\nabla\baspsi_j\cdot\nabla\baspsi_i - \nonumber\\ 
&\ \Delta t f'(u_{-})\baspsi_j\baspsi_i - u_1\baspsi_i)\dx\tp
\tag{45}
\end{align}
$$

Hopefully, these example also show how convenient the notation
with \( u \) and \( u_{-} \) is: the unknown to be computed is always \( u \) and
linearization by inserting known (previously computed) values
is a matter of adding an underscore.
One can take great advantage of this quick notation in
software <a href="._main_nonlin-solarized005.html#Mortensen_et_al_2011">[2]</a>.

<h3>Finite difference discretization  <a name="___sec45"></a></h3>

<p>
A typical diffusion equation

<p>
$$ u_t = \nabla\cdot(\dfc(u)\nabla u) + f(u),$$

can be discretized by (e.g.) a Backward Euler scheme,
which in 2D can be written

<p>
$$ [D_t^- u = D_x\overline{\dfc}^xD_x u
+ D_y\overline{\dfc}^yD_y u + f(u)]_{i,j}^n\tp
$$

We do not dive into details of boundary conditions now. Dirichlet and
Neumann conditions are handled as in linear diffusion problems.

<p>
Writing the scheme out, putting the unknown values on the
left-hand side and known values on the right-hand side, and
introducing \( \Delta x=\Delta y=h \) to save some writing, one gets

<p>
$$
\begin{align*}
u^n_{i,j} &- \frac{\Delta t}{h^2}(
 \half(\dfc(u_{i,j}^n)   + \dfc(u_{i+1,j}^n))(u_{i+1,j}^n-u_{i,j}^n) -
 \half(\dfc(u_{i-1,j}^n) + \dfc(u_{i,j}^n))(u_{i,j}^n-u_{i-1,j}^n) \\ 
&+
 \half(\dfc(u_{i,j}^n)   + \dfc(u_{i,j+1}^n))(u_{i,j+1}^n-u_{i,j}^n) -
 \half(\dfc(u_{i,j-1}^n) + \dfc(u_{i,j}^n))(u_{i,j}^n-u_{i-1,j-1}^n))\\ 
&- \Delta tf(u_{i,j}^n) = u^{n-1}_{i,j}
\end{align*}
$$

This defines a nonlinear algebraic system \( A(u)u=b(u) \).
A Picard iteration applies old values \( u_{-} \) in \( \dfc \) and \( f \),
or equivalently, old values for \( u \) in \( A(u) \) and \( b(u) \).
The result is a linear system of the same type as those arising
from \( u_t = \nabla\cdot (\dfc(\x)\nabla u) + f(\x,t) \).

<p>
Newton's method is as usual more involved. We first define
the nonlinear algebraic equations to be solved, drop the
superscript \( n \), and introduce \( u_1 \) for \( u^{n-1} \):

<p>
$$
\begin{align*}
F_{i,j} &= u^n_{i,j} - \frac{\Delta t}{h^2}(\\ 
&\quad \half(\dfc(u_{i,j}^n)   + \dfc(u_{i+1,j}^n))(u_{i+1,j}^n-u_{i,j}^n) -
 \half(\dfc(u_{i-1,j}^n) + \dfc(u_{i,j}^n))(u_{i,j}^n-u_{i-1,j}^n) + \\ 
&\quad
 \half(\dfc(u_{i,j}^n)   + \dfc(u_{i,j+1}^n))(u_{i,j+1}^n-u_{i,j}^n) -
 \half(\dfc(u_{i,j-1}^n) + \dfc(u_{i,j}^n))(u_{i,j}^n-u_{i-1,j-1}^n)) -\\ 
&\quad \Delta tf(u_{i,j}^n) - u^{n-1}_{i,j} = 0\tp
\end{align*}
$$

It is convenient to work with two indices \( i \) and \( j \) in 2D
finite difference discretizations, but it complicates
the derivation of the Jacobian, which then gets four indices.
The left-hand expression of an equation \( F_{i,j}=0 \) is to be
differentiated with respect to each of the unknowns \( u_{r,s} \)
(short for \( u_{r,s}^n \)), \( r\in\Ix \), \( s\in\Iy \),

<p>
$$ J_{i,j,r,s} = \frac{\partial F_{i,j}}{\partial u_{r,s}}\tp $$

Given \( i \) and \( j \), only a few \( r \) and \( s \) indices give nonzero
contribution since \( F_{i,j} \) contains \( u_{i\pm 1,j} \), \( u_{i,j\pm 1} \),
and \( u_{i,j} \). Therefore, \( J_{i,j,r,s} \) is very sparse and we
can set up the left-hand side of the Newton system as

<p>
$$
\begin{align*}
 J_{i,j,r,s}\delta u_{r,s} =
J_{i,j,i,j}\delta u_{i,j} & +
J_{i,j,i-1,j}\delta u_{i-1,j} +
J_{i,j,i+1,j}\delta u_{i+1,j} +
J_{i,j,i,j-1}\delta u_{i,j-1}\\ 
& +
J_{i,j,i,j+1}\delta u_{i,j+1}
\end{align*}
$$

The specific derivatives become

<p>
$$
\begin{align*}
J_{i,j,i-1,j} &= \frac{\partial F_{i,j}}{\partial u_{i-1,j}}\\ 
&= \frac{\Delta t}{h^2}(\dfc'(u_{i-1,j})(u_{i,j}-u_{i-1,j})
+ \dfc(u_{i-1,j})(-1))\\ 
J_{i,j,i+1,j} &= \frac{\partial F_{i,j}}{\partial u_{i+1,j}}\\ 
&= \frac{\Delta t}{h^2}(-\dfc'(u_{i+1,j})(u_{i+1,j}-u_{i,j})
- \dfc(u_{i-1,j}))\\ 
J_{i,j,i,j-1} &= \frac{\partial F_{i,j}}{\partial u_{i,j-1}}\\ 
&= \frac{\Delta t}{h^2}(\dfc'(u_{i,j-1})(u_{i,j}-u_{i,j-1})
+ \dfc(u_{i,j-1})(-1))\\ 
J_{i,j,i,j+1} &= \frac{\partial F_{i,j}}{\partial u_{i,j+1}}\\ 
&= \frac{\Delta t}{h^2}(-\dfc'(u_{i,j+1})(u_{i,j+1}-u_{i,j})
- \dfc(u_{i,j-1}))
\end{align*}
$$

The \( J_{i,j,i,j} \) entry has a few more terms.
Inserting \( u_{-} \) for \( u \) in the \( J \) formula and then
forming \( J\delta u=-F \) gives the linear system to be solved
in each Newton iteration.

<h3>Continuation methods  <a name="___sec46"></a></h3>

<p>
Picard iteration or Newton's method may diverge when solving PDEs with
severe nonlinearities. Relaxation with \( \omega <1 \)
may help, but in highly nonlinear problems it can be
necessary to introduce a <em>continuation parameter</em> \( \Lambda \) in
the problem: \( \Lambda =0 \) gives a version of the
problem that is easy to solve, while
\( \Lambda =1 \) is the target problem. The idea is then
to increase \( \Lambda \) in steps, \( \Lambda_0=0 ,\Lambda_1 <\cdots <\Lambda_n=1 \),
and use the solution from the problem with \( \Lambda_{i-1} \) as
initial guess for the iterations in the problem corresponding
to \( \Lambda_i \).

<p>
The continuation method is easiest to understand through an example.
Suppose we intend to solve

<p>
$$ -\nabla\cdot\left( ||\nabla u||^q\nabla u\right) = f, $$

which is an equation modeling the flow of a non-Newtonian fluid through
i channel or pipe. For \( q=0 \) we have the Poisson equation (corresponding
to a Newtonian fluid) and the problem is linear. A typical
value for pseudo-plastic fluids may be \( q_n=-0.8 \). We can introduce
the continuation parameter \( \Lambda\in [0,1] \) such that
\( q=q_n\Lambda \). Let \( \{\Lambda_\ell\}_{\ell=0}^n \) be the sequence of
\( \Lambda \) values in \( [0,1] \), with corresponding \( q \) values
\( \{q_\ell\}_{\ell=0}^n \). We can then solve a sequence of problems

<p>
$$
-\nabla\cdot\left( ||\nabla u||^q_\ell\nabla u^\ell\right) = f,\quad
\ell = 0,\ldots,n,$$

where the initial guess for iterating on \( u^{\ell} \) is the
previously computed solution \( u^{\ell-1} \). If a particular \( \Lambda_\ell \)
leads to convergence problems, one may try a smaller
increase in \( \Lambda \):
\( \Lambda_* = \half (\Lambda_{\ell-1}+\Lambda_\ell) \),
and repeat halving the step in \( \Lambda \) until convergence is reestablished.

<p>
<p>
<!-- begin bottom navigation -->
<a href="._main_nonlin-solarized003.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/prev1.png" border=0 alt="previous"></a>

<a href="._main_nonlin-solarized005.html"><img src="http://hplgit.github.io/doconce/bundled/html_images/next1.png" border=0 alt="next"></a>
<!-- end bottom navigation -->

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

