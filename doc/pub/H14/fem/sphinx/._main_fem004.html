

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Finite element basis functions (1)</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Introduction to finite element methods" href="index.html" />
    <link rel="next" title="Implementation (1)" href="._main_fem005.html" />
    <link rel="prev" title="Approximation of functions" href="._main_fem003.html" />
 
  
   <style type="text/css">
     div.admonition {
       background-color: whiteSmoke;
       border: 1px solid #bababa;
     }
   </style>
  </head>

  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._main_fem005.html" title="Implementation (1)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._main_fem003.html" title="Approximation of functions"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Introduction to finite element methods</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="finite-element-basis-functions-1">
<span id="fem-approx-fe"></span><h1>Finite element basis functions  (1)<a class="headerlink" href="#finite-element-basis-functions-1" title="Permalink to this headline">¶</a></h1>
<p>The specific basis functions exemplified in the section <a class="reference internal" href="._main_fem003.html#fem-approx-global"><em>Approximation of functions</em></a> are in general nonzero on the entire domain
<span class="math">\(\Omega\)</span>, see Figure <a class="reference internal" href="#fem-approx-fe-fig-u-sin"><em>A function resulting from adding two sine basis functions</em></a> for an example
where we plot <span class="math">\(\psi_0(x)=\sin\frac{1}{2}\pi x\)</span> and
<span class="math">\(\psi_1(x)=\sin 2\pi x\)</span> together with a possible sum
<span class="math">\(u(x)=4\psi_0(x) - \frac{1}{2}\psi_1(x)\)</span>. We shall
now turn the attention to basis functions that have <em>compact support</em>,
meaning that they are nonzero on only a small portion of
<span class="math">\(\Omega\)</span>. Moreover, we shall restrict the functions to be <em>piecewise
polynomials</em>. This means that the domain is split into subdomains and
the function is a polynomial on one or more subdomains, see Figure
<a class="reference internal" href="#fem-approx-fe-fig-u-fe"><em>A function resulting from adding three local piecewise linear (hat) functions</em></a> for a sketch involving locally defined
hat functions that make <span class="math">\(u=\sum_jc_j{\psi}_j\)</span> piecewise linear. At
the boundaries between subdomains one normally forces continuity of
the function only so that when connecting two polynomials from two
subdomains, the derivative becomes discontinuous. These type
of basis functions are fundamental in the finite element method.</p>
<div class="figure" id="fem-approx-fe-fig-u-sin">
<a class="reference internal image-reference" href="_images/u_example_sin.png"><img alt="_images/u_example_sin.png" src="_images/u_example_sin.png" style="width: 600px;" /></a>
<p class="caption"><em>A function resulting from adding two sine basis functions</em></p>
</div>
<div class="figure" id="fem-approx-fe-fig-u-fe">
<a class="reference internal image-reference" href="_images/u_example_P1.png"><img alt="_images/u_example_P1.png" src="_images/u_example_P1.png" style="width: 600px;" /></a>
<p class="caption"><em>A function resulting from adding three local piecewise linear (hat) functions</em></p>
</div>
<p>We first introduce the concepts of elements and nodes in a simplistic fashion
as often met in the literature. Later, we shall generalize the concept
of an element, which is a necessary step to treat a wider class of
approximations within the family of finite element methods.
The generalization is also compatible with
the concepts used in the <a class="reference external" href="http://fenicsproject.org">FEniCS</a> finite
element software.</p>
<div class="section" id="elements-and-nodes">
<span id="fem-approx-fe-def-elements-nodes"></span><h2>Elements and nodes<a class="headerlink" href="#elements-and-nodes" title="Permalink to this headline">¶</a></h2>
<p>Let us divide the interval <span class="math">\(\Omega\)</span> on which <span class="math">\(f\)</span> and <span class="math">\(u\)</span> are defined
into non-overlapping subintervals <span class="math">\(\Omega^{(e)}\)</span>, <span class="math">\(e=0,\ldots,N_e\)</span>:</p>
<div class="math">
\[\Omega = \Omega^{(0)}\cup \cdots \cup \Omega^{(N_e)}{\thinspace .}\]</div>
<p>We shall for now
refer to <span class="math">\(\Omega^{(e)}\)</span> as an <em>element</em>, having number <span class="math">\(e\)</span>.
On each element we introduce a set of points called <em>nodes</em>.
For now we assume that the nodes are uniformly spaced throughout the
element and that the boundary points of the elements are also nodes.
The nodes are given numbers both within an element and in the global
domain. These are
referred to as <em>local</em> and <em>global</em> node numbers, respectively.
Figure <a class="reference internal" href="#fem-approx-fe-def-elements-nodes-fig-p1"><em>Finite element mesh with 5 elements and 6 nodes</em></a> shows
element boundaries with small vertical lines, nodes as small disks,
element numbers in circles, and global node numbers under the nodes.</p>
<div class="figure" id="fem-approx-fe-def-elements-nodes-fig-p1">
<a class="reference internal image-reference" href="_images/fe_mesh1D.png"><img alt="_images/fe_mesh1D.png" src="_images/fe_mesh1D.png" style="width: 500px;" /></a>
<p class="caption"><em>Finite element mesh with 5 elements and 6 nodes</em></p>
</div>
<span class="target" id="index-0"></span><p id="index-1">Nodes and elements uniquely define a <em>finite element mesh</em>, which is our
discrete representation of the domain in the computations.
A common special case is that of a <em>uniformly partitioned mesh</em> where
each element has the same length and the distance between nodes is constant.</p>
<div class="section" id="example-2">
<h3>Example  (2)<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h3>
<p>On <span class="math">\(\Omega =[0,1]\)</span> we may introduce two elements,
<span class="math">\(\Omega^{(0)}=[0,0.4]\)</span> and <span class="math">\(\Omega^{(1)}=[0.4,1]\)</span>. Furthermore,
let us introduce three nodes
per element, equally spaced within each element.
Figure <a class="reference internal" href="#fem-approx-fe-def-elements-nodes-fig-p2"><em>Finite element mesh with 2 elements and 5 nodes</em></a> shows the
mesh.
The three nodes in element number 0 are <span class="math">\(x_0=0\)</span>, <span class="math">\(x_1=0.2\)</span>, and <span class="math">\(x_2=0.4\)</span>.
The local and global node numbers are here equal.
In element number 1, we have the local nodes <span class="math">\(x_0=0.4\)</span>, <span class="math">\(x_1=0.7\)</span>, and <span class="math">\(x_2=1\)</span>
and the corresponding
global nodes <span class="math">\(x_2=0.4\)</span>, <span class="math">\(x_3=0.7\)</span>, and <span class="math">\(x_4=1\)</span>. Note that
the global node <span class="math">\(x_2=0.4\)</span> is shared by the two elements.</p>
<div class="figure" id="fem-approx-fe-def-elements-nodes-fig-p2">
<a class="reference internal image-reference" href="_images/fe_mesh1D_P2.png"><img alt="_images/fe_mesh1D_P2.png" src="_images/fe_mesh1D_P2.png" style="width: 500px;" /></a>
<p class="caption"><em>Finite element mesh with 2 elements and 5 nodes</em></p>
</div>
<p>For the purpose of implementation, we introduce two lists or arrays:
<tt class="docutils literal"><span class="pre">nodes</span></tt> for storing the coordinates of the nodes, with the
global node numbers as indices, and <tt class="docutils literal"><span class="pre">elements</span></tt> for holding
the global node numbers in each element, with the local node numbers
as indices. The <tt class="docutils literal"><span class="pre">nodes</span></tt> and <tt class="docutils literal"><span class="pre">elements</span></tt> lists for the sample mesh
above take the form</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">elements</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
</pre></div>
</div>
<p>Looking up the coordinate of local node number 2 in element 1
is here done by <tt class="docutils literal"><span class="pre">nodes[elements[1][2]]</span></tt> (recall that nodes and
elements start their numbering at 0).</p>
<p>The numbering of elements and nodes does not need to be regular.
Figure <a class="reference internal" href="#fem-approx-fe-def-elements-nodes-fig-p1-irregular"><em>Example on irregular numbering of elements and nodes</em></a> shows
and example corresponding to</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">]</span>
<span class="n">elements</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
<div class="figure" id="fem-approx-fe-def-elements-nodes-fig-p1-irregular">
<a class="reference internal image-reference" href="_images/fe_mesh1D_random_numbering.png"><img alt="_images/fe_mesh1D_random_numbering.png" src="_images/fe_mesh1D_random_numbering.png" style="width: 500px;" /></a>
<p class="caption"><em>Example on irregular numbering of elements and nodes</em></p>
</div>
</div>
</div>
<div class="section" id="the-basis-functions">
<h2>The basis functions<a class="headerlink" href="#the-basis-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="construction-principles">
<h3>Construction principles<a class="headerlink" href="#construction-principles" title="Permalink to this headline">¶</a></h3>
<p>Finite element basis functions are in this text recognized by
the notation <span class="math">\({\varphi}_i(x)\)</span>, where the index now in the beginning corresponds to
a global node number. In the current approximation problem we shall
simply take <span class="math">\({\psi}_i = {\varphi}_i\)</span>.</p>
<p>Let <span class="math">\(i\)</span> be the global node number corresponding to local node <span class="math">\(r\)</span> in
element number <span class="math">\(e\)</span>.  The finite element basis functions <span class="math">\({\varphi}_i\)</span>
are now defined as follows.</p>
<blockquote>
<div><ul class="simple">
<li>If local node number <span class="math">\(r\)</span> is not on the boundary of the element,
take <span class="math">\({\varphi}_i(x)\)</span> to be the Lagrange
polynomial that is 1 at the local node number <span class="math">\(r\)</span> and zero
at all other nodes in the element. On all other elements, <span class="math">\({\varphi}_i=0\)</span>.</li>
<li>If local node number <span class="math">\(r\)</span> is on the boundary of the element,
let <span class="math">\({\varphi}_i\)</span> be made up of the Lagrange polynomial over element <span class="math">\(e\)</span>
that is 1 at node <span class="math">\(i\)</span>, combined with the Lagrange polynomial over
element <span class="math">\(e+1\)</span> that is also 1 at node <span class="math">\(i\)</span>.
On all other elements, <span class="math">\({\varphi}_i=0\)</span>.</li>
</ul>
</div></blockquote>
<p>A visual impression of three such basis functions are given in
Figure <a class="reference internal" href="#fem-approx-fe-fig-p2"><em>Illustration of the piecewise quadratic basis functions associated with nodes in element 1</em></a>.</p>
<div class="figure" id="fem-approx-fe-fig-p2">
<a class="reference internal image-reference" href="_images/mpl_fe_basis_p2_4e_lab.png"><img alt="_images/mpl_fe_basis_p2_4e_lab.png" src="_images/mpl_fe_basis_p2_4e_lab.png" style="width: 600px;" /></a>
<p class="caption"><em>Illustration of the piecewise quadratic basis functions associated with nodes in element 1</em></p>
</div>
</div>
<div class="section" id="properties-of">
<h3>Properties of <span class="math">\({\varphi}_i\)</span><a class="headerlink" href="#properties-of" title="Permalink to this headline">¶</a></h3>
<p>The construction of basis functions according to the principles above
lead to two important properties of <span class="math">\({\varphi}_i(x)\)</span>. First,</p>
<div class="math" id="equation-fem:approx:fe:phi:prop1">
<span id="eq-fem-approx-fe-phi-prop1"></span><span id="index-2"></span><span class="eqno">(1)</span>\[\begin{split}     {\varphi}_i(x_{j}) =\delta_{ij},\quad \delta_{ij} =
     \left\lbrace\begin{array}{ll}
     1, &amp; i=j,\\
     0, &amp; i\neq j,
     \end{array}\right.\end{split}\]</div>
<p>when <span class="math">\(x_{j}\)</span> is a node in the mesh with global node number <span class="math">\(j\)</span>.
The
result <span class="math">\({\varphi}_i(x_{j}) =\delta_{ij}\)</span> arises
because the Lagrange polynomials are constructed to have
exactly this property.
The property also implies a convenient interpretation of <span class="math">\(c_i\)</span>
as the value of <span class="math">\(u\)</span> at node <span class="math">\(i\)</span>. To show this, we expand <span class="math">\(u\)</span>
in the usual way as <span class="math">\(\sum_jc_j{\psi}_j\)</span> and choose <span class="math">\({\psi}_i = {\varphi}_i\)</span>:</p>
<div class="math">
\[u(x_{i}) = \sum_{j\in{\mathcal{I}_s}} c_j {\psi}_j (x_{i}) =
\sum_{j\in{\mathcal{I}_s}} c_j {\varphi}_j (x_{i}) = c_i {\varphi}_i (x_{i}) = c_i
{\thinspace .}\]</div>
<p>Because of this interpretation,
the coefficient <span class="math">\(c_i\)</span> is by many named <span class="math">\(u_i\)</span> or <span class="math">\(U_i\)</span>.</p>
<p>Second,
<span class="math">\({\varphi}_i(x)\)</span> is mostly zero throughout the domain:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\({\varphi}_i(x) \neq 0\)</span> only on those elements that contain global node <span class="math">\(i\)</span>,</li>
<li><span class="math">\({\varphi}_i(x){\varphi}_j(x) \neq 0\)</span> if and only if <span class="math">\(i\)</span> and <span class="math">\(j\)</span> are global node
numbers in the same element.</li>
</ul>
</div></blockquote>
<p>Since <span class="math">\(A_{i,j}\)</span> is the integral of
<span class="math">\({\varphi}_i{\varphi}_j\)</span> it means that
<em>most of the elements in the coefficient matrix will be zero</em>.
We will come back to these properties and use
them actively in computations to save memory and CPU time.</p>
<p>We let each element have <span class="math">\(d+1\)</span> nodes, resulting in local Lagrange
polynomials of degree <span class="math">\(d\)</span>. It is not a requirement to have the same
<span class="math">\(d\)</span> value in each element, but for now we will assume so.</p>
</div>
</div>
<div class="section" id="example-on-piecewise-quadratic-finite-element-functions">
<h2>Example on piecewise quadratic finite element functions<a class="headerlink" href="#example-on-piecewise-quadratic-finite-element-functions" title="Permalink to this headline">¶</a></h2>
<p>Figure <a class="reference internal" href="#fem-approx-fe-fig-p2"><em>Illustration of the piecewise quadratic basis functions associated with nodes in element 1</em></a> illustrates how piecewise
quadratic basis functions can look like (<span class="math">\(d=2\)</span>). We work with the
domain <span class="math">\(\Omega = [0,1]\)</span> divided into four equal-sized elements, each having
three nodes.
The <tt class="docutils literal"><span class="pre">nodes</span></tt> and <tt class="docutils literal"><span class="pre">elements</span></tt> lists in this particular example become</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.375</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.625</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.875</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">elements</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span>
</pre></div>
</div>
<p>Figure <a class="reference internal" href="#fem-approx-fe-fig-p2-mesh"><em>Sketch of mesh with 4 elements and 3 nodes per element</em></a> sketches the mesh and the
numbering.
Nodes are marked with circles on the <span class="math">\(x\)</span> axis and
element boundaries are marked with vertical dashed lines
in Figure <a class="reference internal" href="#fem-approx-fe-fig-p2"><em>Illustration of the piecewise quadratic basis functions associated with nodes in element 1</em></a>.</p>
<div class="figure" id="fem-approx-fe-fig-p2-mesh">
<a class="reference internal image-reference" href="_images/fe_mesh1D_P2_4e.png"><img alt="_images/fe_mesh1D_P2_4e.png" src="_images/fe_mesh1D_P2_4e.png" style="width: 500px;" /></a>
<p class="caption"><em>Sketch of mesh with 4 elements and 3 nodes per element</em></p>
</div>
<p>Let us explain in detail how the basis functions are constructed
according to the principles.
Consider element number 1 in Figure <a class="reference internal" href="#fem-approx-fe-fig-p2"><em>Illustration of the piecewise quadratic basis functions associated with nodes in element 1</em></a>,
<span class="math">\(\Omega^{(1)}=[0.25, 0.5]\)</span>, with local nodes
0, 1, and 2 corresponding to global nodes 2, 3, and 4.
The coordinates of these nodes are
<span class="math">\(0.25\)</span>, <span class="math">\(0.375\)</span>, and <span class="math">\(0.5\)</span>, respectively.
We define three Lagrange
polynomials on this element:</p>
<ol class="arabic simple">
<li>The polynomial that is 1 at local node 1
(<span class="math">\(x=0.375\)</span>, global node 3) makes up the basis function
<span class="math">\({\varphi}_3(x)\)</span> over this element,
with <span class="math">\({\varphi}_3(x)=0\)</span> outside the element.</li>
<li>The Lagrange polynomial that is 1 at local node 0 is the &#8220;right
part&#8221; of the global basis function
<span class="math">\({\varphi}_2(x)\)</span>. The &#8220;left part&#8221; of <span class="math">\({\varphi}_2(x)\)</span> consists of
a Lagrange polynomial associated with local node 2 in
the neighboring element <span class="math">\(\Omega^{(0)}=[0, 0.25]\)</span>.</li>
<li>Finally, the polynomial that is 1 at local node 2 (global node 4)
is the &#8220;left part&#8221; of the global basis function <span class="math">\({\varphi}_4(x)\)</span>.
The &#8220;right part&#8221; comes from the Lagrange polynomial that is 1 at
local node 0 in the neighboring element <span class="math">\(\Omega^{(2)}=[0.5, 0.75]\)</span>.</li>
</ol>
<p>As mentioned earlier,
any global basis function <span class="math">\({\varphi}_i(x)\)</span> is zero on elements that
do not contain the node with global node number <span class="math">\(i\)</span>.</p>
<p>The other global functions associated with internal
nodes, <span class="math">\({\varphi}_1\)</span>, <span class="math">\({\varphi}_5\)</span>, and <span class="math">\({\varphi}_7\)</span>, are all of the
same shape as the drawn <span class="math">\({\varphi}_3\)</span>, while the global basis functions
associated with shared nodes also have the same shape, provided the
elements are of the same length.</p>
<div class="figure" id="fem-approx-fe-fig-p1">
<a class="reference internal image-reference" href="_images/mpl_fe_basis_p1_4e_lab.png"><img alt="_images/mpl_fe_basis_p1_4e_lab.png" src="_images/mpl_fe_basis_p1_4e_lab.png" style="width: 600px;" /></a>
<p class="caption"><em>Illustration of the piecewise linear basis functions associated with nodes in element 1</em></p>
</div>
</div>
<div class="section" id="example-on-piecewise-linear-finite-element-functions">
<h2>Example on piecewise linear finite element functions<a class="headerlink" href="#example-on-piecewise-linear-finite-element-functions" title="Permalink to this headline">¶</a></h2>
<p>Figure <a class="reference internal" href="#fem-approx-fe-fig-p1"><em>Illustration of the piecewise linear basis functions associated with nodes in element 1</em></a> shows
piecewise linear basis functions (<span class="math">\(d=1\)</span>). Also here we have four elements on
<span class="math">\(\Omega = [0,1]\)</span>. Consider the element <span class="math">\(\Omega^{(1)}=[0.25,0.5]\)</span>.
Now there are no internal nodes in the elements so that all basis
functions are associated with nodes at the element boundaries and hence
made up of two Lagrange polynomials from neighboring elements.
For example, <span class="math">\({\varphi}_1(x)\)</span> results from the Lagrange polynomial in
element 0 that is 1 at local node 1 and 0 at local node 0, combined with
the Lagrange polynomial in
element 1 that is 1 at local node 0 and 0 at local node 1.
The other basis functions are constructed similarly.</p>
<p>Explicit mathematical formulas are needed for <span class="math">\({\varphi}_i(x)\)</span> in computations.
In the
piecewise linear case, one can show that</p>
<div class="math" id="equation-fem:approx:fe:phi:1:formula1">
<span id="eq-fem-approx-fe-phi-1-formula1"></span><span class="eqno">(2)</span>\[\begin{split}     {\varphi}_i(x) = \left\lbrace\begin{array}{ll}
     0, &amp; x &lt; x_{i-1},\\
     (x - x_{i-1})/(x_{i} - x_{i-1}),
     &amp; x_{i-1} \leq x &lt; x_{i},\\
     1 -
     (x - x_{i})/(x_{i+1} - x_{i}),
     &amp; x_{i} \leq x &lt; x_{i+1},\\
     0, &amp; x\geq x_{i+1}{\thinspace .}  \end{array}
     \right.\end{split}\]</div>
<p>Here, <span class="math">\(x_{j}\)</span>, <span class="math">\(j=i-1,i,i+1\)</span>, denotes the coordinate of node <span class="math">\(j\)</span>.
For elements of equal length <span class="math">\(h\)</span> the formulas can be simplified to</p>
<div class="math" id="equation-fem:approx:fe:phi:1:formula2">
<span id="eq-fem-approx-fe-phi-1-formula2"></span><span class="eqno">(3)</span>\[\begin{split}     {\varphi}_i(x) = \left\lbrace\begin{array}{ll}
     0, &amp; x &lt; x_{i-1},\\
     (x - x_{i-1})/h,
     &amp; x_{i-1} \leq x &lt; x_{i},\\
     1 -
     (x - x_{i})/h,
     &amp; x_{i} \leq x &lt; x_{i+1},\\
     0, &amp; x\geq x_{i+1}
     \end{array}
     \right.\end{split}\]</div>
</div>
<div class="section" id="example-on-piecewise-cubic-finite-element-basis-functions">
<h2>Example on piecewise cubic finite element basis functions<a class="headerlink" href="#example-on-piecewise-cubic-finite-element-basis-functions" title="Permalink to this headline">¶</a></h2>
<p>Piecewise cubic basis functions can be defined by introducing four
nodes per element. Figure <a class="reference internal" href="#fem-approx-fe-fig-p3"><em>Illustration of the piecewise cubic basis functions associated with nodes in element 1</em></a> shows
examples on <span class="math">\({\varphi}_i(x)\)</span>, <span class="math">\(i=3,4,5,6\)</span>, associated with element number 1.
Note that <span class="math">\({\varphi}_4\)</span> and <span class="math">\({\varphi}_5\)</span> are nonzero on element number 1,
while
<span class="math">\({\varphi}_3\)</span> and <span class="math">\({\varphi}_6\)</span> are made up of Lagrange polynomials on two
neighboring elements.</p>
<div class="figure" id="fem-approx-fe-fig-p3">
<a class="reference internal image-reference" href="_images/mpl_fe_basis_p3_4e.png"><img alt="_images/mpl_fe_basis_p3_4e.png" src="_images/mpl_fe_basis_p3_4e.png" style="width: 600px;" /></a>
<p class="caption"><em>Illustration of the piecewise cubic basis functions associated with nodes in element 1</em></p>
</div>
<span class="target" id="index-3"></span><span class="target" id="index-4"></span><p id="index-5">We see that all the piecewise linear basis functions have the same
&#8220;hat&#8221; shape. They are naturally referred to as <em>hat functions</em>,
also called <em>chapeau functions</em>.
The piecewise quadratic functions in Figure <a class="reference internal" href="#fem-approx-fe-fig-p2"><em>Illustration of the piecewise quadratic basis functions associated with nodes in element 1</em></a>
are seen to be of two types. &#8220;Rounded hats&#8221; associated with internal
nodes in the elements and some more &#8220;sombrero&#8221; shaped hats associated
with element boundary nodes. Higher-order basis functions also have
hat-like shapes, but the functions have pronounced oscillations in addition,
as illustrated in Figure <a class="reference internal" href="#fem-approx-fe-fig-p3"><em>Illustration of the piecewise cubic basis functions associated with nodes in element 1</em></a>.</p>
<span class="target" id="index-6"></span><span class="target" id="index-7"></span><span class="target" id="index-8"></span><p id="index-9">A common terminology is to speak about <em>linear elements</em> as
elements with two local nodes associated with
piecewise linear basis functions. Similarly, <em>quadratic elements</em> and
<em>cubic elements</em> refer to piecewise quadratic or cubic functions
over elements with three or four local nodes, respectively.
Alternative names, frequently used later, are P1 elements for linear
elements, P2 for quadratic elements, and so forth: Pd signifies
degree <span class="math">\(d\)</span> of the polynomial basis functions.</p>
</div>
<div class="section" id="calculating-the-linear-system">
<span id="fem-approx-global-linearsystem"></span><h2>Calculating the linear system<a class="headerlink" href="#calculating-the-linear-system" title="Permalink to this headline">¶</a></h2>
<p>The elements in the coefficient matrix and right-hand side are given
by the formulas <a class="reference internal" href="._main_fem003.html#eq-fem-approx-aij"><em>(4.4)</em></a> and <a class="reference internal" href="._main_fem003.html#eq-fem-approx-bi"><em>(4.5)</em></a>, but
now the choice of <span class="math">\({\psi}_i\)</span> is <span class="math">\({\varphi}_i\)</span>.
Consider P1 elements where <span class="math">\({\varphi}_i(x)\)</span> piecewise linear. Nodes and elements
numbered consecutively from left to right in a uniformly partitioned
mesh imply the nodes</p>
<div class="math">
\[x_i=i h,\quad i=0,\ldots,N,\]</div>
<p>and the elements</p>
<div class="math">
\[\Omega^{(i)} = [x_{i},x_{i+1}] = [i h, (i+1)h],\quad
i=0,\ldots,N_e=N-1
{\thinspace .}\]</div>
<p>We have in this case <span class="math">\(N\)</span> elements and <span class="math">\(N+1\)</span> nodes,
and <span class="math">\(\Omega=[x_{0},x_{N}]\)</span>.
The formula for <span class="math">\({\varphi}_i(x)\)</span> is given by
<a href="#equation-fem:approx:fe:phi:1:formula2">(3)</a> and a graphical illustration is
provided in Figures <a class="reference internal" href="#fem-approx-fe-fig-p1"><em>Illustration of the piecewise linear basis functions associated with nodes in element 1</em></a> and
<a class="reference internal" href="#fem-approx-fe-fig-phi-i-im1"><em>Illustration of two neighboring linear (hat) functions with general node numbers</em></a>. First we clearly see
from the figures the very important property
<span class="math">\({\varphi}_i(x){\varphi}_j(x)\neq 0\)</span> if and only if <span class="math">\(j=i-1\)</span>, <span class="math">\(j=i\)</span>, or
<span class="math">\(j=i+1\)</span>, or alternatively expressed, if and only if <span class="math">\(i\)</span> and <span class="math">\(j\)</span> are
nodes in the same element. Otherwise, <span class="math">\({\varphi}_i\)</span> and <span class="math">\({\varphi}_j\)</span> are
too distant to have an overlap and consequently their product vanishes.</p>
<div class="figure" id="fem-approx-fe-fig-phi-2-3">
<a class="reference internal image-reference" href="_images/fe_mesh1D_phi_2_3.png"><img alt="_images/fe_mesh1D_phi_2_3.png" src="_images/fe_mesh1D_phi_2_3.png" style="width: 500px;" /></a>
<p class="caption"><em>Illustration of the piecewise linear basis functions corresponding to global node 2 and 3</em></p>
</div>
<div class="section" id="calculating-a-specific-matrix-entry">
<h3>Calculating a specific matrix entry<a class="headerlink" href="#calculating-a-specific-matrix-entry" title="Permalink to this headline">¶</a></h3>
<p>Let us calculate the specific matrix entry <span class="math">\(A_{2,3} = \int_\Omega
{\varphi}_2{\varphi}_3{\, \mathrm{d}x}\)</span>. Figure <a class="reference internal" href="#fem-approx-fe-fig-phi-2-3"><em>Illustration of the piecewise linear basis functions corresponding to global node 2 and 3</em></a>
shows how <span class="math">\({\varphi}_2\)</span> and <span class="math">\({\varphi}_3\)</span> look like. We realize
from this figure that the product <span class="math">\({\varphi}_2{\varphi}_3\neq 0\)</span>
only over element 2, which contains node 2 and 3.
The particular formulas for <span class="math">\({\varphi}_{2}(x)\)</span> and <span class="math">\({\varphi}_3(x)\)</span> on
<span class="math">\([x_{2},x_{3}]\)</span> are found from <a href="#equation-fem:approx:fe:phi:1:formula2">(3)</a>.
The function
<span class="math">\({\varphi}_3\)</span> has positive slope over <span class="math">\([x_{2},x_{3}]\)</span> and corresponds
to the interval <span class="math">\([x_{i-1},x_{i}]\)</span> in
<a href="#equation-fem:approx:fe:phi:1:formula2">(3)</a>. With <span class="math">\(i=3\)</span> we get</p>
<div class="math">
\[{\varphi}_3(x) = (x-x_2)/h,\]</div>
<p>while <span class="math">\({\varphi}_2(x)\)</span> has negative slope over <span class="math">\([x_{2},x_{3}]\)</span>
and corresponds to setting <span class="math">\(i=2\)</span> in <a href="#equation-fem:approx:fe:phi:1:formula2">(3)</a>,</p>
<div class="math">
\[{\varphi}_2(x) = 1- (x-x_2)/h{\thinspace .}\]</div>
<p>We can now easily integrate,</p>
<div class="math">
\[A_{2,3} = \int_\Omega {\varphi}_2{\varphi}_{3}{\, \mathrm{d}x} =
\int_{x_{2}}^{x_{3}}
\left(1 - \frac{x - x_{2}}{h}\right) \frac{x - x_{2}}{h}
 {\, \mathrm{d}x} = \frac{h}{6}{\thinspace .}\]</div>
<p>The diagonal entry in the coefficient matrix becomes</p>
<div class="math">
\[A_{2,2} =
\int_{x_{1}}^{x_{2}}
\left(\frac{x - x_{1}}{h}\right)^2{\, \mathrm{d}x} +
\int_{x_{2}}^{x_{3}}
\left(1 - \frac{x - x_{2}}{h}\right)^2{\, \mathrm{d}x}
= \frac{2h}{3}{\thinspace .}\]</div>
<p>The entry <span class="math">\(A_{2,1}\)</span> has an
the integral that is geometrically similar to the situation in
Figure <a class="reference internal" href="#fem-approx-fe-fig-phi-2-3"><em>Illustration of the piecewise linear basis functions corresponding to global node 2 and 3</em></a>, so we get
<span class="math">\(A_{2,1}=h/6\)</span>.</p>
</div>
<div class="section" id="calculating-a-general-row-in-the-matrix">
<h3>Calculating a general row in the matrix<a class="headerlink" href="#calculating-a-general-row-in-the-matrix" title="Permalink to this headline">¶</a></h3>
<p>We can now generalize the calculation of matrix entries to
a general row number <span class="math">\(i\)</span>. The entry
<span class="math">\(A_{i,i-1}=\int_\Omega{\varphi}_i{\varphi}_{i-1}{\, \mathrm{d}x}\)</span> involves
hat functions as depicted in
Figure <a class="reference internal" href="#fem-approx-fe-fig-phi-i-im1"><em>Illustration of two neighboring linear (hat) functions with general node numbers</em></a>. Since the integral
is geometrically identical to the situation with specific nodes
2 and 3, we realize that <span class="math">\(A_{i,i-1}=A_{i,i+1}=h/6\)</span> and
<span class="math">\(A_{i,i}=2h/3\)</span>. However, we can compute the integral directly
too:</p>
<div class="math">
\[\begin{split}A_{i,i-1} &amp;= \int_\Omega {\varphi}_i{\varphi}_{i-1}{\, \mathrm{d}x}\\
&amp;=
\underbrace{\int_{x_{i-2}}^{x_{i-1}} {\varphi}_i{\varphi}_{i-1}{\, \mathrm{d}x}}_{{\varphi}_i=0} +
\int_{x_{i-1}}^{x_{i}} {\varphi}_i{\varphi}_{i-1}{\, \mathrm{d}x} +
\underbrace{\int_{x_{i}}^{x_{i+1}} {\varphi}_i{\varphi}_{i-1}{\, \mathrm{d}x}}_{{\varphi}_{i-1}=0}\\
&amp;= \int_{x_{i-1}}^{x_{i}}
\underbrace{\left(\frac{x - x_{i}}{h}\right)}_{{\varphi}_i(x)}
\underbrace{\left(1 - \frac{x - x_{i-1}}{h}\right)}_{{\varphi}_{i-1}(x)} {\, \mathrm{d}x} =
\frac{h}{6}
{\thinspace .}\end{split}\]</div>
<p>The particular formulas for <span class="math">\({\varphi}_{i-1}(x)\)</span> and <span class="math">\({\varphi}_i(x)\)</span> on
<span class="math">\([x_{i-1},x_{i}]\)</span> are found from <a href="#equation-fem:approx:fe:phi:1:formula2">(3)</a>:
<span class="math">\({\varphi}_i\)</span> is the linear function with positive slope, corresponding
to the interval <span class="math">\([x_{i-1},x_{i}]\)</span> in
<a href="#equation-fem:approx:fe:phi:1:formula2">(3)</a>, while <span class="math">\(\phi_{i-1}\)</span> has a
negative slope so the definition in interval
<span class="math">\([x_{i},x_{i+1}]\)</span> in <a href="#equation-fem:approx:fe:phi:1:formula2">(3)</a> must be
used. (The appearance of <span class="math">\(i\)</span> in <a href="#equation-fem:approx:fe:phi:1:formula2">(3)</a>
and the integral might be confusing, as we speak about two different
<span class="math">\(i\)</span> indices.)</p>
<div class="figure" id="fem-approx-fe-fig-phi-i-im1">
<a class="reference internal image-reference" href="_images/fe_mesh1D_phi_i_im1.png"><img alt="_images/fe_mesh1D_phi_i_im1.png" src="_images/fe_mesh1D_phi_i_im1.png" style="width: 500px;" /></a>
<p class="caption"><em>Illustration of two neighboring linear (hat) functions with general node numbers</em></p>
</div>
<p>The first and last row of the coefficient matrix lead to slightly
different integrals:</p>
<div class="math">
\[A_{0,0} = \int_\Omega {\varphi}_0^2{\, \mathrm{d}x} = \int_{x_{0}}^{x_{1}}
\left(1 - \frac{x-x_0}{h}\right)^2{\, \mathrm{d}x} = \frac{h}{3}{\thinspace .}\]</div>
<p>Similarly, <span class="math">\(A_{N,N}\)</span> involves an integral over only one element
and equals hence <span class="math">\(h/3\)</span>.</p>
<div class="figure" id="fem-approx-fe-fig-phi-i-f">
<a class="reference internal image-reference" href="_images/fe_mesh1D_phi_i_f.png"><img alt="_images/fe_mesh1D_phi_i_f.png" src="_images/fe_mesh1D_phi_i_f.png" style="width: 500px;" /></a>
<p class="caption"><em>Right-hand side integral with the product of a basis function and the given function to approximate</em></p>
</div>
<p>The general formula for <span class="math">\(b_i\)</span>,
see Figure <a class="reference internal" href="#fem-approx-fe-fig-phi-i-f"><em>Right-hand side integral with the product of a basis function and the given function to approximate</em></a>, is now easy to set up</p>
<div class="math" id="equation-fem:approx:fe:bi:formula1">
<span id="eq-fem-approx-fe-bi-formula1"></span><span class="eqno">(4)</span>\[     b_i = \int_\Omega{\varphi}_i(x)f(x){\, \mathrm{d}x}
     = \int_{x_{i-1}}^{x_{i}} \frac{x - x_{i-1}}{h} f(x){\, \mathrm{d}x}
     + \int_{x_{i}}^{x_{i+1}} \left(1 - \frac{x - x_{i}}{h}\right) f(x)
     {\, \mathrm{d}x}{\thinspace .}\]</div>
<p>We need a specific <span class="math">\(f(x)\)</span> function to compute these integrals.
With two equal-sized elements in <span class="math">\(\Omega=[0,1]\)</span> and <span class="math">\(f(x)=x(1-x)\)</span>, one gets</p>
<div class="math">
\[\begin{split}A = \frac{h}{6}\left(\begin{array}{ccc}
2 &amp; 1 &amp; 0\\
1 &amp; 4 &amp; 1\\
0 &amp; 1 &amp; 2
\end{array}\right),\quad
b = \frac{h^2}{12}\left(\begin{array}{c}
2 - 3h\\
12 - 14h\\
10 -17h
\end{array}\right){\thinspace .}\end{split}\]</div>
<p>The solution becomes</p>
<div class="math">
\[c_0 = \frac{h^2}{6},\quad c_1 = h - \frac{5}{6}h^2,\quad
c_2 = 2h - \frac{23}{6}h^2{\thinspace .}\]</div>
<p>The resulting function</p>
<div class="math">
\[u(x)=c_0{\varphi}_0(x) + c_1{\varphi}_1(x) + c_2{\varphi}_2(x)\]</div>
<p>is displayed in Figure <a class="reference internal" href="#fem-approx-fe-fig-ls-p1-2-4"><em>Least squares approximation of a parabola using 2 (left) and 4 (right) P1 elements</em></a> (left).
Doubling the number of elements to four leads to the improved
approximation in the right part of Figure <a class="reference internal" href="#fem-approx-fe-fig-ls-p1-2-4"><em>Least squares approximation of a parabola using 2 (left) and 4 (right) P1 elements</em></a>.</p>
<div class="figure" id="fem-approx-fe-fig-ls-p1-2-4">
<a class="reference internal image-reference" href="_images/fe_p1_x2_2e_4e.png"><img alt="_images/fe_p1_x2_2e_4e.png" src="_images/fe_p1_x2_2e_4e.png" style="width: 800px;" /></a>
<p class="caption"><em>Least squares approximation of a parabola using 2 (left) and 4 (right) P1 elements</em></p>
</div>
</div>
</div>
<div class="section" id="assembly-of-elementwise-computations">
<span id="fem-approx-fe-elementwise"></span><h2>Assembly of elementwise computations<a class="headerlink" href="#assembly-of-elementwise-computations" title="Permalink to this headline">¶</a></h2>
<p>The integrals above are naturally split into integrals over individual elements
since the formulas change with the elements. This idea of splitting the
integral is fundamental in all practical implementations of the finite
element method.</p>
<p>Let us split the integral over <span class="math">\(\Omega\)</span> into a sum of contributions from
each element:</p>
<div class="math" id="equation-fem:approx:fe:elementwise:Asplit">
<span id="eq-fem-approx-fe-elementwise-asplit"></span><span class="eqno">(5)</span>\[     A_{i,j} = \int_\Omega{\varphi}_i{\varphi}_j {\, \mathrm{d}x} = \sum_{e} A^{(e)}_{i,j},\quad
     A^{(e)}_{i,j}=\int_{\Omega^{(e)}} {\varphi}_i{\varphi}_j {\, \mathrm{d}x}
     {\thinspace .}\]</div>
<p>Now, <span class="math">\(A^{(e)}_{i,j}\neq 0\)</span> if and only if <span class="math">\(i\)</span> and <span class="math">\(j\)</span> are nodes in element
<span class="math">\(e\)</span> (look at Figure <a class="reference internal" href="#fem-approx-fe-fig-phi-i-im1"><em>Illustration of two neighboring linear (hat) functions with general node numbers</em></a> to realize this
property).
Introduce <span class="math">\(i=q(e,r)\)</span> as the mapping of local node number <span class="math">\(r\)</span> in element
<span class="math">\(e\)</span> to the global node number <span class="math">\(i\)</span>. This is just a short mathematical notation
for the expression <tt class="docutils literal"><span class="pre">i=elements[e][r]</span></tt> in a program.
Let <span class="math">\(r\)</span> and <span class="math">\(s\)</span> be the local node numbers corresponding to the global
node numbers <span class="math">\(i=q(e,r)\)</span> and
<span class="math">\(j=q(e,s)\)</span>. With <span class="math">\(d\)</span> nodes per element, all the nonzero elements
in <span class="math">\(A^{(e)}_{i,j}\)</span> arise from the integrals involving basis functions with
indices corresponding to the global node numbers in element number <span class="math">\(e\)</span>:</p>
<div class="math" id="index-10">
\[\int_{\Omega^{(e)}}{\varphi}_{q(e,r)}{\varphi}_{q(e,s)} {\, \mathrm{d}x},
\quad r,s=0,\ldots, d{\thinspace .}\]</div>
<p>These contributions can be collected in a <span class="math">\((d+1)\times (d+1)\)</span> matrix known as
the <em>element matrix</em>. Let <span class="math">\({I_d}=\{0,\ldots,d\}\)</span> be the valid indices
of <span class="math">\(r\)</span> and <span class="math">\(s\)</span>.
We introduce the notation</p>
<div class="math">
\[\tilde A^{(e)} = \{ \tilde A^{(e)}_{r,s}\},\quad
r,s\in{I_d},\]</div>
<p>for the element matrix. For the case <span class="math">\(d=2\)</span> we have</p>
<div class="math">
\[\begin{split}\tilde A^{(e)} = \left\lbrack\begin{array}{lllll}
\tilde A^{(e)}_{0,0} &amp; \tilde A^{(e)}_{0,1} &amp; \tilde A^{(e)}_{0,2}\\
\tilde A^{(e)}_{1,0} &amp; \tilde A^{(e)}_{1,1} &amp; \tilde A^{(e)}_{1,2}\\
\tilde A^{(e)}_{2,0} &amp; \tilde A^{(e)}_{2,1} &amp; \tilde A^{(e)}_{2,2}
\end{array}\right\rbrack
{\thinspace .}\end{split}\]</div>
<p>Given the numbers <span class="math">\(\tilde A^{(e)}_{r,s}\)</span>,
we should according to <a href="#equation-fem:approx:fe:elementwise:Asplit">(5)</a>
add the contributions to the global coefficient matrix by</p>
<div class="math" id="index-11">
\[ A_{q(e,r),q(e,s)} := A_{q(e,r),q(e,s)} + \tilde A^{(e)}_{r,s},\quad
r,s\in{I_d}{\thinspace .}\]</div>
<p>This process of adding in elementwise contributions to the global matrix
is called <em>finite element assembly</em> or simply <em>assembly</em>.
Figure <a class="reference internal" href="#fem-approx-fe-fig-assembly-2x2"><em>Illustration of matrix assembly: regularly numbered P1 elements</em></a> illustrates how element matrices
for elements with two nodes are added into the global matrix.
More specifically, the figure shows how the element matrix associated with
elements 1 and 2 assembled, assuming that global nodes are numbered
from left to right in the domain. With regularly numbered P3 elements, where
the element matrices have size <span class="math">\(4\times 4\)</span>, the assembly of elements 1 and 2
are sketched in Figure <a class="reference internal" href="#fem-approx-fe-fig-assembly-4x4"><em>Illustration of matrix assembly: regularly numbered P3 elements</em></a>.</p>
<div class="figure" id="fem-approx-fe-fig-assembly-2x2">
<a class="reference internal image-reference" href="_images/fe_assembly_regular_2x2.png"><img alt="_images/fe_assembly_regular_2x2.png" src="_images/fe_assembly_regular_2x2.png" style="width: 700px;" /></a>
<p class="caption"><em>Illustration of matrix assembly: regularly numbered P1 elements</em></p>
</div>
<div class="figure" id="fem-approx-fe-fig-assembly-4x4">
<a class="reference internal image-reference" href="_images/fe_assembly_regular_4x4.png"><img alt="_images/fe_assembly_regular_4x4.png" src="_images/fe_assembly_regular_4x4.png" style="width: 700px;" /></a>
<p class="caption"><em>Illustration of matrix assembly: regularly numbered P3 elements</em></p>
</div>
<p>After assembly of element matrices corresponding to regularly numbered elements
and nodes are understood, it is wise to study the assembly process for
irregularly numbered elements and nodes. Figure <a class="reference internal" href="#fem-approx-fe-def-elements-nodes-fig-p1-irregular"><em>Example on irregular numbering of elements and nodes</em></a> shows a mesh where the <tt class="docutils literal"><span class="pre">elements</span></tt> array, or <span class="math">\(q(e,r)\)</span>
mapping in mathematical notation, is given as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">elements</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
<p>The associated assembly of element matrices 1 and 2 is sketched in
Figure <a class="reference internal" href="#fem-approx-fe-fig-assembly-irr2x2"><em>Illustration of matrix assembly: irregularly numbered P1 elements</em></a>.</p>
<p>These three assembly processes can also be <a class="reference external" href="http://tinyurl.com/opdfafk/pub/mov-fem/fe_assembly.html">animated</a>.</p>
<div class="figure" id="fem-approx-fe-fig-assembly-irr2x2">
<a class="reference internal image-reference" href="_images/fe_assembly_irregular.png"><img alt="_images/fe_assembly_irregular.png" src="_images/fe_assembly_irregular.png" style="width: 700px;" /></a>
<p class="caption"><em>Illustration of matrix assembly: irregularly numbered P1 elements</em></p>
</div>
<p>The right-hand side of the linear system is also computed elementwise:</p>
<div class="math">
\[b_i = \int_\Omega f(x){\varphi}_i(x) {\, \mathrm{d}x} = \sum_{e} b^{(e)}_{i},\quad
b^{(e)}_{i}=\int_{\Omega^{(e)}} f(x){\varphi}_i(x){\, \mathrm{d}x}
{\thinspace .}\]</div>
<p>We observe that
<span class="math">\(b_i^{(e)}\neq 0\)</span> if and only if global node <span class="math">\(i\)</span> is a node in element <span class="math">\(e\)</span>
(look at Figure <a class="reference internal" href="#fem-approx-fe-fig-phi-i-f"><em>Right-hand side integral with the product of a basis function and the given function to approximate</em></a> to realize this property).
With <span class="math">\(d\)</span> nodes per element we can collect the <span class="math">\(d+1\)</span> nonzero contributions
<span class="math">\(b_i^{(e)}\)</span>, for <span class="math">\(i=q(e,r)\)</span>, <span class="math">\(r\in{I_d}\)</span>, in an <em>element vector</em></p>
<div class="math">
\[\tilde b_r^{(e)}=\{ \tilde b_r^{(e)}\},\quad r\in{I_d}{\thinspace .}\]</div>
<p>These contributions are added to the
global right-hand side by an assembly process similar to that for the
element matrices:</p>
<div class="math">
\[b_{q(e,r)} := b_{q(e,r)} + \tilde b^{(e)}_{r},\quad
r\in{I_d}{\thinspace .}\]</div>
</div>
<div class="section" id="mapping-to-a-reference-element">
<span id="fem-approx-fe-mapping"></span><h2>Mapping to a reference element<a class="headerlink" href="#mapping-to-a-reference-element" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-12"></span><p id="index-13">Instead of computing the integrals</p>
<div class="math">
\[\tilde A^{(e)}_{r,s} = \int_{\Omega^{(e)}}{\varphi}_{q(e,r)}(x){\varphi}_{q(e,s)}(x){\, \mathrm{d}x}\]</div>
<p>over some element
<span class="math">\(\Omega^{(e)} = [x_L, x_R]\)</span>,
it is convenient to map the element domain <span class="math">\([x_L, x_R]\)</span>
to a standardized reference element domain <span class="math">\([-1,1]\)</span>.
(We have now introduced
<span class="math">\(x_L\)</span> and <span class="math">\(x_R\)</span> as the left and right boundary points of an arbitrary element.
With a natural, regular numbering of nodes and elements from left to right
through the domain, we have <span class="math">\(x_L=x_{e}\)</span> and <span class="math">\(x_R=x_{e+1}\)</span> for P1 elements.)</p>
<p>Let <span class="math">\(X\in [-1,1]\)</span> be the coordinate
in the reference element. A linear or <em>affine mapping</em> from <span class="math">\(X\)</span> to <span class="math">\(x\)</span> reads</p>
<div class="math" id="equation-fem:approx:fe:affine:mapping">
<span id="eq-fem-approx-fe-affine-mapping"></span><span class="eqno">(6)</span>\[     x = \frac{1}{2} (x_L + x_R) + \frac{1}{2} (x_R - x_L)X{\thinspace .}\]</div>
<p>This relation can alternatively be expressed by</p>
<div class="math" id="equation-fem:approx:fe:affine:mapping2">
<span id="eq-fem-approx-fe-affine-mapping2"></span><span class="eqno">(7)</span>\[     x = x_m + {\frac{1}{2}}hX,\]</div>
<p>where we have introduced the element midpoint <span class="math">\(x_m=(x_L+x_R)/2\)</span> and
the element length <span class="math">\(h=x_R-x_L\)</span>.</p>
<p>Integrating on
the reference element is a matter of just changing the integration
variable from <span class="math">\(x\)</span> to <span class="math">\(X\)</span>. Let</p>
<div class="math">
\[{\tilde{\varphi}}_r(X) = {\varphi}_{q(e,r)}(x(X))\]</div>
<p>be the basis function associated with local node number <span class="math">\(r\)</span> in the
reference element. The integral transformation reads</p>
<div class="math">
\[\tilde A^{(e)}_{r,s} =
\int_{\Omega^{(e)}}{\varphi}_{q(e,r)}(x){\varphi}_{q(e,s)}(x){\, \mathrm{d}x}
= \int_{-1}^1 {\tilde{\varphi}}_r(X){\tilde{\varphi}}_s(X)\frac{dx}{dX}{\, \mathrm{d}X}
{\thinspace .}\]</div>
<p>The stretch factor <span class="math">\(dx/dX\)</span> between the <span class="math">\(x\)</span> and <span class="math">\(X\)</span> coordinates
becomes the determinant of the Jacobian matrix of the mapping
between the coordinate systems in 2D and 3D. To obtain a uniform
notation for 1D, 2D, and 3D problems we therefore replace
<span class="math">\(dx/dX\)</span> by <span class="math">\(\det J\)</span> already now. In 1D, <span class="math">\(\det J = dx/dX = h/2\)</span>.
The integration over the reference element is then written as</p>
<div class="math" id="equation-fem:approx:fe:mapping:Ae">
<span id="eq-fem-approx-fe-mapping-ae"></span><span class="eqno">(8)</span>\[     \tilde A^{(e)}_{r,s}
     = \int_{-1}^1 {\tilde{\varphi}}_r(X){\tilde{\varphi}}_s(X)\det J\,dX\]\[     {\thinspace .}\]</div>
<p>The corresponding formula for the element vector entries becomes</p>
<div class="math" id="equation-fem:approx:fe:mapping:be">
<span id="eq-fem-approx-fe-mapping-be"></span><span class="eqno">(9)</span>\[     \tilde b^{(e)}_{r} = \int_{\Omega^{(e)}}f(x){\varphi}_{q(e,r)}(x)dx
     = \int_{-1}^1 f(x(X)){\tilde{\varphi}}_r(X)\det J\,dX\]\[     {\thinspace .}\]</div>
<p>Since we from now on will work in the reference
element, we need explicit mathematical formulas for the basis
functions <span class="math">\({\varphi}_i(x)\)</span> in the reference element only, i.e., we only need
to specify formulas for <span class="math">\({\tilde{\varphi}}_r(X)\)</span>.
This is a very convenient simplification compared to specifying
piecewise polynomials in the physical domain.</p>
<p>The <span class="math">\({\tilde{\varphi}}_r(x)\)</span> functions are simply the Lagrange
polynomials defined through the local nodes in the reference element.
For <span class="math">\(d=1\)</span> and two nodes per element, we have the linear Lagrange
polynomials</p>
<div class="math" id="equation-fem:approx:fe:mapping:P1:phi0">
<span id="eq-fem-approx-fe-mapping-p1-phi0"></span><span class="eqno">(10)</span>\[     {\tilde{\varphi}}_0(X) = \frac{1}{2} (1 - X)\]</div>
<div class="math" id="equation-fem:approx:fe:mapping:P1:phi1">
<span id="eq-fem-approx-fe-mapping-p1-phi1"></span><span class="eqno">(11)</span>\[     {\tilde{\varphi}}_1(X) = \frac{1}{2} (1 + X)\]</div>
<p>Quadratic polynomials, <span class="math">\(d=2\)</span>, have the formulas</p>
<div class="math">
\[{\tilde{\varphi}}_0(X) = \frac{1}{2} (X-1)X\]</div>
<div class="math">
\[{\tilde{\varphi}}_1(X) = 1 - X^2\]</div>
<div class="math">
\[{\tilde{\varphi}}_2(X) = \frac{1}{2} (X+1)X\]</div>
<p>In general,</p>
<div class="math">
\[{\tilde{\varphi}}_r(X) = \prod_{s=0,s\neq r}^d \frac{X-X_{(s)}}{X_{(r)}-X_{(s)}},\]</div>
<p>where <span class="math">\(X_{(0)},\ldots,X_{(d)}\)</span> are the coordinates of the local nodes in
the reference element.
These are normally uniformly spaced: <span class="math">\(X_{(r)} = -1 + 2r/d\)</span>,
<span class="math">\(r\in{I_d}\)</span>.</p>
<div class="admonition-why-reference-elements admonition">
<p class="first admonition-title">Why reference elements</p>
<p class="last">The great advantage of using reference elements is that
the formulas for the basis functions, <span class="math">\({\tilde{\varphi}}_r(X)\)</span>, are the
same for all elements and independent of the element geometry
(length and location in the mesh). The geometric information
is &#8220;factored out&#8221; in the simple mapping formula and the associated
<span class="math">\(\det J\)</span> quantity, but this information is (here taken as) the same for
element types. Also, the integration domain is the same for
all elements.</p>
</div>
</div>
<div class="section" id="example-integration-over-a-reference-element">
<span id="fem-approx-fe-intg-ref"></span><h2>Example: Integration over a reference element<a class="headerlink" href="#example-integration-over-a-reference-element" title="Permalink to this headline">¶</a></h2>
<p>To illustrate the concepts from the previous section in a specific
example, we now
consider calculation of the element matrix and vector for a specific choice of
<span class="math">\(d\)</span> and <span class="math">\(f(x)\)</span>. A simple choice is <span class="math">\(d=1\)</span> (P1 elements) and <span class="math">\(f(x)=x(1-x)\)</span>
on <span class="math">\(\Omega =[0,1]\)</span>. We have the general expressions
<a href="#equation-fem:approx:fe:mapping:Ae">(8)</a> and <a href="#equation-fem:approx:fe:mapping:be">(9)</a>
for <span class="math">\(\tilde A^{(e)}_{r,s}\)</span> and <span class="math">\(\tilde b^{(e)}_{r}\)</span>.
Writing these out for the choices <a href="#equation-fem:approx:fe:mapping:P1:phi0">(10)</a>
and <a href="#equation-fem:approx:fe:mapping:P1:phi1">(11)</a>, and using that <span class="math">\(\det J = h/2\)</span>,
we can do the following calculations of the element matrix entries:</p>
<div class="math">
\[\tilde A^{(e)}_{0,0}
= \int_{-1}^1 {\tilde{\varphi}}_0(X){\tilde{\varphi}}_0(X)\frac{h}{2} dX\nonumber\]</div>
<div class="math" id="equation-fem:approx:fe:intg:ref:Ae00">
<span id="eq-fem-approx-fe-intg-ref-ae00"></span><span class="eqno">(12)</span>\[     =\int_{-1}^1 \frac{1}{2}(1-X)\frac{1}{2}(1-X) \frac{h}{2} dX =
     \frac{h}{8}\int_{-1}^1 (1-X)^2 dX = \frac{h}{3},\]</div>
<div class="math">
\[\tilde A^{(e)}_{1,0}
= \int_{-1}^1 {\tilde{\varphi}}_1(X){\tilde{\varphi}}_0(X)\frac{h}{2} dX\nonumber\]</div>
<div class="math">
\[=\int_{-1}^1 \frac{1}{2}(1+X)\frac{1}{2}(1-X) \frac{h}{2} dX =
\frac{h}{8}\int_{-1}^1 (1-X^2) dX = \frac{h}{6},\]</div>
<div class="math" id="equation-fem:approx:fe:intg:ref:Ae10">
<span id="eq-fem-approx-fe-intg-ref-ae10"></span><span class="eqno">(13)</span>\[     \tilde A^{(e)}_{0,1} = \tilde A^{(e)}_{1,0},\]</div>
<div class="math">
\[\tilde A^{(e)}_{1,1}
= \int_{-1}^1 {\tilde{\varphi}}_1(X){\tilde{\varphi}}_1(X)\frac{h}{2} dX\nonumber\]</div>
<div class="math" id="equation-fem:approx:fe:intg:ref:Ae11">
<span id="eq-fem-approx-fe-intg-ref-ae11"></span><span class="eqno">(14)</span>\[     =\int_{-1}^1 \frac{1}{2}(1+X)\frac{1}{2}(1+X) \frac{h}{2} dX =
     \frac{h}{8}\int_{-1}^1 (1+X)^2 dX = \frac{h}{3}\]\[     {\thinspace .}\]</div>
<p>The corresponding entries in the element vector becomes</p>
<div class="math">
\[\tilde b^{(e)}_{0}
= \int_{-1}^1 f(x(X)){\tilde{\varphi}}_0(X)\frac{h}{2} dX\nonumber\]</div>
<div class="math">
\[= \int_{-1}^1 (x_m + \frac{1}{2} hX)(1-(x_m + \frac{1}{2} hX))
\frac{1}{2}(1-X)\frac{h}{2} dX \nonumber\]</div>
<div class="math" id="equation-fem:approx:fe:intg:ref:be0">
<span id="eq-fem-approx-fe-intg-ref-be0"></span><span class="eqno">(15)</span>\[     = - \frac{1}{24} h^{3} + \frac{1}{6} h^{2} x_{m} - \frac{1}{12} h^{2} - \frac{1}{2} h x_{m}^{2} + \frac{1}{2} h x_{m}\]</div>
<div class="math">
\[\tilde b^{(e)}_{1}
= \int_{-1}^1 f(x(X)){\tilde{\varphi}}_1(X)\frac{h}{2} dX\nonumber\]</div>
<div class="math">
\[= \int_{-1}^1 (x_m + \frac{1}{2} hX)(1-(x_m + \frac{1}{2} hX))
\frac{1}{2}(1+X)\frac{h}{2} dX \nonumber\]</div>
<div class="math">
\[= - \frac{1}{24} h^{3} - \frac{1}{6} h^{2} x_{m} + \frac{1}{12} h^{2} -
\frac{1}{2} h x_{m}^{2} + \frac{1}{2} h x_{m}
{\thinspace .}\]</div>
<p>In the last two expressions we have used the element midpoint <span class="math">\(x_m\)</span>.</p>
<p>Integration of lower-degree polynomials above is tedious,
and higher-degree polynomials involve very much more algebra, but <tt class="docutils literal"><span class="pre">sympy</span></tt>
may help. For example, we can easily calculate
<a href="#equation-fem:approx:fe:intg:ref:Ae00">(12)</a>,
<a href="#equation-fem:approx:fe:intg:ref:Ae00">(12)</a>, and
<a href="#equation-fem:approx:fe:intg:ref:be0">(15)</a> by</p>
<div class="highlight-ipy"><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sympy</span> <span class="kn">as</span> <span class="nn">sp</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">,</span> <span class="n">x_m</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">&#39;x x_m h X&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">h</span><span class="o">/</span><span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">X</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">X</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">h</span><span class="o">/</span><span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x_m</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">X</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b_0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">X</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">b_0</span>
<span class="o">-</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">24</span> <span class="o">+</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x_m</span><span class="o">/</span><span class="mi">6</span> <span class="o">-</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">12</span> <span class="o">-</span> <span class="n">h</span><span class="o">*</span><span class="n">x_m</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">x_m</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
<p>For inclusion of formulas in documents (like the present one), <tt class="docutils literal"><span class="pre">sympy</span></tt> can print
expressions in LaTeX format:</p>
<div class="highlight-ipy"><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">b_0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;plain&#39;</span><span class="p">)</span>
<span class="o">-</span> \<span class="n">frac</span><span class="p">{</span><span class="mi">1</span><span class="p">}{</span><span class="mi">24</span><span class="p">}</span> <span class="n">h</span><span class="o">^</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span> <span class="o">+</span> \<span class="n">frac</span><span class="p">{</span><span class="mi">1</span><span class="p">}{</span><span class="mi">6</span><span class="p">}</span> <span class="n">h</span><span class="o">^</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span> <span class="n">x_</span><span class="p">{</span><span class="n">m</span><span class="p">}</span>
<span class="o">-</span> \<span class="n">frac</span><span class="p">{</span><span class="mi">1</span><span class="p">}{</span><span class="mi">12</span><span class="p">}</span> <span class="n">h</span><span class="o">^</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span> <span class="o">-</span> \<span class="n">half</span> <span class="n">h</span> <span class="n">x_</span><span class="p">{</span><span class="n">m</span><span class="p">}</span><span class="o">^</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span>
<span class="o">+</span> \<span class="n">half</span> <span class="n">h</span> <span class="n">x_</span><span class="p">{</span><span class="n">m</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Finite element basis functions  (1)</a><ul>
<li><a class="reference internal" href="#elements-and-nodes">Elements and nodes</a><ul>
<li><a class="reference internal" href="#example-2">Example  (2)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-basis-functions">The basis functions</a><ul>
<li><a class="reference internal" href="#construction-principles">Construction principles</a></li>
<li><a class="reference internal" href="#properties-of">Properties of <span class="math">\({\varphi}_i\)</span></a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-on-piecewise-quadratic-finite-element-functions">Example on piecewise quadratic finite element functions</a></li>
<li><a class="reference internal" href="#example-on-piecewise-linear-finite-element-functions">Example on piecewise linear finite element functions</a></li>
<li><a class="reference internal" href="#example-on-piecewise-cubic-finite-element-basis-functions">Example on piecewise cubic finite element basis functions</a></li>
<li><a class="reference internal" href="#calculating-the-linear-system">Calculating the linear system</a><ul>
<li><a class="reference internal" href="#calculating-a-specific-matrix-entry">Calculating a specific matrix entry</a></li>
<li><a class="reference internal" href="#calculating-a-general-row-in-the-matrix">Calculating a general row in the matrix</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assembly-of-elementwise-computations">Assembly of elementwise computations</a></li>
<li><a class="reference internal" href="#mapping-to-a-reference-element">Mapping to a reference element</a></li>
<li><a class="reference internal" href="#example-integration-over-a-reference-element">Example: Integration over a reference element</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._main_fem003.html"
                        title="previous chapter">Approximation of functions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._main_fem005.html"
                        title="next chapter">Implementation  (1)</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/._main_fem004.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._main_fem005.html" title="Implementation (1)"
             >next</a> |</li>
        <li class="right" >
          <a href="._main_fem003.html" title="Approximation of functions"
             >previous</a> |</li>
        <li><a href="index.html">Introduction to finite element methods</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
  <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
  </div>
</div>

  </body>
</html>